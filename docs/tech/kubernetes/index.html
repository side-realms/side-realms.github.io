<!doctype html>
<html lang="ja-jp">
  <head>
    <title>kubernetes // ãŠèŒ¶ã¯ç¶¾é·¹æ´¾</title>
    <link rel="shortcut icon" href="../../favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.154.5">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="KoheiDoi" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="../../css/main.min.28bf54a51b1e4711d8cbfc98ed1ef539e32c13fb19cade5b37dac3cab34b527a.css" />
    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="kubernetes">
  <meta name="twitter:description" content="kubernetes ã‚³ãƒ³ãƒ†ãƒŠã‚’ç®¡ç†ï¼Œã‚¹ã‚±ãƒ¼ãƒ«ã•ã›ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ï¼ˆã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ï¼‰ https://kubernetes.io/docs/concepts/overview/#why-you-need-kubernetes-and-what-can-it-do
kubernetes ã§ã¯è² è·åˆ†æ•£ã‚„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãªã©ãŒæ©Ÿèƒ½ã¨ã—ã¦ã‚ã‚‹ï¼ åŸºæœ¬çš„ã« kubectl ã§ kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ“ä½œã™ã‚‹ï¼
https://www.cncf.io/wp-content/uploads/2020/09/Kubernetes-architecture-diagram-1-1-1024x698.png
Contorol Plane ã¯ Node(Pod ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãƒã‚·ãƒ³ã§ï¼Œã‚³ãƒ³ãƒ†ãƒŠã‚’ã¾ã¨ã‚ãŸå˜ä½)ã‚’åˆ¶å¾¡ã™ã‚‹
Control Panel API server: kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ“ä½œã™ã‚‹ãŸã‚ã® REST interface ã‚’æä¾›ã™ã‚‹ï¼Pod ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹æ“ä½œã¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã•ã‚Œã¦ã„ã‚‹ Scheduler: ãƒªã‚½ãƒ¼ã‚¹å®¹é‡ã‚’ç›£è¦–ã—ã¦ï¼ŒNode ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ€é©ã«ãªã‚‹ã‚ˆã†ã«ç®¡ç†ã™ã‚‹ Controller manager: Node ãŒãƒ€ã‚¦ãƒ³ã—ãŸãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦å®£è¨€ã¨ã®å·®ç•°ã‚’ç¢ºèªã™ã‚‹ kubelet: ã‚³ãƒ³ãƒ†ãƒŠãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã« pod ã®çŠ¶æ…‹ã‚’è¿½è·¡ã™ã‚‹ kube proxy: ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ Node ã«æµå…¥ã™ã‚‹ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç®¡ç†ã™ã‚‹ etcd: ã‚¯ãƒ©ã‚¹ã‚¿ã®çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹ Component Pod: ã‚³ãƒ³ãƒ†ãƒŠã‚’ã¾ã¨ã‚ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã§ï¼Œkubernetes ã®æœ€å°å˜ä½ï¼Pod ã«ã¯ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¦ï¼ŒåŒã˜ã‚³ãƒ³ãƒ†ãƒŠã® Pod ã¯åŒã˜ãƒªã‚½ãƒ¼ã‚¹ï¼ˆãƒ¡ãƒ¢ãƒªãªã©ï¼‰ã‚’å…±æœ‰ã™ã‚‹ï¼ Deployment: Node ä¸Šã§å‹•ã Pod ã®ç®¡ç†ã‚’ã™ã‚‹ï¼å¸Œæœ›ã™ã‚‹æ•°ã® Pod ã‚’å¸¸ã«å‹•ã‹ã—ã¦ãŠããªã© Servise: å€‹ã€…ã® Pod ã«ãŠã„ã¦ï¼ŒIP ã‚¢ãƒ‰ãƒ¬ã‚¹ãªã©å¤šãã®ã‚‚ã®ãŒç”Ÿãˆå¤‰ã‚ã‚Šã®ãŸã³ã«å¤‰åŒ–ã™ã‚‹ã®ã§ï¼Œã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãªã©ã‚’è¡Œã†ï¼Pods ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå­˜åœ¨ã§ã¯ãªã„ã®ã§ï¼Œãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’å°‘ãªãã™ã‚‹å·¥å¤«ãŒå¿…è¦ Ingress: è² è·åˆ†æ•£ï¼ã‚¯ãƒ©ã‚¹ã‚¿å¤–ã‹ã‚‰æ¥ã‚‹é€šä¿¡ã‚’ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µã«ã‚ˆã£ã¦åˆ¶å¾¡ã™ã‚‹ï¼åˆ¶å¾¡ã•ã‚ŒãŸãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ service ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ï¼ ã‚„ã£ã¦ã¿ã‚‹ ã¨ã‚Šã‚ãˆãš windwos ã« minikube ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼ ä»Šå›ã¯ virtualbox ã‚’ä½¿ã†">

    <meta property="og:url" content="http://side-realms.github.io/tech/kubernetes/">
  <meta property="og:site_name" content="ãŠèŒ¶ã¯ç¶¾é·¹æ´¾">
  <meta property="og:title" content="kubernetes">
  <meta property="og:description" content="kubernetes ã‚³ãƒ³ãƒ†ãƒŠã‚’ç®¡ç†ï¼Œã‚¹ã‚±ãƒ¼ãƒ«ã•ã›ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ï¼ˆã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ï¼‰ https://kubernetes.io/docs/concepts/overview/#why-you-need-kubernetes-and-what-can-it-do
kubernetes ã§ã¯è² è·åˆ†æ•£ã‚„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãªã©ãŒæ©Ÿèƒ½ã¨ã—ã¦ã‚ã‚‹ï¼ åŸºæœ¬çš„ã« kubectl ã§ kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ“ä½œã™ã‚‹ï¼
https://www.cncf.io/wp-content/uploads/2020/09/Kubernetes-architecture-diagram-1-1-1024x698.png
Contorol Plane ã¯ Node(Pod ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãƒã‚·ãƒ³ã§ï¼Œã‚³ãƒ³ãƒ†ãƒŠã‚’ã¾ã¨ã‚ãŸå˜ä½)ã‚’åˆ¶å¾¡ã™ã‚‹
Control Panel API server: kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ“ä½œã™ã‚‹ãŸã‚ã® REST interface ã‚’æä¾›ã™ã‚‹ï¼Pod ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹æ“ä½œã¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã•ã‚Œã¦ã„ã‚‹ Scheduler: ãƒªã‚½ãƒ¼ã‚¹å®¹é‡ã‚’ç›£è¦–ã—ã¦ï¼ŒNode ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ€é©ã«ãªã‚‹ã‚ˆã†ã«ç®¡ç†ã™ã‚‹ Controller manager: Node ãŒãƒ€ã‚¦ãƒ³ã—ãŸãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦å®£è¨€ã¨ã®å·®ç•°ã‚’ç¢ºèªã™ã‚‹ kubelet: ã‚³ãƒ³ãƒ†ãƒŠãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã« pod ã®çŠ¶æ…‹ã‚’è¿½è·¡ã™ã‚‹ kube proxy: ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ Node ã«æµå…¥ã™ã‚‹ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç®¡ç†ã™ã‚‹ etcd: ã‚¯ãƒ©ã‚¹ã‚¿ã®çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹ Component Pod: ã‚³ãƒ³ãƒ†ãƒŠã‚’ã¾ã¨ã‚ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã§ï¼Œkubernetes ã®æœ€å°å˜ä½ï¼Pod ã«ã¯ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¦ï¼ŒåŒã˜ã‚³ãƒ³ãƒ†ãƒŠã® Pod ã¯åŒã˜ãƒªã‚½ãƒ¼ã‚¹ï¼ˆãƒ¡ãƒ¢ãƒªãªã©ï¼‰ã‚’å…±æœ‰ã™ã‚‹ï¼ Deployment: Node ä¸Šã§å‹•ã Pod ã®ç®¡ç†ã‚’ã™ã‚‹ï¼å¸Œæœ›ã™ã‚‹æ•°ã® Pod ã‚’å¸¸ã«å‹•ã‹ã—ã¦ãŠããªã© Servise: å€‹ã€…ã® Pod ã«ãŠã„ã¦ï¼ŒIP ã‚¢ãƒ‰ãƒ¬ã‚¹ãªã©å¤šãã®ã‚‚ã®ãŒç”Ÿãˆå¤‰ã‚ã‚Šã®ãŸã³ã«å¤‰åŒ–ã™ã‚‹ã®ã§ï¼Œã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãªã©ã‚’è¡Œã†ï¼Pods ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå­˜åœ¨ã§ã¯ãªã„ã®ã§ï¼Œãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’å°‘ãªãã™ã‚‹å·¥å¤«ãŒå¿…è¦ Ingress: è² è·åˆ†æ•£ï¼ã‚¯ãƒ©ã‚¹ã‚¿å¤–ã‹ã‚‰æ¥ã‚‹é€šä¿¡ã‚’ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µã«ã‚ˆã£ã¦åˆ¶å¾¡ã™ã‚‹ï¼åˆ¶å¾¡ã•ã‚ŒãŸãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ service ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ï¼ ã‚„ã£ã¦ã¿ã‚‹ ã¨ã‚Šã‚ãˆãš windwos ã« minikube ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼ ä»Šå›ã¯ virtualbox ã‚’ä½¿ã†">
  <meta property="og:locale" content="ja_jp">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tech">
    <meta property="article:published_time" content="2023-09-03T14:14:38+09:00">
    <meta property="article:modified_time" content="2023-09-03T14:14:38+09:00">

  </head>
  <body>
    <header class="app-header">
      <a href="http://side-realms.github.io/"><img class="app-header-avatar" src="../../images/avatar.jpg" alt="KoheiDoi" /></a>
      <span class="app-header-title">ãŠèŒ¶ã¯ç¶¾é·¹æ´¾</span>
      <p class="app-header-description">æœ€è¿‘ã¯é¢¯ã‚‚å¥½ã</p>
      <p class="app-header-memo">å†…å®¹ã®æ­£ç¢ºæ€§ã¯ä¿è¨¼ã—ã¦ã„ã¾ã›ã‚“ğŸ¶</p>
      <nav class="app-header-menu app-header-menu--main" aria-label="Main"><ul class="app-header-menu-list">
            <li class="app-header-menu-item">
              <a class="app-header-menu-link" href="../../">Home</a>
            </li>
            <li class="app-header-menu-item">
              <a class="app-header-menu-link" href="../../log">life log</a>
            </li>
            <li class="app-header-menu-item">
              <a class="app-header-menu-link" href="../../portfolio/">Portfolio</a>
            </li>
        </ul>
      </nav>

      <hr class="hr1">

      <hr class="hr1">
      <div class="app-header-social">
        
          <a href="https://github.com" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
      </div>
      <div class="app-footer-copyright">
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">kubernetes</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Sep 3, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          7 min read
        </div>
      </div>
      <hr>
    </header>
    <div class="post-content">
      <h2 id="kubernetes">kubernetes</h2>
<p>ã‚³ãƒ³ãƒ†ãƒŠã‚’ç®¡ç†ï¼Œã‚¹ã‚±ãƒ¼ãƒ«ã•ã›ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ï¼ˆã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ï¼‰
<a href="https://kubernetes.io/docs/concepts/overview/#why-you-need-kubernetes-and-what-can-it-do">https://kubernetes.io/docs/concepts/overview/#why-you-need-kubernetes-and-what-can-it-do</a></p>
<p>kubernetes ã§ã¯è² è·åˆ†æ•£ã‚„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãªã©ãŒæ©Ÿèƒ½ã¨ã—ã¦ã‚ã‚‹ï¼
åŸºæœ¬çš„ã« kubectl ã§ kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ“ä½œã™ã‚‹ï¼</p>
<figure><img src="https://www.cncf.io/wp-content/uploads/2020/09/Kubernetes-architecture-diagram-1-1-1024x698.png"
    alt="https://www.cncf.io/wp-content/uploads/2020/09/Kubernetes-architecture-diagram-1-1-1024x698.png"><figcaption>
      <p><a href="https://www.cncf.io/wp-content/uploads/2020/09/Kubernetes-architecture-diagram-1-1-1024x698.png">https://www.cncf.io/wp-content/uploads/2020/09/Kubernetes-architecture-diagram-1-1-1024x698.png</a></p>
    </figcaption>
</figure>

<p>Contorol Plane ã¯ Node(Pod ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãƒã‚·ãƒ³ã§ï¼Œã‚³ãƒ³ãƒ†ãƒŠã‚’ã¾ã¨ã‚ãŸå˜ä½)ã‚’åˆ¶å¾¡ã™ã‚‹</p>
<h3 id="control-panel">Control Panel</h3>
<ul>
<li>API server: kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ“ä½œã™ã‚‹ãŸã‚ã® REST interface ã‚’æä¾›ã™ã‚‹ï¼Pod ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹æ“ä½œã¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã•ã‚Œã¦ã„ã‚‹</li>
<li>Scheduler: ãƒªã‚½ãƒ¼ã‚¹å®¹é‡ã‚’ç›£è¦–ã—ã¦ï¼ŒNode ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ€é©ã«ãªã‚‹ã‚ˆã†ã«ç®¡ç†ã™ã‚‹</li>
<li>Controller manager: Node ãŒãƒ€ã‚¦ãƒ³ã—ãŸãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦å®£è¨€ã¨ã®å·®ç•°ã‚’ç¢ºèªã™ã‚‹</li>
<li>kubelet: ã‚³ãƒ³ãƒ†ãƒŠãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã« pod ã®çŠ¶æ…‹ã‚’è¿½è·¡ã™ã‚‹</li>
<li>kube proxy: ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ Node ã«æµå…¥ã™ã‚‹ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç®¡ç†ã™ã‚‹</li>
<li>etcd: ã‚¯ãƒ©ã‚¹ã‚¿ã®çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹</li>
</ul>
<h3 id="component">Component</h3>
<ul>
<li>Pod: ã‚³ãƒ³ãƒ†ãƒŠã‚’ã¾ã¨ã‚ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã§ï¼Œkubernetes ã®æœ€å°å˜ä½ï¼Pod ã«ã¯ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¦ï¼ŒåŒã˜ã‚³ãƒ³ãƒ†ãƒŠã® Pod ã¯åŒã˜ãƒªã‚½ãƒ¼ã‚¹ï¼ˆãƒ¡ãƒ¢ãƒªãªã©ï¼‰ã‚’å…±æœ‰ã™ã‚‹ï¼</li>
<li>Deployment: Node ä¸Šã§å‹•ã Pod ã®ç®¡ç†ã‚’ã™ã‚‹ï¼å¸Œæœ›ã™ã‚‹æ•°ã® Pod ã‚’å¸¸ã«å‹•ã‹ã—ã¦ãŠããªã©</li>
<li>Servise: å€‹ã€…ã® Pod ã«ãŠã„ã¦ï¼ŒIP ã‚¢ãƒ‰ãƒ¬ã‚¹ãªã©å¤šãã®ã‚‚ã®ãŒç”Ÿãˆå¤‰ã‚ã‚Šã®ãŸã³ã«å¤‰åŒ–ã™ã‚‹ã®ã§ï¼Œã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãªã©ã‚’è¡Œã†ï¼Pods ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå­˜åœ¨ã§ã¯ãªã„ã®ã§ï¼Œãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’å°‘ãªãã™ã‚‹å·¥å¤«ãŒå¿…è¦</li>
<li>Ingress: è² è·åˆ†æ•£ï¼ã‚¯ãƒ©ã‚¹ã‚¿å¤–ã‹ã‚‰æ¥ã‚‹é€šä¿¡ã‚’ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µã«ã‚ˆã£ã¦åˆ¶å¾¡ã™ã‚‹ï¼åˆ¶å¾¡ã•ã‚ŒãŸãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ service ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ï¼</li>
</ul>
<h2 id="ã‚„ã£ã¦ã¿ã‚‹">ã‚„ã£ã¦ã¿ã‚‹</h2>
<p>ã¨ã‚Šã‚ãˆãš windwos ã« minikube ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼
ä»Šå›ã¯ virtualbox ã‚’ä½¿ã†</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get nodes
</span></span><span style="display:flex;"><span>NAME       STATUS   ROLES           AGE     VERSION
</span></span><span style="display:flex;"><span>minikube   Ready    control-plane   7d22h   v1.27.3
</span></span></code></pre></div><p>ã‚ˆã•ãã†ï¼
æ¬¡ã« pod ã‚’ä½œæˆã™ã‚‹ manifest ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl create -f pod-nginx.yaml
</span></span><span style="display:flex;"><span>pod/nginx created
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get pod
</span></span><span style="display:flex;"><span>NAME    READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>nginx   1/1     Running   <span style="color:#ae81ff">0</span>          7s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl delete pod/nginx
</span></span><span style="display:flex;"><span>pod <span style="color:#e6db74">&#34;nginx&#34;</span> deleted
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get pod
</span></span><span style="display:flex;"><span>No resources found in default namespace.
</span></span></code></pre></div><p>pod ãŒå¤‰åŒ–ã—ã¦ã„ã‚‹ã®ã§ã‚ˆã•ãã†ï¼</p>
<h4 id="manifest-component">manifest component</h4>
<ul>
<li>spec: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æœŸå¾…ã™ã‚‹çŠ¶æ…‹ã‚’æ±ºã‚ã‚‹ï¼name ã¯åå‰ã ã— image ã¯ä½¿ã†ã‚¤ãƒ¡ãƒ¼ã‚¸</li>
<li>container onject
<ul>
<li>command: ã‚³ãƒ³ãƒ†ãƒŠã§èµ·å‹•ã•ã›ãŸã„ãƒ—ãƒ­ã‚»ã‚¹ã‚’æŒ‡å®šã™ã‚‹ï¼</li>
<li>args: ç‰¹ã«å¼•æ•°ã‚’æŒ‡å®šã™ã‚‹ï¼ˆã¨æ€ã†ï¼‰</li>
<li>env: ç’°å¢ƒå¤‰æ•°ã‚’æŒ‡å®šã™ã‚‹</li>
<li>image: ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸</li>
<li>name: ã‚³ãƒ³ãƒ†ãƒŠå</li>
<li>ports: ã‚³ãƒ³ãƒ†ãƒŠãŒé–‹ããƒãƒ¼ãƒˆ</li>
<li>workingDir: ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:alpine</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">Always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: []
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">args</span>: [<span style="color:#e6db74">&#34;nginx&#34;</span>, <span style="color:#e6db74">&#34;-g&#34;</span>, <span style="color:#e6db74">&#34;daemon off;&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">args</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">env</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">woot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">wai</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">workingDir</span>: <span style="color:#ae81ff">/tmp</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl create -f pod-nginx.yaml
</span></span><span style="display:flex;"><span>pod/nginx created
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get all
</span></span><span style="display:flex;"><span>NAME        READY   STATUS              RESTARTS   AGE
</span></span><span style="display:flex;"><span>pod/nginx   0/1     ContainerCreating   <span style="color:#ae81ff">0</span>          3s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get all
</span></span><span style="display:flex;"><span>NAME        READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>pod/nginx   1/1     Running   <span style="color:#ae81ff">0</span>          7s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl exec -- nginx ps
</span></span><span style="display:flex;"><span>PID   USER     TIME  COMMAND
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span> root      0:00 nginx: master process nginx -g daemon off;
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">30</span> nginx     0:00 nginx: worker process
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">31</span> nginx     0:00 nginx: worker process
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">32</span> root      0:00 ps
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl exec nginx -- env
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>woot<span style="color:#f92672">=</span>wai
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><h3 id="volume">Volume</h3>
<p>ã‚³ãƒ³ãƒ†ãƒŠã¯ã‚³ãƒ³ãƒ†ãƒŠãŒå‰Šé™¤ã•ã‚ŒãŸã‚Šï¼Œå†èµ·å‹•ã—ãŸå ´åˆã«ä¸­èº«ãŒæ¶ˆãˆã¦ã—ã¾ã†ï¼
Volume ã¯ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã®ãŸã‚ã«ä½¿ã†ï¼
ã¾ãŸï¼Œã‚³ãƒ³ãƒ†ãƒŠé–“ã®ãƒ‡ãƒ¼ã‚¿å…±æœ‰ã«ã‚‚ä½¿ã†ã“ã¨ãŒã§ãã‚‹ï¼
ã‚¯ãƒ©ã‚¦ãƒ‰ã¿ãŸã„ãªã‚‚ã®ã ã‚ã†ã‹&hellip;</p>
<p>æ°¸ç¶šåŒ–ã«ä½¿ã† volume ã‚¿ã‚¤ãƒ—ã«ã¯ã„ãã¤ã‹ã‚ã‚‹</p>
<ul>
<li>emptyDir: ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã«ã¯ä½¿ãˆãªã„ãŒï¼Œã‚³ãƒ³ãƒ†ãƒŠé–“ã®ãƒ‡ãƒ¼ã‚¿å…±æœ‰ã«ä½¿ã†</li>
<li>hostDir: ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã«ã‚‚ä½¿ãˆã‚‹</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>  <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">log-volume</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">emptyDir</span>:    
</span></span></code></pre></div><p>emptyDir ã‚’ä½¿ã£ãŸ volume ã‚’ä½œã£ã¦ï¼Œã“ã‚Œã«ã‚³ãƒ³ãƒ†ãƒŠã‚’å¯¾å¿œã•ã›ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">volumeMounts</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">log-volume</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/date-tail</span>
</span></span></code></pre></div><p>ã“ã‚Œã§ä¸¡æ–¹ã®ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ deta-tail ãŒå‚ç…§ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ï¼
å…¨ç„¶é–¢ä¿‚ãªã„ã‘ã©å¤§æ–‡å­—å°æ–‡å­—åˆ†ã‹ã‚Šã¥ã‚‰ãã¦æ³£ãï¼Œãªã‚“ã§èªé ­ã¯å°æ–‡å­—ãªã‚“ã </p>
<h3 id="init-container">init Container</h3>
<p>pods ã® contaieners ã§æŒ‡å®šã—ãŸã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã™ã‚‹å‰ã«åˆæœŸåŒ–ã™ã‚‹ï¼
ä¾‹ãˆã°ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒŠ A ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã ãŒï¼Œã‚‚ã†ä¸€ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠ B ãŒãã®ä½œæˆã‚’æ‹…ã£ã¦ã„ã‚‹ã¨ãï¼Œ
A ãŒå…ˆã«èµ·å‹•ã—ã¦ã—ã¾ã†ã¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒç„¡ãã¦å¤±æ•—ã—ã¦ã—ã¾ã†ãŒï¼Œã“ã‚Œã‚’ init Container ã§é˜²ãï¼</p>
<h3 id="resource-requirements">Resource Requirements</h3>
<p>pod ã¯ CPU ã‚„ GPU ãƒªã‚½ãƒ¼ã‚¹ãªã© pod å†…ã®ã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦ãƒªã‚½ãƒ¼ã‚¹ã®è¦æ±‚ã‚„åˆ¶é™ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã‚‹
ä¾‹ãˆã°ä»¥ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">requests</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">128M</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">limits</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">64M</span>
</span></span></code></pre></div><ul>
<li>è¦æ±‚ï¼šã‚³ãƒ³ãƒ†ãƒŠã§ä½¿ã„ãŸã„ãƒªã‚½ãƒ¼ã‚¹é‡ã§ï¼Œç¢ºä¿ã•ã‚Œã¦ã„ã¦ã»ã—ã„é‡</li>
<li>åˆ¶é™ï¼šã‚³ãƒ³ãƒ†ãƒŠã§è¶…ãˆã¦ã»ã—ããªã„ãƒªã‚½ãƒ¼ã‚¹é‡</li>
</ul>
<h3 id="security-context">security context</h3>
<p>pod ã‚„ã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚„ãƒ¦ãƒ¼ã‚¶ã®åˆ¶é™ãªã©ã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ï¼
ä¾‹ãˆã°ä»¥ä¸‹ã¯ volume ã®ã‚ªãƒ¼ãƒŠãƒ¼ã‚„ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">securityContext</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">fsGroup</span>: <span style="color:#ae81ff">1000</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl apply -f nginx.yaml
</span></span><span style="display:flex;"><span>pod/fsgroup-test created
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl exec -it fsgroup-test -- ls -l /
</span></span><span style="display:flex;"><span>/:
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 bin
</span></span><span style="display:flex;"><span>drwxrwsrwx    <span style="color:#ae81ff">2</span> root     <span style="color:#ae81ff">1000</span>          <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">3</span> 10:15 data &lt;--
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">5</span> root     root           <span style="color:#ae81ff">360</span> Sep  <span style="color:#ae81ff">3</span> 10:15 dev
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">1</span> root     root          <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">3</span> 10:15 etc
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 home
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">7</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 lib
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">5</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 media
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 mnt
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 opt
</span></span><span style="display:flex;"><span>dr-xr-xr-x  <span style="color:#ae81ff">257</span> root     root             <span style="color:#ae81ff">0</span> Sep  <span style="color:#ae81ff">3</span> 10:15 proc
</span></span><span style="display:flex;"><span>drwx------    <span style="color:#ae81ff">2</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 root
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">1</span> root     root          <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">3</span> 10:15 run
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 sbin
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 srv
</span></span><span style="display:flex;"><span>dr-xr-xr-x   <span style="color:#ae81ff">12</span> root     root             <span style="color:#ae81ff">0</span> Sep  <span style="color:#ae81ff">3</span> 10:15 sys
</span></span><span style="display:flex;"><span>drwxrwxrwt    <span style="color:#ae81ff">2</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 tmp
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">7</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 usr
</span></span><span style="display:flex;"><span>drwxr-xr-x   <span style="color:#ae81ff">12</span> root     root          <span style="color:#ae81ff">4096</span> Aug  <span style="color:#ae81ff">7</span> 13:09 var
</span></span></code></pre></div><h3 id="deployment">Deployment</h3>
<p>Pod ã® rolling update ã‚„ rollback ãªã©ã‚’è¡Œã†ï¼
ReplicaSet ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã§ï¼ŒPod ã‚’æŒ‡å®šã•ã‚ŒãŸæ•°ï¼ˆReplica æ•°ï¼‰èª¿æ•´ã™ã‚‹ï¼
è¶³ã‚Šãªã„å ´åˆã¯è¿½åŠ ã—ï¼Œå¤šã„å ´åˆã¯å‰Šé™¤ã™ã‚‹ï¼
ã“ã®ä»•çµ„ã¿ã§ Node ã®éšœå®³ã‚„ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã§ pod ãŒè¶³ã‚Šãªããªã£ãŸå ´åˆã‚‚è‡ªå‹•çš„ã« Pod ãŒè¿½åŠ ã•ã‚Œã‚‹ï¼</p>
<p>Deployment ã¯ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒã‚ã£ãŸå ´åˆã«
æ–°ã—ã„ä»•æ§˜ã® ReplicaSet ã‚’ä½œæˆã—ï¼Œå…¨ä½“ã® Pod ã‚’èª¿æ•´ã—ãªãŒã‚‰æ–°ã—ã„ä»•æ§˜ã® Pod ã«ç½®ãæ›ãˆã‚‹
ï¼ˆãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆï¼‰ï¼
Recreate ã®å ´åˆã¯å…¨ã¦ã® Pod ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰æ–°ã—ã„ Pod Template ã‚’ã‚‚ã¨ã« Pod ã‚’ä½œæˆã™ã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">app</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">strategy</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rollingUpdate</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxSurge</span>: <span style="color:#ae81ff">50</span><span style="color:#ae81ff">%</span> <span style="color:#75715e"># è¤‡è£½æ•°ã‚’è¶…ãˆã¦ã„ã„è¨±å®¹é‡</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxUnavailable</span>: <span style="color:#ae81ff">0</span><span style="color:#ae81ff">%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">app</span>: <span style="color:#ae81ff">nginx</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get deploy
</span></span><span style="display:flex;"><span>NAME    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style="display:flex;"><span>nginx   2/2     <span style="color:#ae81ff">2</span>            <span style="color:#ae81ff">2</span>           1s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get rs <span style="color:#75715e"># ReplicaSet</span>
</span></span><span style="display:flex;"><span>NAME               DESIRED   CURRENT   READY   AGE
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c   <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>       9s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get po <span style="color:#75715e"># Pod</span>
</span></span><span style="display:flex;"><span>NAME                     READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-qkmz2   1/1     Running   <span style="color:#ae81ff">0</span>          15s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-rdfv5   1/1     Running   <span style="color:#ae81ff">0</span>          15s
</span></span></code></pre></div><p>manifest ã®å†…å®¹ã‚’å¤‰ãˆã¦æ›´æ–°ã—ã¦ã¿ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:k8s_play&gt;kubectl apply -f nginx.yaml
</span></span><span style="display:flex;"><span>deployment.apps/nginx configured
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:k8s_play&gt;kubectl get deploy
</span></span><span style="display:flex;"><span>NAME    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style="display:flex;"><span>nginx   2/2     <span style="color:#ae81ff">0</span>            <span style="color:#ae81ff">2</span>           2m9s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:k8s_play&gt;kubectl get rs
</span></span><span style="display:flex;"><span>NAME               DESIRED   CURRENT   READY   AGE
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c   <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>       2m22s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:k8s_play&gt;kubectl get po <span style="color:#75715e"># pause ã§æ­¢ã‚ã¦ã„ã‚‹ã®ã§ç‰¹ã«å¤‰åŒ–ã¯ãªã„</span>
</span></span><span style="display:flex;"><span>NAME                     READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-qkmz2   1/1     Running   <span style="color:#ae81ff">0</span>          2m35s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-rdfv5   1/1     Running   <span style="color:#ae81ff">0</span>          2m35s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:k8s_play&gt;kubectl rollout resume deploy nginx
</span></span><span style="display:flex;"><span>deployment.apps/nginx resumed
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:k8s_play&gt;kubectl get deploy
</span></span><span style="display:flex;"><span>NAME    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style="display:flex;"><span>nginx   2/2     <span style="color:#ae81ff">2</span>            <span style="color:#ae81ff">2</span>           3m45s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:k8s_play&gt;kubectl get rs <span style="color:#75715e"># 77b4fdf86c -&gt; 7544d696d4</span>
</span></span><span style="display:flex;"><span>NAME               DESIRED   CURRENT   READY   AGE
</span></span><span style="display:flex;"><span>nginx-7544d696d4   <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>       28s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c   <span style="color:#ae81ff">0</span>         <span style="color:#ae81ff">0</span>         <span style="color:#ae81ff">0</span>       3m51s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:k8s_play&gt;kubectl get po <span style="color:#75715e"># å®Œå…¨ã«ç½®ãæ›ã‚ã£ã¦ã„ã‚‹</span>
</span></span><span style="display:flex;"><span>NAME                     READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   1/1     Running   <span style="color:#ae81ff">0</span>          25s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   1/1     Running   <span style="color:#ae81ff">0</span>          29s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:k8s_play&gt;kubectl rollout history deploy nginx
</span></span><span style="display:flex;"><span>deployment.apps/nginx
</span></span><span style="display:flex;"><span>REVISION  CHANGE-CAUSE
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>         &lt;none&gt;
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>         &lt;none&gt;
</span></span></code></pre></div><p>ä¸‹è¨˜ã¯ rollout ã—ã¦ã„ã‚‹ã¨ãã®ãƒ­ã‚°
æ—§ï¼šqkmz2
æ—§ï¼šrdfv5
æ–°ï¼š6s2tb
æ–°ï¼šbqblr</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt; kubectl get po -w
</span></span><span style="display:flex;"><span>NAME                     READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-qkmz2   1/1     Running   <span style="color:#ae81ff">0</span>          3m8s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-rdfv5   1/1     Running   <span style="color:#ae81ff">0</span>          3m8s <span style="color:#75715e"># &lt;- æ—§ãŒå‹•ã„ã¦ã„ã‚‹</span>
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   0/1     Pending   <span style="color:#ae81ff">0</span>          0s <span style="color:#75715e"># &lt;- æ–°ãŒç”¨æ„ã•ã‚Œã‚‹</span>
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   0/1     Pending   <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   0/1     ContainerCreating   <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   1/1     Running             <span style="color:#ae81ff">0</span>          3s <span style="color:#75715e"># &lt;- maxSurge ãŒ 50% ãªã®ã§æ–°ã—ã„ã‚‚ã®ãŒä¸€ã¤è¿½åŠ ã•ã‚Œã‚‹</span>
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-qkmz2   1/1     Terminating         <span style="color:#ae81ff">0</span>          3m26s <span style="color:#75715e"># &lt;- æ—§ãŒä¸€ã¤æ­¢ã¾ã‚‹</span>
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   0/1     Pending             <span style="color:#ae81ff">0</span>          0s <span style="color:#75715e"># &lt;- æ–°ãŒç”¨æ„ã•ã‚Œã‚‹</span>
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   0/1     Pending             <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   0/1     ContainerCreating   <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-qkmz2   0/1     Terminating         <span style="color:#ae81ff">0</span>          3m27s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-qkmz2   0/1     Terminating         <span style="color:#ae81ff">0</span>          3m28s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-qkmz2   0/1     Terminating         <span style="color:#ae81ff">0</span>          3m28s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-qkmz2   0/1     Terminating         <span style="color:#ae81ff">0</span>          3m28s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   1/1     Running             <span style="color:#ae81ff">0</span>          3s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-rdfv5   1/1     Terminating         <span style="color:#ae81ff">0</span>          3m30s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-rdfv5   0/1     Terminating         <span style="color:#ae81ff">0</span>          3m30s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-rdfv5   0/1     Terminating         <span style="color:#ae81ff">0</span>          3m31s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-rdfv5   0/1     Terminating         <span style="color:#ae81ff">0</span>          3m31s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-rdfv5   0/1     Terminating         <span style="color:#ae81ff">0</span>          3m31s
</span></span></code></pre></div><p>rollback ã™ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl rollout undo deploy nginx --to-revision <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>deployment.apps/nginx rolled back
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get deploy
</span></span><span style="display:flex;"><span>NAME    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style="display:flex;"><span>nginx   2/2     <span style="color:#ae81ff">2</span>            <span style="color:#ae81ff">2</span>           9m55s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get rs
</span></span><span style="display:flex;"><span>NAME               DESIRED   CURRENT   READY   AGE
</span></span><span style="display:flex;"><span>nginx-7544d696d4   <span style="color:#ae81ff">0</span>         <span style="color:#ae81ff">0</span>         <span style="color:#ae81ff">0</span>       6m33s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c   <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>       9m56s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt;kubectl get po
</span></span><span style="display:flex;"><span>NAME                     READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-6b7sm   1/1     Running   <span style="color:#ae81ff">0</span>          14s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-fbwgf   1/1     Running   <span style="color:#ae81ff">0</span>          10s
</span></span></code></pre></div><p>ã¡ã‚ƒã‚“ã¨å¤ã„ ReplicaSet ã‚’ä½¿ã£ã¦ã„ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nginx-77b4fdf86c-6b7sm   0/1     Pending             <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-6b7sm   0/1     Pending             <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-6b7sm   0/1     ContainerCreating   <span style="color:#ae81ff">0</span>          1s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-6b7sm   1/1     Running             <span style="color:#ae81ff">0</span>          4s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   1/1     Terminating         <span style="color:#ae81ff">0</span>          6m24s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-fbwgf   0/1     Pending             <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-fbwgf   0/1     Pending             <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-fbwgf   0/1     ContainerCreating   <span style="color:#ae81ff">0</span>          0s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   0/1     Terminating         <span style="color:#ae81ff">0</span>          6m25s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   0/1     Terminating         <span style="color:#ae81ff">0</span>          6m25s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   0/1     Terminating         <span style="color:#ae81ff">0</span>          6m25s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-bqblr   0/1     Terminating         <span style="color:#ae81ff">0</span>          6m25s
</span></span><span style="display:flex;"><span>nginx-77b4fdf86c-fbwgf   1/1     Running             <span style="color:#ae81ff">0</span>          3s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   1/1     Terminating         <span style="color:#ae81ff">0</span>          6m23s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   0/1     Terminating         <span style="color:#ae81ff">0</span>          6m24s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   0/1     Terminating         <span style="color:#ae81ff">0</span>          6m24s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   0/1     Terminating         <span style="color:#ae81ff">0</span>          6m24s
</span></span><span style="display:flex;"><span>nginx-7544d696d4-6s2tb   0/1     Terminating         <span style="color:#ae81ff">0</span>          6m24s
</span></span></code></pre></div><h2 id="service">Service</h2>
<p>Pod ã¸ã®æ¥ç¶šã«é–¢ã—ã¦è² è·åˆ†æ•£ãªã©ã‚’ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼</p>
<ul>
<li>clusterIP: kubernetes å†…ã®é€šä¿¡ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãï¼Œã‚¯ãƒ©ã‚¹ã‚¿å†…ã§ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ‰•ã„å‡ºã•ã‚Œï¼Œãã‚Œã‚’åˆ©ç”¨ã—ã¦ Pod é–“ã®é€šä¿¡ã‚’è¡Œã†ï¼</li>
<li>NodePort: Node ã®ãƒ©ãƒ³ãƒ€ãƒ ãªãƒãƒ¼ãƒˆã‚’ä½¿ã£ã¦å¤–éƒ¨ã‚µãƒ¼ãƒã¨ã®é€šä¿¡ã‚’è¡Œã†</li>
<li>LoadBalancer: NodePort ã® service ã‚’ä½œæˆã—ï¼Œå¤–éƒ¨ã® LoadBalancer ã§è»¢é€ã‚’ã—ã¦ã‚‚ã‚‰ã†</li>
<li>ExternalName: å¤–éƒ¨ã®ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½œæˆã™ã‚‹</li>
</ul>
<p>ä¸‹è¨˜ã¯serviceã®ä¾‹ã§ï¼Œé©å½“ãª Pod ã¨ é©å½“ãª Pod ã§é€šä¿¡ã™ã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">NodePort</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt; kubectl get all
</span></span><span style="display:flex;"><span>NAME                        READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>pod/nginx-55f598f8d-8r8cv   1/1     Running   <span style="color:#ae81ff">0</span>          2m20s
</span></span><span style="display:flex;"><span>pod/nginx-55f598f8d-jp76l   1/1     Running   <span style="color:#ae81ff">0</span>          2m20s
</span></span><span style="display:flex;"><span>pod/nginx-55f598f8d-q5v7r   1/1     Running   <span style="color:#ae81ff">0</span>          2m20s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NAME                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span style="color:#f92672">(</span>S<span style="color:#f92672">)</span>        AGE
</span></span><span style="display:flex;"><span>service/kubernetes   ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP        2m27s
</span></span><span style="display:flex;"><span>service/nginx        ClusterIP   10.101.95.207   &lt;none&gt;        80/TCP         74s
</span></span><span style="display:flex;"><span>service/nginx-np     NodePort    10.111.133.95   &lt;none&gt;        80:30626/TCP   14s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NAME                    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style="display:flex;"><span>deployment.apps/nginx   3/3     <span style="color:#ae81ff">3</span>            <span style="color:#ae81ff">3</span>           2m20s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NAME                              DESIRED   CURRENT   READY   AGE
</span></span><span style="display:flex;"><span>replicaset.apps/nginx-55f598f8d   <span style="color:#ae81ff">3</span>         <span style="color:#ae81ff">3</span>         <span style="color:#ae81ff">3</span>       2m20s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\k</span>8s_play&gt; kubectl run alpine -it --rm --image alpine -- ash
</span></span><span style="display:flex;"><span>If you don<span style="color:#960050;background-color:#1e0010">&#39;</span>t see a command prompt, try pressing enter.
</span></span><span style="display:flex;"><span>/ <span style="color:#75715e"># env</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>NGINX_NP_SERVICE_HOST<span style="color:#f92672">=</span>10.111.133.95  &lt;- ä¸€ç·’
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>NGINX_SERVICE_HOST<span style="color:#f92672">=</span>10.101.95.207 &lt;- ä¸€ç·’
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/ <span style="color:#75715e"># wget -O - $NGINX_SERVICE_HOST</span>
</span></span><span style="display:flex;"><span>Connecting to 10.101.95.207 <span style="color:#f92672">(</span>10.101.95.207:80<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>writing to stdout
</span></span><span style="display:flex;"><span>&lt;!DOCTYPE html&gt;
</span></span><span style="display:flex;"><span>&lt;html&gt;
</span></span><span style="display:flex;"><span>&lt;head&gt;
</span></span><span style="display:flex;"><span>&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span style="display:flex;"><span>&lt;style&gt;
</span></span><span style="display:flex;"><span>html <span style="color:#f92672">{</span> color-scheme: light dark; <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>body <span style="color:#f92672">{</span> width: 35em; margin: <span style="color:#ae81ff">0</span> auto;
</span></span><span style="display:flex;"><span>font-family: Tahoma, Verdana, Arial, sans-serif; <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>&lt;/style&gt;
</span></span><span style="display:flex;"><span>&lt;/head&gt;
</span></span><span style="display:flex;"><span>&lt;body&gt;
</span></span><span style="display:flex;"><span>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
</span></span><span style="display:flex;"><span>&lt;p&gt;If you see this page, the ng
</span></span></code></pre></div><h3 id="ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯">ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯</h3>
<ul>
<li>
<p>LivenessProbe: ã‚³ãƒ³ãƒ†ãƒŠã®ç”Ÿå­˜ãƒã‚§ãƒƒã‚¯ã‚’ã™ã‚‹ï¼ã“ã‚ŒãŒé€šã‚‰ãªã„å ´åˆã¯å†ç”Ÿæˆã•ã‚Œã‚‹ï¼</p>
</li>
<li>
<p>ReadinessProbe: ã‚³ãƒ³ãƒ†ãƒŠã® Ready çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ï¼init ã‚„ å‡¦ç†ä¸­ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè¿”ã›ãªã„å ´åˆã«å¯¾å¿œã™ã‚‹ï¼</p>
</li>
<li>
<p>exec: ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ï¼ã“ã®çµ‚äº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ 0 ãªã‚‰ healthy ã¨ã„ã†ã“ã¨ã«ãªã‚‹ï¼</p>
</li>
<li>
<p>httpGet: HTTP ã® GET ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç™ºè¡Œã™ã‚‹ï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§åˆ¤æ–­ã™ã‚‹</p>
</li>
<li>
<p>topSocket: TCP ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãŒé–‹ã‘ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ï¼</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">livenessProbe</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">httpGet</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Liveness:       http-get http://:80/ delay<span style="color:#f92672">=</span>0s timeout<span style="color:#f92672">=</span>1s period<span style="color:#f92672">=</span>5s <span style="color:#75715e">#success=1 #failure=5</span>
</span></span></code></pre></div><p>index.html ã‚’æ¶ˆã—ãŸå ´åˆ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Warning  Unhealthy  1s <span style="color:#f92672">(</span>x6 over 26s<span style="color:#f92672">)</span>    kubelet            Liveness probe failed: HTTP probe failed with statuscode: <span style="color:#ae81ff">403</span> &lt;- http ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰
</span></span></code></pre></div>
    </div>
    <div class="post-footer">
      
      
    </div>
  </article>
  <hr>
  <p>Â© side-realms All rights reserved.</p>

    </main>
  </body>
</html>
