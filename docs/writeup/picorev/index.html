<!doctype html>
<html lang="en-us">
  <head>
    <title>picoCTF ã® rev å…¨éƒ¨è§£ã // ãŠèŒ¶ã¯ç¶¾é·¹æ´¾</title>
    <link rel="shortcut icon" href="../../favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="KoheiDoi" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="../../css/main.min.3fb9065bb18f896621f7ce2fad5bbbafdf9954fbe571b5e41c6e59a8cbacc8ef.css" />
    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="picoCTF ã® rev å…¨éƒ¨è§£ã"/>
<meta name="twitter:description" content="CTF ã®å•é¡Œã‚’è§£ã„ã¦ã„ã‚‹ã¨ï¼Œè§£ã‘ã¯ã™ã‚‹ã‘ã©ç•°å¸¸ã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼Œã¿ãŸã„ãªã“ã¨ãŒå¤šã„ï¼ rev ã«é™ã‚Œã°ï¼Œã“ã‚Œã¯ï¼Œãƒ„ãƒ¼ãƒ«ã®ä½¿ã„æ–¹ãŒç”˜ã‹ã£ãŸã‚Šï¼Œã¤ã¾ã¿é£Ÿã„çš„ã« rev ã‚’ã‚„ã£ã¦ããŸã®ã§å¸¸è­˜ãŒæ¬ è½ã—ã¦ã„ã¦é å›ã‚Šã—ã¦ã„ãŸã‚Šï¼Œãã‚‚ãã‚‚ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã‚’èª­ã‚€ç­‹åŠ›ãŒå…¨ç„¶ãªã‹ã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒåŸå› ã ã¨åˆ†ã‹ã£ã¦ã„ã‚‹ï¼ ãªã®ã§ï¼Œæ•°ã‚’ã“ãªãã†ä½œæˆ¦ã§ï¼ŒçŸ¥ã‚Šåˆã„ã«ã‚ªã‚¹ã‚¹ãƒ¡ã•ã‚ŒãŸ picoCTF ã® rev ã‚’å…¨éƒ¨è§£ã„ã¦ã¿ã‚‹ï¼ 2~3 æ—¥ãã‚‰ã„ã§å®Œèµ°ã§ããŸã‚‰è‰¯ã„
Transformation &#39;&#39;.join([chr((ord(flag[i]) &lt;&lt; 8) &#43; ord(flag[i &#43; 1])) for i in range(0, len(flag), 2)]) ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ encoded_flag = &#34;ç©æ¯ä”ä™»ã„¶å½¢æ¥´çŸæ¥®ç´ãŒ´æ‘Ÿæ½¦å¼¸å¼²ã˜¶ã ´æŒ²ã½&#34; flag = [] for i in range(len(encoded_flag)): tmp1 = ord(encoded_flag[i]) &amp; 0xFF tmp2 = ord(encoded_flag[i]) &gt;&gt; 8 flag &#43;= chr(tmp2) flag &#43;= chr(tmp1) print(&#34;&#34;.join(flag)) keygenme-py Arcane Calculator ãªã‚‹ã‚‚ã®ãŒå‹•ã„ã¦ã„ã¦ï¼Œãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’å…¥ã‚Œã‚‹ã¨ã„ã„ã‚‰ã—ã„ def check_key(key, username_trial): global key_full_template_trial if len(key) != len(key_full_template_trial): return False else: # Check static base key part --v i = 0 for c in key_part_static1_trial: if key[i] !"/>

    <meta property="og:title" content="picoCTF ã® rev å…¨éƒ¨è§£ã" />
<meta property="og:description" content="CTF ã®å•é¡Œã‚’è§£ã„ã¦ã„ã‚‹ã¨ï¼Œè§£ã‘ã¯ã™ã‚‹ã‘ã©ç•°å¸¸ã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼Œã¿ãŸã„ãªã“ã¨ãŒå¤šã„ï¼ rev ã«é™ã‚Œã°ï¼Œã“ã‚Œã¯ï¼Œãƒ„ãƒ¼ãƒ«ã®ä½¿ã„æ–¹ãŒç”˜ã‹ã£ãŸã‚Šï¼Œã¤ã¾ã¿é£Ÿã„çš„ã« rev ã‚’ã‚„ã£ã¦ããŸã®ã§å¸¸è­˜ãŒæ¬ è½ã—ã¦ã„ã¦é å›ã‚Šã—ã¦ã„ãŸã‚Šï¼Œãã‚‚ãã‚‚ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã‚’èª­ã‚€ç­‹åŠ›ãŒå…¨ç„¶ãªã‹ã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒåŸå› ã ã¨åˆ†ã‹ã£ã¦ã„ã‚‹ï¼ ãªã®ã§ï¼Œæ•°ã‚’ã“ãªãã†ä½œæˆ¦ã§ï¼ŒçŸ¥ã‚Šåˆã„ã«ã‚ªã‚¹ã‚¹ãƒ¡ã•ã‚ŒãŸ picoCTF ã® rev ã‚’å…¨éƒ¨è§£ã„ã¦ã¿ã‚‹ï¼ 2~3 æ—¥ãã‚‰ã„ã§å®Œèµ°ã§ããŸã‚‰è‰¯ã„
Transformation &#39;&#39;.join([chr((ord(flag[i]) &lt;&lt; 8) &#43; ord(flag[i &#43; 1])) for i in range(0, len(flag), 2)]) ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ encoded_flag = &#34;ç©æ¯ä”ä™»ã„¶å½¢æ¥´çŸæ¥®ç´ãŒ´æ‘Ÿæ½¦å¼¸å¼²ã˜¶ã ´æŒ²ã½&#34; flag = [] for i in range(len(encoded_flag)): tmp1 = ord(encoded_flag[i]) &amp; 0xFF tmp2 = ord(encoded_flag[i]) &gt;&gt; 8 flag &#43;= chr(tmp2) flag &#43;= chr(tmp1) print(&#34;&#34;.join(flag)) keygenme-py Arcane Calculator ãªã‚‹ã‚‚ã®ãŒå‹•ã„ã¦ã„ã¦ï¼Œãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’å…¥ã‚Œã‚‹ã¨ã„ã„ã‚‰ã—ã„ def check_key(key, username_trial): global key_full_template_trial if len(key) != len(key_full_template_trial): return False else: # Check static base key part --v i = 0 for c in key_part_static1_trial: if key[i] !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://side-realms.github.io/writeup/picorev/" /><meta property="article:section" content="writeup" />
<meta property="article:published_time" content="2024-04-07T19:40:38+09:00" />
<meta property="article:modified_time" content="2024-04-07T19:40:38+09:00" />

    <style>
      .hr1 {
  position: relative;
	height: 3px;
	border-width: 0;
	background-color: #00bcd4;
	background-image: -webkit-linear-gradient( 135deg, #FD6585 10%, #0D25B9 100%);
	background-image: linear-gradient( 135deg, #FD6585 10%, #0D25B9 100%);
}
    </style>

  </head>
  <body>
    <header class="app-header">
      <a href="http://side-realms.github.io"><img class="app-header-avatar" src="../../images/avatar.jpg" alt="KoheiDoi" /></a>
      <span class="app-header-title">ãŠèŒ¶ã¯ç¶¾é·¹æ´¾</span>
      <p>æœ€è¿‘ã¯é¢¯ã‚‚å¥½ã</p>
      <p><font size="1">å†…å®¹ã®æ­£ç¢ºæ€§ã¯ä¿è¨¼ã—ã¦ã„ã¾ã›ã‚“ğŸ¶</font></p>
      <nav class="app-header-menu">
          <font size="5">
          <a class="app-header-menu-item" href="../../">Home</a>
          </font>
          <br>
            
          
          <font size="5">
          <a class="app-header-menu-item" href="../../log">life log</a>
          </font>
          <br>
            
          
          <font size="5">
          <a class="app-header-menu-item" href="../../treasure/">treasure trove</a>
          </font>
          <br>
      </nav>

      <hr class="hr1">
      <nav class="app-header-menu">
          <font size="4">
          <a class="app-header-menu-item" href="../../sound">sound</a>
          </font>
          <br>
            
          
          <font size="4">
          <a class="app-header-menu-item" href="../../container">container</a>
          </font>
          <br>
            
          
          <font size="4">
          <a class="app-header-menu-item" href="../../hardware">hardware</a>
          </font>
          <br>
            
          
          <font size="4">
          <a class="app-header-menu-item" href="../../writeup">writeup</a>
          </font>
          <br>
            
          
          <font size="4">
          <a class="app-header-menu-item" href="../../other">other</a>
          </font>
          <br>
      </nav>

      <hr class="hr1">
      <div class="app-header-social">
        
          <a href="https://github.com" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://twitter.com" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>Twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
          </a>
        
      </div>
      <div class="app-footer-copyright">
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">picoCTF ã® rev å…¨éƒ¨è§£ã</h1>
      </style>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Apr 7, 2024
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          22 min read
        </div>
      </div>
      <hr>
    </header>
    <div class="post-content">
      <p>CTF ã®å•é¡Œã‚’è§£ã„ã¦ã„ã‚‹ã¨ï¼Œè§£ã‘ã¯ã™ã‚‹ã‘ã©ç•°å¸¸ã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼Œã¿ãŸã„ãªã“ã¨ãŒå¤šã„ï¼
rev ã«é™ã‚Œã°ï¼Œã“ã‚Œã¯ï¼Œãƒ„ãƒ¼ãƒ«ã®ä½¿ã„æ–¹ãŒç”˜ã‹ã£ãŸã‚Šï¼Œã¤ã¾ã¿é£Ÿã„çš„ã« rev ã‚’ã‚„ã£ã¦ããŸã®ã§å¸¸è­˜ãŒæ¬ è½ã—ã¦ã„ã¦é å›ã‚Šã—ã¦ã„ãŸã‚Šï¼Œãã‚‚ãã‚‚ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã‚’èª­ã‚€ç­‹åŠ›ãŒå…¨ç„¶ãªã‹ã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒåŸå› ã ã¨åˆ†ã‹ã£ã¦ã„ã‚‹ï¼
ãªã®ã§ï¼Œæ•°ã‚’ã“ãªãã†ä½œæˆ¦ã§ï¼ŒçŸ¥ã‚Šåˆã„ã«ã‚ªã‚¹ã‚¹ãƒ¡ã•ã‚ŒãŸ picoCTF ã® rev ã‚’å…¨éƒ¨è§£ã„ã¦ã¿ã‚‹ï¼
2~3 æ—¥ãã‚‰ã„ã§å®Œèµ°ã§ããŸã‚‰è‰¯ã„</p>
<h3 id="transformation">Transformation</h3>
<ul>
<li><code>''.join([chr((ord(flag[i]) &lt;&lt; 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)])</code> ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>encoded_flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ç©æ¯ä”ä™»ã„¶å½¢æ¥´çŸæ¥®ç´ãŒ´æ‘Ÿæ½¦å¼¸å¼²ã˜¶ã ´æŒ²ã½&#34;</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(encoded_flag)):
</span></span><span style="display:flex;"><span>  tmp1 <span style="color:#f92672">=</span> ord(encoded_flag[i]) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF</span>
</span></span><span style="display:flex;"><span>  tmp2 <span style="color:#f92672">=</span> ord(encoded_flag[i]) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>  flag <span style="color:#f92672">+=</span> chr(tmp2)
</span></span><span style="display:flex;"><span>  flag <span style="color:#f92672">+=</span> chr(tmp1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(flag))
</span></span></code></pre></div><h3 id="keygenme-py">keygenme-py</h3>
<ul>
<li>Arcane Calculator ãªã‚‹ã‚‚ã®ãŒå‹•ã„ã¦ã„ã¦ï¼Œãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’å…¥ã‚Œã‚‹ã¨ã„ã„ã‚‰ã—ã„</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_key</span>(key, username_trial):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> key_full_template_trial
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(key) <span style="color:#f92672">!=</span> len(key_full_template_trial):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check static base key part --v</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> key_part_static1_trial:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> c:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># TODO : test performance on toolbox container</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check dynamic part --v</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">4</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">5</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">3</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">6</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">2</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">7</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">1</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">8</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span></code></pre></div><p>ã“ã‚Œã‚’è¦‹ã¦ï¼Œã‚ã¨ã¯äº‹å‰ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹æ–‡å­—åˆ—ã‚’å½“ã¦ã¯ã‚ã‚Œã°ã„ã„</p>
<h3 id="armssebly-0">ARMssebly 0</h3>
<p>ARM ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªãŒã‚ãŸã•ã‚Œã‚‹ã®ã§ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>aarch64-linux-gnu-as chall.S -o chall
</span></span></code></pre></div><p>Ghidra ã§è¦‹ã‚‹ã¨æ•´æ•°ã®å¤§å°ã‚’æ¯”è¼ƒã—ã¦ã„ã‚‹ã ã‘ãªã®ã§å¤§ãã„æ–¹ãŒç­”ãˆ</p>
<h3 id="vault-door-training">vault-door-training</h3>
<p>java ã®ã‚½ãƒ¼ã‚¹ã‚’èª­ã‚€ã ã‘</p>
<h3 id="speeds-and-feeds">speeds and feeds</h3>
<p>G-code ãŒå‡ºã¦ãã‚‹ã®ã§ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ï¼
<a href="https://ncviewer.com/">ã„ã„ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ãƒˆ</a>ãŒã‚ã£ãŸ</p>
<h3 id="shop">Shop</h3>
<p>è² ã®å€‹æ•°è²·ã†ã¨æ‰€æŒé‡‘ãŒå¢—ãˆã‚‹</p>
<h3 id="armeembly-1">Armeembly 1</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0xd2a</span> <span style="color:#f92672">-</span> param_1
</span></span></code></pre></div><h3 id="armssembly-2">ARMssembly 2</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_4 <span style="color:#f92672">&lt;</span> param_1; local_4 <span style="color:#f92672">=</span> local_4 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    local_8 <span style="color:#f92672">=</span> local_8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>ãªã‚“ã‹ä½•ãŒã—ãŸã„ã®ã‹åˆ†ã‹ã‚‰ãªã„å•é¡ŒãŒç¶šãã®ã§ï¼Œã¡ã‚ƒã‚“ã¨æ‰‹ã‚’å‹•ã‹ã—ãŸå•é¡Œã ã‘ã®ã›ã‚‹</p>
<h3 id="gdb-baby-step2">GDB baby step2</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb debugger0_b
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>info functions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b main
</span></span><span style="display:flex;"><span>layout asm
</span></span><span style="display:flex;"><span>r
</span></span></code></pre></div><p>ã“ã®æ™‚ç‚¹ã§ï¼Œmain é–¢æ•°ã® ret (é–¢æ•°æŠœã‘)ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒåˆ†ã‹ã‚‹ã®ã§</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>b *0x401142
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c
</span></span><span style="display:flex;"><span>info register rip
</span></span><span style="display:flex;"><span>print/d $eax
</span></span></code></pre></div><h3 id="gdb-baby-step4">GDB baby step4</h3>
<p>gdb ã§ main ã« breakpoint ã‚’è¨­ç½®ã—ï¼Œã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œã™ã‚‹ã¨ imul ãŒè¦‹ãˆã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>   0x401106 &lt;func1&gt;       endbr64 
</span></span><span style="display:flex;"><span>   0x40110a &lt;func1+4&gt;     push   rbp
</span></span><span style="display:flex;"><span>   0x40110b &lt;func1+5&gt;     mov    rbp, rsp
</span></span><span style="display:flex;"><span>   0x40110e &lt;func1+8&gt;     mov    dword ptr <span style="color:#f92672">[</span>rbp - 4<span style="color:#f92672">]</span>, edi
</span></span><span style="display:flex;"><span>   0x401111 &lt;func1+11&gt;    mov    eax, dword ptr <span style="color:#f92672">[</span>rbp - 4<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span> â–º 0x401114 &lt;func1+14&gt;    imul   eax, eax, 0x3269
</span></span><span style="display:flex;"><span>   0x40111a &lt;func1+20&gt;    pop    rbp
</span></span><span style="display:flex;"><span>   0x40111b &lt;func1+21&gt;    ret    
</span></span></code></pre></div><p>ã¨ã„ã†ã“ã¨ã§ 0x3269</p>
<h3 id="picker-i">Picker I</h3>
<p>å…¥åŠ›ã—ãŸé–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ãã‚Œã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå‹•ã„ã¦ã„ã‚‹ï¼
win() ã‚’å®Ÿè¡Œã™ã‚‹ã¨ flag.txt ã‚’å±•é–‹ã—ã¦ãã‚Œã‚‹ã®ã§ï¼Œã“ã‚Œã‚’æ–‡å­—åˆ—ã«ç›´ã›ã°ã„ã„</p>
<h3 id="picker-ii">Picker II</h3>
<p>ã“ã‚“ã©ã¯å…¥åŠ›ãŒãƒ•ã‚£ãƒ«ã‚¿ã•ã‚Œã¦ã„ã¦ï¼Œã€Œwinã€ ãŒæ‰“ã¦ãªããªã£ã¦ã„ã‚‹ï¼
ä¸€æ–¹ã§ï¼Œmain ã® eval ã¯ãã®ã¾ã¾ãªã®ã§ï¼Œexec ã®ã‚ˆã†ã«ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒé€šã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt; print<span style="color:#f92672">(</span>open<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;flag.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span><span style="color:#f92672">)</span>.read<span style="color:#f92672">())</span>
</span></span><span style="display:flex;"><span>picoCTF<span style="color:#f92672">{</span>f1l73r5_f41l_c0d3_r3f4c70r_m1gh7_5ucc33d_95d44590<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;NoneType&#39;</span> object is not callable
</span></span></code></pre></div><h3 id="picker-iii">Picker III</h3>
<p>å¿…ãšå‘¼ã³å‡ºã•ã‚Œã‚‹ <code>call_func()</code> é–¢æ•°ã®æœ€å¾Œã« <code>eval(func_name+'()')</code> ãŒã‚ã‚‹ã®ã§ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_func</span>(n):
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">global</span> func_table
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Check table for viability</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>( <span style="color:#f92672">not</span> check_table() ):
</span></span><span style="display:flex;"><span>    print(CORRUPT_MESSAGE)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Get function name from table</span>
</span></span><span style="display:flex;"><span>  func_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>  func_name_offset <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> FUNC_TABLE_ENTRY_SIZE
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(func_name_offset, func_name_offset<span style="color:#f92672">+</span>FUNC_TABLE_ENTRY_SIZE):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>( func_table[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>):
</span></span><span style="display:flex;"><span>      func_name <span style="color:#f92672">=</span> func_table[func_name_offset:i]
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>( func_name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;&#39;</span> ):
</span></span><span style="display:flex;"><span>    func_name <span style="color:#f92672">=</span> func_table[func_name_offset:func_name_offset<span style="color:#f92672">+</span>FUNC_TABLE_ENTRY_SIZE]
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> func_name
</span></span></code></pre></div><p>func_name ãŒ win ã«ãªã‚Œã°ã„ã„</p>
<p>func_table ã‚’å‚ç…§ã—ã¦ã„ã‚‹ã®ã§ï¼Œæ›¸ãæ›ãˆãŸã„ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>â”Œâ”€â”€<span style="color:#f92672">(</span>kaliã‰¿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/CTF<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>â””â”€$ nc saturn.picoctf.net 51363
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt; <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>Please enter variable name to write: func_table
</span></span><span style="display:flex;"><span>Please enter new value of variable: <span style="color:#e6db74">&#39;win                     read_variable                   write_variable                               &#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt; <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x37 0x68 0x31 0x35 0x5f 0x31 0x35 0x5f 0x77 0x68 0x34 0x37 0x5f 0x77 0x33 <span style="color:#ae81ff">07</span> 0x31 0x37 0x68 0x5f 0x75 0x35 0x33 0x72 0x35 0x5f 0x31 0x6e 0x5f 0x63 0x68 0x34 0x72 0x67 0x33 0x5f 0x32 0x32 0x36 0x7d 
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt;           
</span></span></code></pre></div><h3 id="packer">packer</h3>
<p><code>strings</code> ã™ã‚‹ã¨ãªã‚“ã‹é›£èª­åŒ–ã•ã‚ŒãŸæ–‡å­—åˆ—ãŒãŸãã•ã‚“å‡ºã¦ãã‚‹ï¼
packer ã ã—ï¼Œ<code>strings</code> ã®çµæœã«ã‚‚ <code>UPX packer</code> ã¿ãŸã„ãªè¨˜è¿°ãŒã‚ã‚‹ã®ã§ï¼Œã‚¢ãƒ³ãƒ‘ãƒƒã‚¯ã—ã¦ã¿ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>upx -d out
</span></span><span style="display:flex;"><span>strings out | grep flag
</span></span></code></pre></div><h3 id="asm1">asm1</h3>
<p>ã‚¢ã‚»ãƒ³ãƒ–ãƒªï¼Œã¡ã‚ƒã‚“ã¨ã¾ã¨ã‚ãŸã“ã¨ãŒãªã„ã®ã§çœŸé¢ç›®ã«ã‚„ã‚‹</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">asm1:
    &lt;+0&gt;:   push   ebp
    &lt;+1&gt;:   mov    ebp,esp
    &lt;+3&gt;:   cmp    DWORD PTR [ebp+0x8],0x3fb
    &lt;+10&gt;:   jg     0x512 &lt;asm1+37&gt;
    &lt;+12&gt;:   cmp    DWORD PTR [ebp+0x8],0x280
    &lt;+19&gt;:   jne    0x50a &lt;asm1+29&gt;
    &lt;+21&gt;:   mov    eax,DWORD PTR [ebp+0x8]
    &lt;+24&gt;:   add    eax,0xa
    &lt;+27&gt;:   jmp    0x529 &lt;asm1+60&gt;
    &lt;+29&gt;:   mov    eax,DWORD PTR [ebp+0x8]
    &lt;+32&gt;:   sub    eax,0xa
    &lt;+35&gt;:   jmp    0x529 &lt;asm1+60&gt;
    &lt;+37&gt;:   cmp    DWORD PTR [ebp+0x8],0x559
    &lt;+44&gt;:   jne    0x523 &lt;asm1+54&gt;
    &lt;+46&gt;:   mov    eax,DWORD PTR [ebp+0x8]
    &lt;+49&gt;:   sub    eax,0xa
    &lt;+52&gt;:   jmp    0x529 &lt;asm1+60&gt;
    &lt;+54&gt;:   mov    eax,DWORD PTR [ebp+0x8]
    &lt;+57&gt;:   add    eax,0xa
    &lt;+60&gt;:   pop    ebp
    &lt;+61&gt;:   ret    
</code></pre><p>ã¾ãš push ebp ã§ï¼Œmain é–¢æ•°ã®ä¸Šã«ä»Šã®ãƒ™ãƒ¼ã‚¹ãƒã‚¤ãƒ³ã‚¿ã‚¢ãƒ‰ãƒ¬ã‚¹(ebp)ã‚’æ ¼ç´ã™ã‚‹ï¼
ã“ã®ã¨ãï¼Œpush ã—ãŸã®ã§ esp ã®å€¤ã¯ -4 ã•ã‚Œã‚‹ï¼
æ¬¡ã«ï¼Œmov ebp,esp ã§ï¼Œesp ã®å€¤ã‚’ ebp ã«æ ¼ç´ã™ã‚‹ï¼
ã“ã‚Œã«ã‚ˆã‚Šï¼Œä»Šã® ebp(main é–¢æ•°ã®åº•)ãŒï¼Œesp(main é–¢æ•° + push ebp ã—ãŸå€¤ã®ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒƒãƒ—)ã«ãªã‚‹ã®ã§ï¼Œesp ã¨ ebp ãŒåŒã˜å€¤ã«ãªã‚‹ï¼</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">    &lt;+0&gt;:   push   ebp
    &lt;+1&gt;:   mov    ebp,esp
</code></pre><p>é€†ã«ï¼Œé–¢æ•°ã‹ã‚‰æˆ»ã‚‹ã¨ãã¯ã¾ãš <code>mov esp,ebp</code> ã§ esp(ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒƒãƒ—) ã« ebp(å®Ÿè¡Œã—ã¦ã„ã‚‹é–¢æ•°ã®ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹)ã®å€¤ã‚’ä»£å…¥ã™ã‚‹ï¼
æ¬¡ã« <code>pop ebp</code> ã‚’ã™ã‚‹ï¼
ã“ã®ã¨ã pop ã•ã‚Œã‚‹ã®ã¯ï¼Œ<code>push ebp</code> ã§ push ã•ã‚ŒãŸ mainé–¢æ•°ã® ebp ãªã®ã§ï¼Œmain é–¢æ•°ã®ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå…ƒã«æˆ»ã‚Šï¼Œesp ã‚‚ +4 ã•ã‚Œã¦ï¼Œé–¢æ•°ã‹ã‚‰æˆ»ã£ã¦ã“ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ï¼</p>
<p>ä»Šå›ã®å ´åˆã¯ï¼Œå¼•æ•°ãŒã‚ã‚‹ï¼
å¼•æ•°ã¯ ebp+8 ã§è¡¨ç¾ã•ã‚Œã¦ã„ã‚‹ï¼
(ebp ã®é€€é¿å…ˆï¼Œesp ã®é€€é¿å…ˆï¼Œå¼•æ•°ã®é †)
å¼•æ•°ã¯ 0x2e0 ã§ï¼Œ0x2e0 &lt; 0x3fb ãªã®ã§ jg ã®ã‚¸ãƒ£ãƒ³ãƒ—ã¯èµ·ã“ã‚‰ãªã„</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">cmp    DWORD PTR [ebp+0x8],0x3fb
jg     0x512 &lt;asm1+37&gt;
</code></pre><p>æ¬¡ã« 0x2e0 != 0x280 ãªã®ã§ ZF = 0 ã§ï¼Œç§»å‹•ã™ã‚‹</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">&lt;+12&gt;:   cmp    DWORD PTR [ebp+0x8],0x280
&lt;+19&gt;:   jne    0x50a &lt;asm1+29&gt;
</code></pre><p>jmp ã¯ä½•ã‚‚ãªãã¦ã‚‚ç§»å‹•ã™ã‚‹</p>
<pre tabindex="0"><code class="language-assebmly" data-lang="assebmly">&lt;+29&gt;:   mov    eax,DWORD PTR [ebp+0x8]
&lt;+32&gt;:   sub    eax,0xa
&lt;+35&gt;:   jmp    0x529 &lt;asm1+60&gt;
</code></pre><pre tabindex="0"><code class="language-assembly" data-lang="assembly">    &lt;+60&gt;:   pop    ebp
    &lt;+61&gt;:   ret    
</code></pre><h3 id="bbbbloat">Bbbbloat</h3>
<p>ghidra ã§è¦‹ã‚‹ã¨æ¯”è¼ƒéƒ¨åˆ†ãŒã‚ã‚‹ã®ã§ï¼Œã“ã‚Œã‚’ãã®ã¾ã¾å…¥åŠ›ã™ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (local_48 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x86187</span>)
</span></span></code></pre></div><h3 id="asm-2">asm 2</h3>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">asm2:
    &lt;+0&gt;:    push   ebp
    &lt;+1&gt;:    mov    ebp,esp
    &lt;+3&gt;:    sub    esp,0x10
    &lt;+6&gt;:    mov    eax,DWORD PTR [ebp+0xc]
    &lt;+9&gt;:    mov    DWORD PTR [ebp-0x4],eax
    &lt;+12&gt;:    mov    eax,DWORD PTR [ebp+0x8]
    &lt;+15&gt;:    mov    DWORD PTR [ebp-0x8],eax
    &lt;+18&gt;:    jmp    0x50c &lt;asm2+31&gt;
    &lt;+20&gt;:    add    DWORD PTR [ebp-0x4],0x1
    &lt;+24&gt;:    add    DWORD PTR [ebp-0x8],0xd1
    &lt;+31&gt;:    cmp    DWORD PTR [ebp-0x8],0x5fa1
    &lt;+38&gt;:    jle    0x501 &lt;asm2+20&gt;
    &lt;+40&gt;:    mov    eax,DWORD PTR [ebp-0x4]
    &lt;+43&gt;:    leave  
    &lt;+44&gt;:    ret    
</code></pre><pre tabindex="0"><code class="language-assembly" data-lang="assembly">    &lt;+6&gt;:    mov    eax,DWORD PTR [ebp+0xc]
    &lt;+9&gt;:    mov    DWORD PTR [ebp-0x4],eax
    &lt;+12&gt;:    mov    eax,DWORD PTR [ebp+0x8]
    &lt;+15&gt;:    mov    DWORD PTR [ebp-0x8],eax
</code></pre><p>å¼•æ•°ã‚’ esp+0x10 ã§åºƒã’ãŸã‚¹ã‚¿ãƒƒã‚¯åˆ†ã«è©°ã‚ã‚‹ï¼</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">    &lt;+31&gt;:    cmp    DWORD PTR [ebp-0x8],0x5fa1
</code></pre><p>ã“ã®ã‚ã¨ï¼Œ ebp-0x8 ã¨ 0x5fa1 ãŒæ¯”è¼ƒã•ã‚Œï¼Œ0x5fa1 ã®å€¤ã‚’è¶…ãˆãªã‘ã‚Œã° 0xd1 ãŒåŠ ç®—ã•ã‚Œã‚‹ï¼
ãªã®ã§ï¼Œ0x2d ã¨ 0x5fa1 ã®å·®ã‚’æ¯”ã¹ï¼Œ0xd1 ã‚’è¶³ã—ãŸå›æ•°åˆ†ï¼Œ0x11 ã« 0x1 ã‚’è¶³ã™ï¼</p>
<ul>
<li>{(0x5fa1 - 0x2d) // 0xd1 } + 1 + 0x2d</li>
</ul>
<h3 id="unpackme">unpackme</h3>
<p>ãŸã¶ã‚“ pakcker ã ã‚ã†ã¨æ€ã„ãªãŒã‚‰è§£ãï¼
radare2 ã®ä½¿ã„æ–¹ã‚’å‹‰å¼·ã—ãªãŒã‚‰è§£ã„ã¦ã¿ã‚‹ï¼</p>
<p>æ­£ã—ã„æ•°å­—ã‚’å…¥åŠ›ã™ã‚‹ã¨ãƒ•ãƒ©ã‚°ã‚’è¿”ã—ã¦ãã‚Œã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã£ã½ã„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>â”Œâ”€â”€<span style="color:#f92672">(</span>kaliã‰¿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/CTF<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>â””â”€$ r2 unpackme-upx            
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x00401c60<span style="color:#f92672">]</span>&gt; aaa
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> <span style="color:#f92672">]</span> Analyze all flags starting with sym. and entry0 <span style="color:#f92672">(</span>aa<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Cannot find basic block <span style="color:#66d9ef">for</span> switch <span style="color:#66d9ef">case</span> at 0x0043f6d3 bbdelta <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze all flags starting with sym. and entry0 <span style="color:#f92672">(</span>aa<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze <span style="color:#66d9ef">function</span> calls <span style="color:#f92672">(</span>aac<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze len bytes of instructions <span style="color:#66d9ef">for</span> references <span style="color:#f92672">(</span>aar<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Finding and parsing C++ vtables <span style="color:#f92672">(</span>avrr<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Type matching analysis <span style="color:#66d9ef">for</span> all functions <span style="color:#f92672">(</span>aaft<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Propagate noreturn information <span style="color:#f92672">(</span>aanr<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Use -AA or aaaa to perform additional experimental analysis.
</span></span></code></pre></div><p>afl ã‚³ãƒãƒ³ãƒ‰ã§ main é–¢æ•°ãŒã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã£ã¦ã„ã‚‹ã®ã§ main ã‚’è§£æã™ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>0x00401c60<span style="color:#f92672">]</span>&gt; s sym.main
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x00401e43<span style="color:#f92672">]</span>&gt; pdf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-- snip --
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>â”‚           0x00401e9c      488d3d61110b.  lea rdi, str.Whats_my_favorite_number__ ; 0x4b3004 ; <span style="color:#e6db74">&#34;What&#39;s my favorite number? &#34;</span> ; int64_t arg1                                                                                            
</span></span><span style="display:flex;"><span>â”‚           0x00401ea3      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x00401ea8      e8f3ec0000     call sym.__printf
</span></span><span style="display:flex;"><span>â”‚           0x00401ead      488d45c4       lea rax, <span style="color:#f92672">[</span>var_3ch<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>â”‚           0x00401eb1      4889c6         mov rsi, rax
</span></span><span style="display:flex;"><span>â”‚           0x00401eb4      488d3d65110b.  lea rdi, <span style="color:#f92672">[</span>0x004b3020<span style="color:#f92672">]</span>       ; <span style="color:#e6db74">&#34;%d&#34;</span> ; const char *format
</span></span><span style="display:flex;"><span>â”‚           0x00401ebb      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x00401ec0      e86bee0000     call sym.__isoc99_scanf     ; int scanf<span style="color:#f92672">(</span>const char *format<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>â”‚           0x00401ec5      8b45c4         mov eax, dword <span style="color:#f92672">[</span>var_3ch<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>â”‚           0x00401ec8      3dcb830b00     cmp eax, 0xb83cb &lt;- ã“ã‚Œ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-- snip --
</span></span></code></pre></div><h3 id="forky">forky</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>piVar1;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  piVar1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">mmap</span>((<span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0x21</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span>piVar1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000000000</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fork</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fork</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fork</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fork</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span>piVar1 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>piVar1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x499602d2</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">doNothing</span>(<span style="color:#f92672">*</span>piVar1);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>doNothing</code> ã«æ¸¡ã•ã‚Œã‚‹å¼•æ•°ã®å€¤ãŒ flag ã«ãªã£ã¦ã„ã‚‹ï¼
piVar1 ãŒæ˜ã‚‰ã‹ã«éµãªã®ã§ï¼Œ fork() ã®å‹•ä½œã‚’è¦‹ã‚‹ï¼</p>
<p>ã¨ã¯è¨€ã£ã¦ã‚‚å˜ç´”ã§ï¼Œãƒ—ãƒ­ã‚»ã‚¹ãŒ 2^4 = 16 å€‹ä½œã‚‰ã‚Œã‚‹ã ã‘</p>
<p>1000000000 + 0x499602d2 * 16 = -721750240</p>
<h3 id="armssembly3">ARMssembly3</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">func1</span>(uint param_1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  uint local_14;
</span></span><span style="display:flex;"><span>  undefined4 local_4;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  local_4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_14 <span style="color:#f92672">=</span> param_1; local_14 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>; local_14 <span style="color:#f92672">=</span> local_14 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((local_14 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      local_4 <span style="color:#f92672">=</span> <span style="color:#a6e22e">func2</span>(local_4);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> local_4;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>func2</code> ã¯å¼•æ•°ã« 3 ã‚’è¶³ã—ã¦è¿”ã™é–¢æ•°ï¼
param1 ã®ãƒ“ãƒƒãƒˆã‚’è¦‹ã¦å¾Œã‚ã‹ã‚‰ 1 ãªã‚‰ +3 ã™ã‚‹ï¼Œã¿ãŸã„ãªæ„Ÿã˜ã§ã‚„ã‚Œã°ã„ã„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding:utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>num <span style="color:#f92672">=</span> <span style="color:#ae81ff">2541039191</span>
</span></span><span style="display:flex;"><span>i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> num <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> num<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    num <span style="color:#f92672">=</span> num <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>print(i)
</span></span></code></pre></div><h3 id="reverse_cipher">reverse_cipher</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> sVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> flag [<span style="color:#ae81ff">23</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> local_41;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> local_2c;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>fp_output;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>fp_flag;
</span></span><span style="display:flex;"><span>  uint local_14;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> local_10;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> local_9;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  fp_flag <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag.txt&#34;</span>,<span style="color:#e6db74">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span>  fp_output <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;rev_this&#34;</span>,<span style="color:#e6db74">&#34;a&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (fp_flag <span style="color:#f92672">==</span> (FILE <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;No flag found, please make sure this is run on the server&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (fp_output <span style="color:#f92672">==</span> (FILE <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;please run this on the server&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>(flag,<span style="color:#ae81ff">0x18</span>,<span style="color:#ae81ff">1</span>,fp_flag);
</span></span><span style="display:flex;"><span>  local_2c <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)sVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ((<span style="color:#66d9ef">int</span>)sVar1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">exit</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_10 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_10 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; local_10 <span style="color:#f92672">=</span> local_10 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    local_9 <span style="color:#f92672">=</span> flag[local_10];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fputc</span>((<span style="color:#66d9ef">int</span>)local_9,fp_output);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_14 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>; (<span style="color:#66d9ef">int</span>)local_14 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x17</span>; local_14 <span style="color:#f92672">=</span> local_14 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((local_14 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      local_9 <span style="color:#f92672">=</span> flag[(<span style="color:#66d9ef">int</span>)local_14] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;\x05&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      local_9 <span style="color:#f92672">=</span> flag[(<span style="color:#66d9ef">int</span>)local_14] <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fputc</span>((<span style="color:#66d9ef">int</span>)local_9,fp_output);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  local_9 <span style="color:#f92672">=</span> local_41;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fputc</span>((<span style="color:#66d9ef">int</span>)local_41,fp_output);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(fp_output);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(fp_flag);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ãªã‚“ã¨ãªãå¤‰æ•°åã‚’ç›´ã—ãŸã®ãŒã“ã‚Œï¼
flag.txt ã‹ã‚‰ãƒ•ãƒ©ã‚°ã‚’èª­ã‚“ã§ï¼Œã¡ã‚‡ã£ã¨è¨ˆç®—ã—ã¦ rev.txt ã«æ›¸ãå‡ºã™ã ã‘ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼
ãªã®ã§ãã®è¨ˆç®—ã«å¿œã˜ãŸã‚½ãƒ«ãƒã‚’æ›¸ã„ã¦ã‚ã’ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding:utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ans <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;w1{1wq84fb&lt;1&gt;49}&#34;</span>
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> ans:
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> cnt<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    tmp <span style="color:#f92672">=</span> ord(i) <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x5</span>
</span></span><span style="display:flex;"><span>    print(chr(tmp), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    tmp <span style="color:#f92672">=</span> ord(i) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x2</span>
</span></span><span style="display:flex;"><span>    print(chr(tmp), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>  cnt <span style="color:#f92672">=</span> cnt<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span></code></pre></div><h3 id="asm3">asm3</h3>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">asm3:
    &lt;+0&gt;:    push   ebp
    &lt;+1&gt;:    mov    ebp,esp
    &lt;+3&gt;:    xor    eax,eax // eax -&gt; 0
    &lt;+5&gt;:    mov    ah,BYTE PTR [ebp+0xa] // ah &lt;- 33
    &lt;+8&gt;:    shl    ax,0x10  // ax &lt;- 3300 &lt;- 0000
    &lt;+12&gt;:    sub    al,BYTE PTR [ebp+0xc] //ae  0x00 - 0xae = FFFFFF52, al &lt;- 52
    &lt;+15&gt;:    add    ah,BYTE PTR [ebp+0xd] //ah 0x00 + 0x72 = 72, ah &lt;- 72
    &lt;+18&gt;:    xor    ax,WORD PTR [ebp+0x10] // ax &lt;- 0x7252 xor b139
    &lt;+22&gt;:    nop
    &lt;+23&gt;:    pop    ebp
    &lt;+24&gt;:    ret    
</code></pre><p>å¤‰æ•°ã®ç©ã¿æ–¹ã¨ãƒªãƒˆãƒ«ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ã®å¾©ç¿’ã«ãªã£ãŸ</p>
<p>åˆæœŸçŠ¶æ…‹ã¯ä»¥ä¸‹</p>
<table>
<thead>
<tr>
<th style="text-align:left">stack</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">main ebp</td>
</tr>
<tr>
<td style="text-align:left">ret</td>
</tr>
<tr>
<td style="text-align:left">d73346ed(å¼•æ•°1)</td>
</tr>
<tr>
<td style="text-align:left">d48672ae(å¼•æ•°2)</td>
</tr>
<tr>
<td style="text-align:left">d3c8b139(å¼•æ•°3)</td>
</tr>
<tr>
<td style="text-align:left">main</td>
</tr>
</tbody>
</table>
<p>ãƒªãƒˆãƒ«ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ãªã®ã§ï¼Œä¾‹ãˆã° [ebp+0xa] ã§ã¯å¼•æ•°1 ã® 33 ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹</p>
<h3 id="asm4">asm4</h3>
<p>ã‚¢ã‚»ãƒ³ãƒ–ãƒªãŒæ¸¡ã•ã‚Œã‚‹ãŒï¼Œå¤šã™ãã¦ä¸€ã¤ä¸€ã¤è¦‹ã‚‹ã®ã¯å¤§å¤‰ãªã®ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼
32 bit ãªã®ã§ <code>gcc -masm=intel -m32 solve.c -o solve</code> ã¨ã™ã‚‹ï¼
å®Ÿè¡Œã« <code>sudo apt install libc6-dev-i386</code> ãŒå¿…è¦ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">asm4</span>(<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> in)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> val;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">asm</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//&#34;push   ebp;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">//&#34;mov    ebp,esp;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#34;push   ebx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sub    esp,0x10;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    DWORD PTR [ebp-0x10],0x246;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    DWORD PTR [ebp-0xc],0x0;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;jmp    _asm_27;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;_asm_23:&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    DWORD PTR [ebp-0xc],0x1;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;_asm_27:&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    edx,DWORD PTR [ebp-0xc];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;test   al,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;jne    _asm_23;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    DWORD PTR [ebp-0x8],0x1;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;jmp    _asm_138;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;_asm_51:&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    edx,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movsx  edx,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;lea    ecx,[eax-0x1];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,ecx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movsx  eax,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sub    edx,eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    edx,eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0x10];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;lea    ebx,[edx+eax*1];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;lea    edx,[eax+0x1];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movsx  edx,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    ecx,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,ecx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movsx  eax,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sub    edx,eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,ebx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    DWORD PTR [ebp-0x10],eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    DWORD PTR [ebp-0x8],0x1;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;_asm_138:&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0xc];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sub    eax,0x1;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;cmp    DWORD PTR [ebp-0x8],eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;jl     _asm_51;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0x10];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    esp,0x10;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;pop    ebx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//&#34;pop    ebp;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">//&#34;ret    ;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">:</span><span style="color:#e6db74">&#34;=r&#34;</span>(val)
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">:</span> [pInput] <span style="color:#e6db74">&#34;m&#34;</span>(in)
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> val;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> argv)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;0x%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#a6e22e">asm4</span>(<span style="color:#e6db74">&#34;picoCTF_a3112&#34;</span>));
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="need-for-speed">Need For Speed</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">set_timer</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  __sighandler_t p_Var1;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  p_Var1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">__sysv_signal</span>(<span style="color:#ae81ff">0xe</span>,alarm_handler);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (p_Var1 <span style="color:#f92672">==</span> (__sighandler_t)<span style="color:#ae81ff">0xffffffffffffffff</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">Something bad happened here. &#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">exit</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">alarm</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>alarm(1) ã«ã‚ˆã£ã¦ï¼Œä¸€ç§’å¾Œã« signal ãŒé€ã‚‰ã‚Œã¦å®Ÿè¡ŒãŒä¸­æ–­ã™ã‚‹ï¼
ãã“ã§ï¼Œset_timer() ã‚’å®Ÿè¡Œã—ãªã„ã‚ˆã†ã«ã—ãŸã„ï¼</p>
<p>æ–¹æ³•1: SIGALRM ãŒã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã£ã¦ã„ã‚‹ã®ã§ï¼Œ<code>(gdb) handle SIGALRM ignore</code>
ãŒä½¿ãˆã‚‹ã‚‰ã—ã„ï¼</p>
<p>æ–¹æ³•2: set_timer() ã®å‘¼ã³å‡ºã—ã‚’ nop ã«æ›¸ãå¤‰ãˆã‚‹ã“ã¨ã§ã‚‚å›é¿ã§ãã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>â”Œâ”€â”€<span style="color:#f92672">(</span>kaliã‰¿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/CTF<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>â””â”€$ r2 -d need-for-speed 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x7f4ef7a0b4d0<span style="color:#f92672">]</span>&gt; aaa
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze all flags starting with sym. and entry0 <span style="color:#f92672">(</span>aa<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze <span style="color:#66d9ef">function</span> calls <span style="color:#f92672">(</span>aac<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze len bytes of instructions <span style="color:#66d9ef">for</span> references <span style="color:#f92672">(</span>aar<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Finding and parsing C++ vtables <span style="color:#f92672">(</span>avrr<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Skipping type matching analysis in debugger mode <span style="color:#f92672">(</span>aaft<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Propagate noreturn information <span style="color:#f92672">(</span>aanr<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Use -AA or aaaa to perform additional experimental analysis.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x7f4ef7a0b4d0<span style="color:#f92672">]</span>&gt; s main
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x55894100091a<span style="color:#f92672">]</span>&gt; pdf
</span></span><span style="display:flex;"><span>            ; DATA XREF from entry0 @ 0x55894100067d
</span></span><span style="display:flex;"><span>â”Œ 62: int main <span style="color:#f92672">(</span>int argc, char **argv<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>â”‚           ; var int64_t var_10h @ rbp-0x10
</span></span><span style="display:flex;"><span>â”‚           ; var int64_t var_4h @ rbp-0x4
</span></span><span style="display:flex;"><span>â”‚           ; arg int argc @ rdi
</span></span><span style="display:flex;"><span>â”‚           ; arg char **argv @ rsi
</span></span><span style="display:flex;"><span>â”‚           0x55894100091a      <span style="color:#ae81ff">55</span>             push rbp
</span></span><span style="display:flex;"><span>â”‚           0x55894100091b      4889e5         mov rbp, rsp
</span></span><span style="display:flex;"><span>â”‚           0x55894100091e      4883ec10       sub rsp, 0x10
</span></span><span style="display:flex;"><span>â”‚           0x558941000922      897dfc         mov dword <span style="color:#f92672">[</span>var_4h<span style="color:#f92672">]</span>, edi ; argc
</span></span><span style="display:flex;"><span>â”‚           0x558941000925      488975f0       mov qword <span style="color:#f92672">[</span>var_10h<span style="color:#f92672">]</span>, rsi ; argv
</span></span><span style="display:flex;"><span>â”‚           0x558941000929      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x55894100092e      e8a5ffffff     call sym.header
</span></span><span style="display:flex;"><span>â”‚           0x558941000933      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x558941000938      e8f2feffff     call sym.set_timer
</span></span><span style="display:flex;"><span>â”‚           0x55894100093d      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x558941000942      e836ffffff     call sym.get_key
</span></span><span style="display:flex;"><span>â”‚           0x558941000947      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x55894100094c      e85bffffff     call sym.print_flag
</span></span><span style="display:flex;"><span>â”‚           0x558941000951      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x558941000956      c9             leave
</span></span><span style="display:flex;"><span>â””           0x558941000957      c3             ret
</span></span></code></pre></div><p>ã“ã‚Œã§ <code>call sym.set_timer</code> ã®å ´æ‰€ãŒåˆ†ã‹ã£ãŸã®ã§ï¼Œnop ã«æ›¸ãã‹ãˆã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>0x55894100091a<span style="color:#f92672">]</span>&gt; s 0x558941000938
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x558941000938<span style="color:#f92672">]</span>&gt; wao nop
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x558941000938<span style="color:#f92672">]</span>&gt; pdf
</span></span><span style="display:flex;"><span>            ; DATA XREF from entry0 @ 0x55894100067d
</span></span><span style="display:flex;"><span>â”Œ 62: int main <span style="color:#f92672">(</span>int argc, char **argv<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>â”‚           ; var int64_t var_10h @ rbp-0x10
</span></span><span style="display:flex;"><span>â”‚           ; var int64_t var_4h @ rbp-0x4
</span></span><span style="display:flex;"><span>â”‚           ; arg int argc @ rdi
</span></span><span style="display:flex;"><span>â”‚           ; arg char **argv @ rsi
</span></span><span style="display:flex;"><span>â”‚           0x55894100091a      <span style="color:#ae81ff">55</span>             push rbp
</span></span><span style="display:flex;"><span>â”‚           0x55894100091b      4889e5         mov rbp, rsp
</span></span><span style="display:flex;"><span>â”‚           0x55894100091e      4883ec10       sub rsp, 0x10
</span></span><span style="display:flex;"><span>â”‚           0x558941000922      897dfc         mov dword <span style="color:#f92672">[</span>var_4h<span style="color:#f92672">]</span>, edi ; argc
</span></span><span style="display:flex;"><span>â”‚           0x558941000925      488975f0       mov qword <span style="color:#f92672">[</span>var_10h<span style="color:#f92672">]</span>, rsi ; argv
</span></span><span style="display:flex;"><span>â”‚           0x558941000929      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x55894100092e      e8a5ffffff     call sym.header
</span></span><span style="display:flex;"><span>â”‚           0x558941000933      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x558941000938      <span style="color:#ae81ff">90</span>             nop
</span></span><span style="display:flex;"><span>..
</span></span><span style="display:flex;"><span>â”‚           0x55894100093d      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x558941000942      e836ffffff     call sym.get_key
</span></span><span style="display:flex;"><span>â”‚           0x558941000947      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x55894100094c      e85bffffff     call sym.print_flag
</span></span><span style="display:flex;"><span>â”‚           0x558941000951      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>â”‚           0x558941000956      c9             leave
</span></span><span style="display:flex;"><span>â””           0x558941000957      c3             ret
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x558941000938<span style="color:#f92672">]</span>&gt; dc
</span></span><span style="display:flex;"><span>Keep this thing over <span style="color:#ae81ff">50</span> mph!
</span></span><span style="display:flex;"><span><span style="color:#f92672">============================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Creating key...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Finished
</span></span><span style="display:flex;"><span>Printing flag:
</span></span><span style="display:flex;"><span>PICOCTF<span style="color:#f92672">{</span>Good job keeping bus <span style="color:#75715e">#1f2ac4ec speeding along!}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>128407<span style="color:#f92672">)</span> Process exited with status<span style="color:#f92672">=</span>0x0
</span></span></code></pre></div><h3 id="otp-implementation">OTP Implementation</h3>
<p>ãªã‚“ã‹ OTP ã£ã½ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒæ¸¡ã•ã‚Œã‚‹</p>
<ul>
<li>jumble: ã‚ã‚‹è¦å‰‡ã«å¾“ã£ã¦æ•°å­—ã‚’ã“ã­ãã‚Šå›ã™</li>
<li>main: ã•ã‚‰ã«ã“ã­ãã‚Šå›ã™</li>
</ul>
<p>ã“ã‚Œã‚’é€†ã‹ã‚‰è¦‹ã¦ã„ã‘ã°æ‰€æœ›ã®éµãŒæ‰‹ã«å…¥ã‚‹ã®ã§ï¼Œflag ã¨ xor ã™ã‚Œã°ã„ã„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding:utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> getPrime, bytes_to_long, long_to_bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1fcb81cd1f6f1e12b429092e3647153b6c212772554ca004145b82367e1e6b7870827dc249a319601776f727434e6b6227d1&#34;</span>
</span></span><span style="display:flex;"><span>cmp_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mlaebfkoibhoijfidblechbggcgldicegjbkcmolhdjihgmmieabohpdhjnciacbjjcnpcfaopigkpdfnoaknjlnlaohboimombk&#34;</span>
</span></span><span style="display:flex;"><span>candidate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1234567890abcdef&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">jumble</span>(param1):
</span></span><span style="display:flex;"><span>     ans <span style="color:#f92672">=</span> param1
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0x60</span> <span style="color:#f92672">&lt;</span> param1):
</span></span><span style="display:flex;"><span>          ans <span style="color:#f92672">=</span> param1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x9</span>
</span></span><span style="display:flex;"><span>     ans <span style="color:#f92672">=</span> (ans <span style="color:#f92672">%</span> <span style="color:#ae81ff">0x10</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x02</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0x0f</span> <span style="color:#f92672">&lt;</span> ans):
</span></span><span style="display:flex;"><span>          ans <span style="color:#f92672">=</span> ans <span style="color:#f92672">+</span>  <span style="color:#ae81ff">0x01</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> ans
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">body</span>(counter, chara, pre):
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">if</span>(counter <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>):
</span></span><span style="display:flex;"><span>          after_jumble <span style="color:#f92672">=</span> jumble(ord(chara))
</span></span><span style="display:flex;"><span>          result <span style="color:#f92672">=</span> after_jumble <span style="color:#f92672">%</span> <span style="color:#ae81ff">0x10</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">#print(&#34;OK1&#34;)</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>          after_jumble <span style="color:#f92672">=</span> jumble(ord(chara))
</span></span><span style="display:flex;"><span>          Val <span style="color:#f92672">=</span> after_jumble <span style="color:#f92672">+</span> pre <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">0x1f</span>
</span></span><span style="display:flex;"><span>          result <span style="color:#f92672">=</span> (after_jumble <span style="color:#f92672">+</span> pre <span style="color:#f92672">+</span> (Val <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xf</span>) <span style="color:#f92672">-</span> (Val <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">#print(&#34;OK&#34;)</span>
</span></span><span style="display:flex;"><span>     counter <span style="color:#f92672">=</span> counter <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pre <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>results <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> candidate:
</span></span><span style="display:flex;"><span>          result <span style="color:#f92672">=</span> body(c, i, pre)
</span></span><span style="display:flex;"><span>          result <span style="color:#f92672">=</span> chr(result <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x61</span>)
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span>(cmp_str[c] <span style="color:#f92672">==</span> result):
</span></span><span style="display:flex;"><span>               results[c] <span style="color:#f92672">=</span> i
</span></span><span style="display:flex;"><span>               pre <span style="color:#f92672">=</span> ord(result)
</span></span><span style="display:flex;"><span>               <span style="color:#75715e">#print(chr(int(i, 16) ^ ord(cmp_str[c])))</span>
</span></span><span style="display:flex;"><span>               <span style="color:#75715e">#print(&#34;OK&#34;)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enc <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
</span></span><span style="display:flex;"><span>     print(long_to_bytes(int(results[i], <span style="color:#ae81ff">16</span>) <span style="color:#f92672">^</span> ord(flag[i])))
</span></span><span style="display:flex;"><span>     <span style="color:#75715e">#print(chr(int(results[i], 16) ^ ord(flag[i])), end=&#39;&#39;)</span>
</span></span></code></pre></div><h3 id="gogo">gogo</h3>
<p>golang ã®ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã“ã‚“ãªè¦‹ã«ãã„ã®ã‹</p>
<p>ã¾ãš ghidra ã§è¦‹ã‚‹ã¨ checkPassword ãŒã‚ã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  key[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x38</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x36</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x31</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x38</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:39
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x36</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x66</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x31</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:43
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x65</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:47
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x36</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x32</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x37</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:51
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x66</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x61</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x37</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:55
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x35</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x62</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x62</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:59
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x38</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x38</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x39</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:63
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x32</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x31</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x34</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x65</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:67
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:68
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  runtime.<span style="color:#a6e22e">duffcopy_0x20_FUN_08090fe0</span>(local_20,(uint4 <span style="color:#f92672">*</span>)main.statictmp_4);
</span></span><span style="display:flex;"><span>  uVar1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  iVar2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:70
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>( true ) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">int</span>)uVar1) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:75
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (iVar2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x20</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:76
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:78
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:71
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:70
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:71
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((param_2 <span style="color:#f92672">&lt;=</span> uVar1) <span style="color:#f92672">||</span> (<span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">&lt;</span> uVar1)) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((<span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)(param_1 <span style="color:#f92672">+</span> uVar1) <span style="color:#f92672">^</span> key[uVar1]) <span style="color:#f92672">==</span> <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">int</span>)local_20 <span style="color:#f92672">+</span> uVar1)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:72
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>      iVar2 <span style="color:#f92672">=</span> iVar2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    uVar1 <span style="color:#f92672">=</span> uVar1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>key ã¨ main.statictmp_4 ã®ä¸­èº«ã‚’ XOR ã—ã¦ã„ã‚‹ã£ã½ã„ã®ã§ï¼Œã¾ãšã“ã‚Œã‚’è¨ˆç®—ã™ã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x20</span>):
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>  print(chr(tmp[i]<span style="color:#f92672">^</span>input[i]),end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>reverseengineericanbarelyforward
</span></span></code></pre></div><p>æ¬¡ã«ï¼Œéµã‚’ unhash ã—ã‚ï¼Œã¨å‡ºã¦ãã‚‹ï¼
ã‚³ãƒ¼ãƒ‰ä¸­ã« md5 ã¨ã‚ã‚‹ã®ã§ãƒãƒƒã‚·ãƒ¥ã‚’æ¢ã™ã¨ goldfish ãŒè¦‹ã¤ã‹ã‚‹ï¼</p>
<h3 id="lets-get-dynamic">Let&rsquo;s get dynamic</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">~~</span> snip <span style="color:#f92672">~~</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_20 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  local_98 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x396c109a7067b614</span>;
</span></span><span style="display:flex;"><span>  local_90 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x32ea1ab1495990f0</span>;
</span></span><span style="display:flex;"><span>  local_88 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xd09aa897d230c8fe</span>;
</span></span><span style="display:flex;"><span>  local_80 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x2c227b84b00f7d0b</span>;
</span></span><span style="display:flex;"><span>  local_78 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xb0a880f7d99ea817</span>;
</span></span><span style="display:flex;"><span>  local_70 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xc8f18206086afe7c</span>;
</span></span><span style="display:flex;"><span>  local_68 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x61</span>;
</span></span><span style="display:flex;"><span>  local_58 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x563f52ce0f15cd77</span>;
</span></span><span style="display:flex;"><span>  local_50 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x719435c3652ef38f</span>;
</span></span><span style="display:flex;"><span>  local_48 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x8bec9fe9be05a4c9</span>;
</span></span><span style="display:flex;"><span>  local_40 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x521c05fe8d590431</span>;
</span></span><span style="display:flex;"><span>  local_38 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xdbf1c3a6dadcef7b</span>;
</span></span><span style="display:flex;"><span>  local_30 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xc4fc8b585631f076</span>;
</span></span><span style="display:flex;"><span>  local_28 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x3f</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fgets</span>(user_input,<span style="color:#ae81ff">0x31</span>,stdin);
</span></span><span style="display:flex;"><span>  counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>( true ) {
</span></span><span style="display:flex;"><span>    str_length <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (str_length <span style="color:#f92672">&lt;=</span> (ulong)(<span style="color:#66d9ef">long</span>)counter) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    local_118[counter] <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         (byte)counter <span style="color:#f92672">^</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)<span style="color:#f92672">&amp;</span>local_98 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">long</span>)counter) <span style="color:#f92672">^</span> <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)<span style="color:#f92672">&amp;</span>local_58 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">long</span>)counter) <span style="color:#f92672">^</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0x13</span>;
</span></span><span style="display:flex;"><span>    counter <span style="color:#f92672">=</span> counter <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  iVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">memcmp</span>(user_input,local_118,<span style="color:#ae81ff">0x31</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (iVar1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;No, that</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">s not right.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Correct! You entered the flag.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (local_20 <span style="color:#f92672">!=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">__stack_chk_fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> iVar1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å…¥åŠ›æ–‡å­—åˆ—ã¨æ—¢å­˜ã®ãƒ•ãƒ©ã‚°ã‚’æ¯”è¼ƒã—ã¦ã„ã‚‹ï¼
æ–‡å­—æ•°ã¯ 0x31.
é€”ä¸­ã«ã‚ã‚‹ while æ–‡ã‚’æ³¨ç›®ã™ã‚Œã°ã‚ˆãã¦ï¼Œlocal_xx ã«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ã“ã­ãã‚Šã¾ã‚ã—ã¦ã„ã‚‹ï¼
ã“ã“ã¾ã§ã¯ç°¡å˜ãªã‚“ã ãŒãƒ‡ãƒ¼ã‚¿ãŒãƒªãƒˆãƒ«ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ãªã®ã§ã‚¹ã‚¿ãƒƒã‚¯ã®æœ€å¾Œã‹ã‚‰å–ã‚Šå‡ºã•ãªã‘ã‚Œã°ã„ã‘ãªã„ï¼
ã“ã“ã«ã¤ã¾ã¥ã„ã¦ 5 å¹´ã‹ã‘ã¾ã—ãŸ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding:utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local_98 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x39</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0x70</span>,<span style="color:#ae81ff">0x67</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0x14</span>]
</span></span><span style="display:flex;"><span>local_90 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x32</span>,<span style="color:#ae81ff">0xea</span>,<span style="color:#ae81ff">0x1a</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0x49</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x90</span>,<span style="color:#ae81ff">0xf0</span>]
</span></span><span style="display:flex;"><span>local_88 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xd0</span>,<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0x97</span>,<span style="color:#ae81ff">0xd2</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#ae81ff">0xc8</span>,<span style="color:#ae81ff">0xfe</span>]
</span></span><span style="display:flex;"><span>local_80 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x2c</span>,<span style="color:#ae81ff">0x22</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0x84</span>,<span style="color:#ae81ff">0xb0</span>,<span style="color:#ae81ff">0x0f</span>,<span style="color:#ae81ff">0x7d</span>,<span style="color:#ae81ff">0x0b</span>]
</span></span><span style="display:flex;"><span>local_78 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xb0</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0x80</span>,<span style="color:#ae81ff">0xf7</span>,<span style="color:#ae81ff">0xd9</span>,<span style="color:#ae81ff">0x9e</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0x17</span>]
</span></span><span style="display:flex;"><span>local_70 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xc8</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0x82</span>,<span style="color:#ae81ff">0x06</span>,<span style="color:#ae81ff">0x08</span>,<span style="color:#ae81ff">0x6a</span>,<span style="color:#ae81ff">0xfe</span>,<span style="color:#ae81ff">0x7c</span>]
</span></span><span style="display:flex;"><span>local_68 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x61</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local_58 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x56</span>,<span style="color:#ae81ff">0x3f</span>,<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0xce</span>,<span style="color:#ae81ff">0x0f</span>,<span style="color:#ae81ff">0x15</span>,<span style="color:#ae81ff">0xcd</span>,<span style="color:#ae81ff">0x77</span>]
</span></span><span style="display:flex;"><span>local_50 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x71</span>,<span style="color:#ae81ff">0x94</span>,<span style="color:#ae81ff">0x35</span>,<span style="color:#ae81ff">0xc3</span>,<span style="color:#ae81ff">0x65</span>,<span style="color:#ae81ff">0x2e</span>,<span style="color:#ae81ff">0xf3</span>,<span style="color:#ae81ff">0x8f</span>]
</span></span><span style="display:flex;"><span>local_48 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0xec</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0xe9</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0x05</span>,<span style="color:#ae81ff">0xa4</span>,<span style="color:#ae81ff">0xc9</span>]
</span></span><span style="display:flex;"><span>local_40 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0x1c</span>,<span style="color:#ae81ff">0x05</span>,<span style="color:#ae81ff">0xfe</span>,<span style="color:#ae81ff">0x8d</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x04</span>,<span style="color:#ae81ff">0x31</span>]
</span></span><span style="display:flex;"><span>local_38 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xdb</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0xc3</span>,<span style="color:#ae81ff">0xa6</span>,<span style="color:#ae81ff">0xda</span>,<span style="color:#ae81ff">0xdc</span>,<span style="color:#ae81ff">0xef</span>,<span style="color:#ae81ff">0x7b</span>]
</span></span><span style="display:flex;"><span>local_30 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xc4</span>,<span style="color:#ae81ff">0xfc</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0x58</span>,<span style="color:#ae81ff">0x56</span>,<span style="color:#ae81ff">0x31</span>,<span style="color:#ae81ff">0xf0</span>,<span style="color:#ae81ff">0x76</span>]
</span></span><span style="display:flex;"><span>local_28 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x3f</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">0x31</span>
</span></span><span style="display:flex;"><span>counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>plus <span style="color:#f92672">=</span> <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(<span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>   output[counter] <span style="color:#f92672">=</span> chr(plus <span style="color:#f92672">^</span> (local_30[<span style="color:#ae81ff">7</span><span style="color:#f92672">-</span>counter]) <span style="color:#f92672">^</span> (local_70[<span style="color:#ae81ff">7</span><span style="color:#f92672">-</span>counter]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x13</span>)
</span></span><span style="display:flex;"><span>   counter <span style="color:#f92672">=</span> counter <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>   plus <span style="color:#f92672">=</span> plus<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>   print(output)
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>print(output)
</span></span></code></pre></div><h4 id="åˆ¥è§£">åˆ¥è§£</h4>
<p>stack è¡¨ç¤ºã‚’è¦‹ã‚Œã°ã„ã„ã‚‰ã—ã„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pwndbg&gt; b memcmp
</span></span><span style="display:flex;"><span>Breakpoint <span style="color:#ae81ff">1</span> at 0x1060
</span></span><span style="display:flex;"><span>pwndbg&gt; r
</span></span><span style="display:flex;"><span>~~snip~~
</span></span><span style="display:flex;"><span>pwndbg&gt; stack <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>00:0000â”‚ rsp 0x7fffffffda18 â€”â–¸ 0x7ffff7fdb432 <span style="color:#f92672">(</span>_dl_fixup+642<span style="color:#f92672">)</span> â—‚â€” mov qword ptr <span style="color:#f92672">[</span>rsp + 8<span style="color:#f92672">]</span>, rax
</span></span><span style="display:flex;"><span>01:0008â”‚     0x7fffffffda20 â€”â–¸ 0x7ffff7ddeba0 â—‚â€” 0x10001a0000487e /* <span style="color:#e6db74">&#39;~H&#39;</span> */
</span></span><span style="display:flex;"><span>02:0010â”‚     0x7fffffffda28 â€”â–¸ 0x7ffff7e630f0 <span style="color:#f92672">(</span>memcmp<span style="color:#f92672">)</span> â—‚â€” mov rax, qword ptr <span style="color:#f92672">[</span>rip + 0x137db9<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>03:0018â”‚     0x7fffffffda30 â€”â–¸ 0x7fffffffdca0 â—‚â€” 0x31 /* <span style="color:#e6db74">&#39;1&#39;</span> */
</span></span><span style="display:flex;"><span>04:0020â”‚     0x7fffffffda38 â€”â–¸ 0x7fffffffddf0 â—‚â€” 0x1
</span></span><span style="display:flex;"><span>05:0028â”‚     0x7fffffffda40 â—‚â€” 0x0
</span></span><span style="display:flex;"><span>06:0030â”‚     0x7fffffffda48 â€”â–¸ 0x7fffffffdf18 â€”â–¸ 0x7fffffffe290 â—‚â€” <span style="color:#e6db74">&#39;COLORFGBG=15;0&#39;</span>
</span></span><span style="display:flex;"><span>07:0038â”‚     0x7fffffffda50 â€”â–¸ 0x555555557dd8 <span style="color:#f92672">(</span>__do_global_dtors_aux_fini_array_entry<span style="color:#f92672">)</span> â€”â–¸ 0x555555555130 <span style="color:#f92672">(</span>__do_global_dtors_aux<span style="color:#f92672">)</span> â—‚â€” endbr64                                                                     
</span></span><span style="display:flex;"><span>08:0040â”‚     0x7fffffffda58 â€”â–¸ 0x7ffff7fdd443 <span style="color:#f92672">(</span>_dl_runtime_resolve_fxsave+67<span style="color:#f92672">)</span> â—‚â€” mov r11, rax
</span></span><span style="display:flex;"><span>09:0048â”‚     0x7fffffffda60 â€”â–¸ 0x7fffffffdd20 â—‚â€” 0x2f2f2f2f2f2f000a /* <span style="color:#e6db74">&#39;\n&#39;</span> */
</span></span><span style="display:flex;"><span>0a:0050â”‚     0x7fffffffda68 â€”â–¸ 0x7fffffffdce0 â—‚â€” <span style="color:#e6db74">&#39;picoCTF{dyn4m1c_4n4ly1s_1s_5up3r_us3ful_14bfa700}&#39;</span>
</span></span><span style="display:flex;"><span>0b:0058â”‚     0x7fffffffda70 â—‚â€” 0x31 /* <span style="color:#e6db74">&#39;1&#39;</span> */
</span></span><span style="display:flex;"><span>0c:0060â”‚     0x7fffffffda78 â€”â–¸ 0x7fffffffdce0 â—‚â€” <span style="color:#e6db74">&#39;picoCTF{dyn4m1c_4n4ly1s_1s_5up3r_us3ful_14bfa700}&#39;</span>
</span></span><span style="display:flex;"><span>0d:0068â”‚     0x7fffffffda80 â€”â–¸ 0x7fffffffdd20 â—‚â€” 0x2f2f2f2f2f2f000a /* <span style="color:#e6db74">&#39;\n&#39;</span> */
</span></span><span style="display:flex;"><span>0e:0070â”‚     0x7fffffffda88 â—‚â€” 0x0
</span></span><span style="display:flex;"><span>0f:0078â”‚     0x7fffffffda90 â—‚â€” 0x410
</span></span><span style="display:flex;"><span>10:0080â”‚     0x7fffffffda98 â—‚â€” 0x0
</span></span><span style="display:flex;"><span>11:0088â”‚     0x7fffffffdaa0 â—‚â€” 0x37f
</span></span><span style="display:flex;"><span>12:0090â”‚     0x7fffffffdaa8 â—‚â€” 0x0
</span></span><span style="display:flex;"><span>13:0098â”‚     0x7fffffffdab0 â—‚â€” 0x0
</span></span></code></pre></div><p>ãªã‚“ã¦ä¾¿åˆ©ãªã‚“ã &hellip;</p>
<h3 id="easy-as-gdb">Easy as GDB</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">FUN_000108c4</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>param_1,uint param_2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>__dest;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>__dest_00;
</span></span><span style="display:flex;"><span>  uint local_18;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  __dest <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">calloc</span>(param_2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">strncpy</span>(__dest,param_1,param_2);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">FUN_000107c2</span>(__dest,param_2,<span style="color:#ae81ff">0xffffffff</span>);
</span></span><span style="display:flex;"><span>  __dest_00 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">calloc</span>(param_2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">strncpy</span>(__dest_00,<span style="color:#f92672">&amp;</span>DAT_00012008,param_2);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">FUN_000107c2</span>(__dest_00,param_2,<span style="color:#ae81ff">0xffffffff</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;checking solution...&#34;</span>);
</span></span><span style="display:flex;"><span>  local_18 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>( true ) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (param_2 <span style="color:#f92672">&lt;=</span> local_18) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (__dest[local_18] <span style="color:#f92672">!=</span> __dest_00[local_18]) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    local_18 <span style="color:#f92672">=</span> local_18 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0xffffffff</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å…¥åŠ›æ–‡å­—åˆ—ã¨å†…è”µæ–‡å­—åˆ—ãŒä¸€è‡´ã—ã¦ã„ãªã„ or ãƒ«ãƒ¼ãƒ—å›æ•°ãŒå…¥åŠ›æ–‡å­—åˆ—æ•°ã‚’è¶…ãˆã‚‹ ã§ï¼Œ
ãƒ«ãƒ¼ãƒ—ã‚’æŠœã‘ã‚‹ï¼
ã¤ã¾ã‚Šï¼Œå…¥åŠ›ã—ãŸæ–‡å­—åˆ—ãŒã™ã¹ã¦æ­£ã—ã‘ã‚Œã°ãƒ«ãƒ¼ãƒ—å›æ•°ãŒå…¥åŠ›æ–‡å­—åˆ—ã‚’è¶…ãˆã‚‹ã®ã§
(local_18 (ãƒ«ãƒ¼ãƒ—å›æ•°)ãŒ param_2 (å…¥åŠ›æ–‡å­—åˆ—æ•°) ã‚’è¶…ãˆã‚‹)ï¼Œ
ãƒ«ãƒ¼ãƒ—å›æ•°ã‚’è¦‹ã‚‹ã“ã¨ã§ãƒ•ãƒ©ã‚°ãŒåˆ†ã‹ã‚‹ï¼
ä»¥ä¸‹ã« gdb ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> gdb
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;file ./brute&#39;</span>)
</span></span><span style="display:flex;"><span>gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;set pagination off&#39;</span>)
</span></span><span style="display:flex;"><span>gdb<span style="color:#f92672">.</span>Breakpoint(<span style="color:#e6db74">&#39;*0x565559a5&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pattern <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>printable
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">30</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> chara <span style="color:#f92672">in</span> pattern:
</span></span><span style="display:flex;"><span>   payload <span style="color:#f92672">=</span> flag <span style="color:#f92672">+</span> chara
</span></span><span style="display:flex;"><span>   gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;run &#39;</span> <span style="color:#f92672">+</span> chara)
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;continue&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span> gdb<span style="color:#f92672">.</span>error:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        msg <span style="color:#f92672">=</span> gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;i b&#39;</span>, to_string<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;hit </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> times&#39;</span><span style="color:#f92672">.</span>format(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">in</span> msg:
</span></span><span style="display:flex;"><span>            flag <span style="color:#f92672">+=</span> chara
</span></span><span style="display:flex;"><span>            gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;continue&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;flag:&#39;</span>, flag <span style="color:#f92672">+</span> chara)
</span></span><span style="display:flex;"><span>        print(msg)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(flag)
</span></span><span style="display:flex;"><span>gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span></code></pre></div><p>ç›¸å¯¾ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å¿˜ã‚Œã¦ã„ãŸã®ã§æ³¨æ„</p>
<p>Ghidra ã§è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ gdb ã¨ã‚ºãƒ¬ã¦ã—ã¾ã†ã“ã¨ã«æ³¨æ„ã™ã‚‹ï¼
Ghidra ã¯ <code>0x00010000</code> ã‹ã‚‰ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå§‹ã¾ã‚‹ï¼
gdb ã®æ–¹ã¯ <code>info proc mapping</code> ã§ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å†…å®¹ã‚’è¦‹ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pwndbg&gt; info proc mapping
</span></span><span style="display:flex;"><span>process <span style="color:#ae81ff">614292</span>
</span></span><span style="display:flex;"><span>Mapped address spaces:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Start Addr   End Addr       Size     Offset  Perms   objfile
</span></span><span style="display:flex;"><span>        0x56555000 0x56556000     0x1000        0x0  r-xp   /home/kali/CTF/brute
</span></span><span style="display:flex;"><span>        0x56556000 0x56557000     0x1000        0x0  r--p   /home/kali/CTF/brute
</span></span><span style="display:flex;"><span>        0x56557000 0x56558000     0x1000     0x1000  rw-p   /home/kali/CTF/brute
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>ã§ï¼ŒGhidra ã§ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¨­ç½®ã—ãŸã„å‘½ä»¤ã¯ <code>000109a5 72 d1 JC LAB_00010978</code> ãªã®ã§ï¼Œ
ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹ +0x9a5 ã® ã¨ã“ã‚ã«æ‰€æœ›ã®å‘½ä»¤ãŒã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ï¼</p>
<p>ã‚ã¨ã¯ã›ã„ãœã„ 3 ã¤ãªã®ã§ 3 ã¤ã¨ã‚‚è©¦ã—ã¦ã¿ã¦ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆãŒè²¼ã‚Œã‚‹ &amp; ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
ã‚‚ã®ã‚’é¸ã¹ã°ã„ã„ãŒï¼Œãƒ€ãƒ¡æŠ¼ã—ã§ <code>x/16xb 0x565559a5</code> ã¿ãŸã„ãªæ„Ÿã˜ã§ã‚„ã‚‹ã¨
é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã—ã¦ãã‚Œã‚‹ã®ã§ï¼ŒGhidra ã®è¡¨ç¤ºã¨ä¸€è‡´ã™ã‚‹ã‚‚ã®ã‚’é¸ã¹ã°ã„ã„ï¼</p>
<h3 id="armssembly-4">ARMssembly 4</h3>
<p>è¨ˆç®—ã™ã‚‹ã ã‘ï¼
ãªã‚“ã ã“ã‚Œã¯</p>
<h3 id="not-crypto">not crypto</h3>
<p><code>&quot;I heard you wanted to bargain for a flag... whatcha got?</code> ã¨ã„ã†æ–‡å­—åˆ—ã‚’æ¢ã—ã¦ï¼ŒãŠãã‚‰ã main é–¢æ•°ã¯ FUN_00101070 ã ã¨æ¨æ¸¬ã™ã‚‹ï¼
å…¥åŠ›ã¯ <code>fread(local_198,1,0x40,_stdin);</code> ã®ã‚ˆã†ã«æ¨™æº–å…¥åŠ›ã‹ã‚‰å—ã‘å–ã‚Šï¼Œæœ€å¾Œã®æ–¹ã§ <code>iVar19 = memcmp(local_88,local_198,0x40);</code> ã¿ãŸã„ãªæ¯”è¼ƒã‚’ã—ã¦ã„ã‚‹ï¼
local_198 ãŒãã®ã¾ã¾ã§ã‚ã‚Œã° local_88 ãŒ flag ã«ãªã£ã¦ã„ã‚‹ã¯ãšãªã®ã§ï¼Œ memcmp ã®ã‚ãŸã‚Šã§ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’è¦‹ã‚Œã°ã‚ˆã•ãã†ï¼</p>
<p>ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’ memcmp ã«ãŠã„ã¦(ã‚¢ãƒ‰ãƒ¬ã‚¹ã«æ³¨æ„ã™ã‚‹)ï¼Œrdi ã‚’è¦‹ã‚‹ã¨ãƒ•ãƒ©ã‚°ã‚’ã‚²ãƒˆ</p>
<h3 id="ready-gladiator-2">Ready Gladiator 2</h3>
<p>Core wars ã‚‰ã—ã„ï¼
imp(å°é¬¼) ã¨å‘¼ã°ã‚Œã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å…¨å‹ã™ã‚Œã°ã„ã„ã‚‰ã—ã„ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>;redcode
</span></span><span style="display:flex;"><span>;name Imp Ex
</span></span><span style="display:flex;"><span>;assert 1
</span></span><span style="display:flex;"><span>JMP 0, &lt;-5
</span></span><span style="display:flex;"><span>end
</span></span></code></pre></div><p>ãªã‚“ã‹ä¸Šæ‰‹ãã„ã£ãŸï¼ï¼ï¼</p>
<h3 id="no-way-out">No way out</h3>
<p>Unity è£½ã®ã‚²ãƒ¼ãƒ ãŒå‹•ã„ã¦ã„ã‚‹ï¼
ãƒã‚·ã‚´ã‚’ä¸Šã‚‹ã¨æ——ãŒè¦‹ãˆã‚‹ãŒï¼Œé€æ˜ãªå£ãŒã‚ã£ã¦é€šã‚ŠæŠœã‘ã‚‰ã‚Œãªã„ï¼</p>
<p>dll ã®ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§æ•™ã‚ã£ãŸãªï¼ï¼ï¼ã¨æ€ã„ãªãŒã‚‰ dnSpy ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼
ãŒï¼ŒUnity è£½ã® dll ãŒã©ã‚Œã‚’ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã¹ãã‹è¦‹å½“ã‚‚ã¤ã‹ãªã‹ã£ãŸã®ã§ writeup ã‚’è¦‹ã‚‹ï¼
<code>/Managed/Assembly-CSharp.dll</code> ã‚’è¦‹ã‚Œã°ã„ã„ã‚‰ã—ã„ï¼
å…¨éƒ¨ã® exe ã§ãã†ãªã‚“ã ã‚ã†ã‹</p>
<p>dll ã‚’ãªã‚“ã¨ãªãè¦‹ã‚‹ã¨ï¼Œä»¥ä¸‹ã®è¨˜è¿°ãŒç›®ã«ä»˜ãï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (Input.GetButton(<span style="color:#e6db74">&#34;Jump&#34;</span>) &amp;&amp; <span style="color:#66d9ef">this</span>.canMove &amp;&amp; <span style="color:#66d9ef">this</span>.characterController.isGrounded &amp;&amp; !<span style="color:#66d9ef">this</span>.isClimbing)
</span></span></code></pre></div><p>æ˜”ã‚²ãƒ¼ãƒ ã‚’ä½œã£ãŸæ™‚ã«ã‚¸ãƒ£ãƒ³ãƒ—åˆ¤å®šã§è‹¦åŠ´ã—ãŸè¨˜æ†¶ã‚’æ˜ã‚Šå‡ºã—ã¦ï¼Œã‚¸ãƒ£ãƒ³ãƒ—ã§ãã‚‹ã®ã¯ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ç€åœ°åˆ¤å®šãŒãƒˆãƒªã‚¬ãƒ¼ã—ã¦ã„ã‚‹ã¨ãã ã‘ã ã£ãŸã“ã¨ã‚’æ€ã„å‡ºã™ï¼
ãªã®ã§ &amp;&amp; ä»¥ä¸‹ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ï¼
File -&gt; Save Module ã‚’å¿˜ã‚Œãšã«(æˆ’ã‚)</p>
<p>ã‚²ãƒ¼ãƒ ã‚’èµ·å‹•ã—ã¦æ——ã«è¿‘ã¥ãã¨ãƒ•ãƒ©ã‚°ãŒè¦‹ãˆã‚‹ï¼</p>
<h3 id="factcheck">FactCheck</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  local_20 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001012cf to 001012d3 has its CatchHandler @ 00101975
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_248,(allocator <span style="color:#f92672">*</span>)<span style="color:#e6db74">&#34;picoCTF{wELF_d0N3_mate_&#34;</span>);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 0010130a to 0010130e has its CatchHandler @ 00101996
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_228,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010201d);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101345 to 00101349 has its CatchHandler @ 001019b1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_208,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010201f);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101380 to 00101384 has its CatchHandler @ 001019cc
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_1e8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102021);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001013bb to 001013bf has its CatchHandler @ 001019e7
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_1c8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010201d);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001013f6 to 001013fa has its CatchHandler @ 00101a02
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_1a8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102023);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101431 to 00101435 has its CatchHandler @ 00101a1d
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_188,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102025);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 0010146c to 00101470 has its CatchHandler @ 00101a38
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_168,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102027);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001014a7 to 001014ab has its CatchHandler @ 00101a53
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_148,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102029);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001014e2 to 001014e6 has its CatchHandler @ 00101a6e
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_128,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010202b);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 0010151d to 00101521 has its CatchHandler @ 00101a89
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_108,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010202d);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101558 to 0010155c has its CatchHandler @ 00101aa4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_e8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102025);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101593 to 00101597 has its CatchHandler @ 00101abf
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_c8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010202f);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001015ce to 001015d2 has its CatchHandler @ 00101ada
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_a8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102031);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101606 to 0010160a has its CatchHandler @ 00101af5
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_88,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102033);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 0010163e to 00101642 has its CatchHandler @ 00101b0d
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_68,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010201d);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101676 to 0010167a has its CatchHandler @ 00101b25
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_48,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102033);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101699 to 0010185f has its CatchHandler @ 00101b3d
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_208);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#39;B&#39;</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_c8);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_a8);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;A&#39;</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_68);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_1c8);
</span></span><span style="display:flex;"><span>  cVar1 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>pcVar2;
</span></span><span style="display:flex;"><span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_148);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ((<span style="color:#66d9ef">int</span>)cVar1 <span style="color:#f92672">-</span> (<span style="color:#66d9ef">int</span>)<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_1c8);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_1e8);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_188);
</span></span><span style="display:flex;"><span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_168);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;G&#39;</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_168);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_1a8);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_88);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_228);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_128);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,<span style="color:#e6db74">&#39;}&#39;</span>);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::~</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            (local_48);
</span></span></code></pre></div><p>å‰åŠã§æ–‡å­—åˆ—ã‚’ãƒ¡ãƒ¢ãƒªã«å½“ã¦ã“ã‚“ã§ã„ã¦ï¼Œå¾ŒåŠã§ãã®å„ãƒ¡ãƒ¢ãƒªã®å€¤ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãƒ•ãƒ©ã‚°ã®æ–‡å­—åˆ—ã«è¿½åŠ ã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ã¦ã„ã‚‹ï¼
ä¾‹ãˆã°ä»¥ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_208);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#39;B&#39;</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_c8);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p><code>local_208</code> ã®å€¤ãŒ <code>&lt;'B'</code> ãªã‚‰ï¼Œ<code>local_c8 (2)</code> ã‚’è¿½åŠ ã™ã‚‹ï¼Œã¿ãŸã„ãªæ„Ÿã˜ï¼
æœ€å¾Œã« <code>std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::operator+=(local_248,'}');</code> ãŒã‚ã‚‹ã®ã§ã“ã“ã§ãŠã—ã¾ã„ï¼</p>
<h3 id="keygenme">Keygenme</h3>
<p>ãªã‚“ã‹ libcrypto.so.1.1 ãŒè¶³ã‚Šãªã„ã£ã¦æ€’ã‚‰ã‚ŒãŸã®ã§ãƒ“ãƒ«ãƒ‰ã™ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget https://www.openssl.org/source/old/1.1.0/openssl-1.1.0l.tar.gz
</span></span><span style="display:flex;"><span>tar xvf openssl-1.1.0l.tar.gz
</span></span><span style="display:flex;"><span>cd openssl-1.1.0l
</span></span><span style="display:flex;"><span>./config
</span></span><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>export LD_LIBRARY_PATH<span style="color:#f92672">=</span>./openssl-1.1.0l:$LD_LIBRARY_PATH
</span></span></code></pre></div><p>å®Ÿè¡Œã™ã‚‹ã¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚­ãƒ¼ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ï¼
<code>printf(&quot;Enter your license key: &quot;);</code> ã¿ãŸã„ãªè¨˜è¿°ãŒã‚ã‚‹é–¢æ•°ãŒã‚ã‚‹ã®ã§ã“ã‚ŒãŒ main ?</p>
<p>ä»¥ä¸‹å°‘ã—ä¸å¯§ã«ã‚„ã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  local_10 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  local_98 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7b4654436f636970</span>;
</span></span><span style="display:flex;"><span>  local_90 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x30795f676e317262</span>;
</span></span><span style="display:flex;"><span>  local_88 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6b5f6e77305f7275</span>;
</span></span><span style="display:flex;"><span>  local_80 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x5f7933</span>;
</span></span><span style="display:flex;"><span>  local_ba <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7d</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* 27words */</span>
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">MD5</span>((uchar <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98,sVar1,local_b8);
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_ba);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">MD5</span>((uchar <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_ba,sVar1,local_a8);
</span></span><span style="display:flex;"><span>  local_d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_cc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_cc <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x10</span>; local_cc <span style="color:#f92672">=</span> local_cc <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sprintf</span>(local_78 <span style="color:#f92672">+</span> local_d0,<span style="color:#e6db74">&#34;%02x&#34;</span>,(ulong)local_b8[local_cc]);
</span></span><span style="display:flex;"><span>    local_d0 <span style="color:#f92672">=</span> local_d0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  local_d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_c8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c8 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x10</span>; local_c8 <span style="color:#f92672">=</span> local_c8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sprintf</span>(local_58 <span style="color:#f92672">+</span> local_d0,<span style="color:#e6db74">&#34;%02x&#34;</span>,(ulong)local_a8[local_c8]);
</span></span><span style="display:flex;"><span>    local_d0 <span style="color:#f92672">=</span> local_d0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_c4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c4 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x1b</span>; local_c4 <span style="color:#f92672">=</span> local_c4 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    acStack_38[local_c4] <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)<span style="color:#f92672">&amp;</span>local_98 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">long</span>)local_c4);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> local_43;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> local_62;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> local_62;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> local_78[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> local_5b;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> local_43;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">33</span>] <span style="color:#f92672">=</span> local_6a;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">34</span>] <span style="color:#f92672">=</span> local_60;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">35</span>] <span style="color:#f92672">=</span> (undefined)local_ba;
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(param_1);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (sVar1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x24</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (local_c0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c0 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x24</span>; local_c0 <span style="color:#f92672">=</span> local_c0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (param_1[local_c0] <span style="color:#f92672">!=</span> acStack_38[local_c0]) {
</span></span><span style="display:flex;"><span>        uVar2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">goto</span> LAB_00101475;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    uVar2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>local_98~~ ã¿ãŸã„ãªã¨ã“ãŒãƒ•ãƒ©ã‚°ã®å‰åŠã«ãªã£ã¦ã„ã¦ï¼Œæ®‹ã‚Šã®ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚’æ¢ãã†ã¨ã„ã†æ„Ÿã˜ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MD5</span>((uchar <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98,sVar1,local_b8);
</span></span></code></pre></div><p>ã¾ãšï¼Œ<code>local_98 ~~</code> ã«ã¯ <code>0x7b ~~</code> ã®ãƒ•ãƒ©ã‚°ãŒå…¥ã£ã¦ã„ã‚‹ã®ã§ï¼Œæœ€åˆã¯ <code>sVar1 = 17</code>
ã§ï¼ŒMD5 ã‚’è¨ˆç®—ã—ã¦ã„ã‚‹ï¼
ã“ã®çµæœã¯ local_b8 ã‹ã‚‰è¦‹ã‚Œã‚‹ï¼
é€†ã« <code>local_b1</code> ã«ã¯ <code>0x7d</code> ã—ã‹å…¥ã£ã¦ãªã„ã®ã§ 1 æ–‡å­—ã ã‘ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>local_d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_cc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_cc <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x10</span>; local_cc <span style="color:#f92672">=</span> local_cc <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sprintf</span>(local_78 <span style="color:#f92672">+</span> local_d0,<span style="color:#e6db74">&#34;%02x&#34;</span>,(ulong)local_b8[local_cc]);
</span></span><span style="display:flex;"><span>    local_d0 <span style="color:#f92672">=</span> local_d0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  local_d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_c8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c8 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x10</span>; local_c8 <span style="color:#f92672">=</span> local_c8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sprintf</span>(local_58 <span style="color:#f92672">+</span> local_d0,<span style="color:#e6db74">&#34;%02x&#34;</span>,(ulong)local_a8[local_c8]);
</span></span><span style="display:flex;"><span>    local_d0 <span style="color:#f92672">=</span> local_d0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>æ¬¡ã«ã“ã“ã‚’è€ƒãˆã‚‹ï¼
local_b8, local_a8 ã«ã¯æ—¢ã«ãƒãƒƒã‚·ãƒ¥å€¤ãŒå…¥ã£ã¦ã„ã¦ï¼Œlocal_78 ã®å¤‰æ•°ã«æ ¼ç´ã—ã¦ã„ãï¼
ã“ã“ã§ï¼Œlocal_78 ã¯å°ã•ã„æ–¹ã«ä¼¸ã³ã‚‹ã“ã¨ã‚’å¤±å¿µã—ã¦ã„ã¦æ™‚é–“ã‚’ä½¿ã£ã¦ã—ã¾ã£ãŸï¼
ã¤ã¾ã‚Šï¼Œlocal_78 -&gt; local_76 ã¿ãŸã„ãªæ„Ÿã˜ã§ä¼¸ã³ã¦ã„ãï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_c4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c4 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x1b</span>; local_c4 <span style="color:#f92672">=</span> local_c4 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    acStack_38[local_c4] <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)<span style="color:#f92672">&amp;</span>local_98 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">long</span>)local_c4);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ã“ã“ã¯æ—¢å­˜ã®ãƒ•ãƒ©ã‚°ã‚’ä»£å…¥ã—ã¦ã„ã‚‹ã ã‘</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> local_43;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> local_62;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> local_62;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> local_78[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> local_5b;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> local_43;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">33</span>] <span style="color:#f92672">=</span> local_6a;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">34</span>] <span style="color:#f92672">=</span> local_60;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">35</span>] <span style="color:#f92672">=</span> (undefined)local_ba;
</span></span></code></pre></div><p>ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚’å…¥ã‚Œã‚‹ã¨ã“ã‚ï¼
å…ˆã«æ±ºã‚ã¦ã„ãŸãƒãƒƒã‚·ãƒ¥å€¤ã‚’è¦‹ã‚Œã°ä»£å…¥ã§ãã‚‹ï¼</p>
<p>é™çš„è§£æã§é ‘å¼µã£ãŸãŒï¼Œgdb ã§ã‚„ã£ãŸã‚‰ 2 ç§’ã§çµ‚ã‚ã£ãŸï¼
ã¤ã¾ã‚Šï¼Œãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚’ä»£å…¥ã—ã¦ã„ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã§æ­¢ã‚ã¦ eax ã‚’è¦‹ã‚Œã°ã„ã„ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>c8 <span style="color:#ae81ff">0f</span> b6 <span style="color:#ae81ff">45</span> c5     MOVZX      EAX,byte ptr [RBP <span style="color:#f92672">+</span> local_43]
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>cc <span style="color:#ae81ff">88</span> <span style="color:#ae81ff">45</span> eb        MOV        byte ptr [RBP <span style="color:#f92672">+</span> local_1d],AL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>cf <span style="color:#ae81ff">0f</span> b6 <span style="color:#ae81ff">45</span> a6     MOVZX      EAX,byte ptr [RBP <span style="color:#f92672">+</span> local_62]
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>d3 <span style="color:#ae81ff">88</span> <span style="color:#ae81ff">45</span> ec        MOV        byte ptr [RBP <span style="color:#f92672">+</span> local_1c],AL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>d6 <span style="color:#ae81ff">0f</span> b6 <span style="color:#ae81ff">45</span> a6     MOVZX      EAX,byte ptr [RBP <span style="color:#f92672">+</span> local_62]
</span></span></code></pre></div><p>é™çš„è§£æï¼Œãƒ‘ã‚ºãƒ«ã§æ¥½ã—ã„ã—ç­‹ãƒˆãƒ¬ã«ã¯ãªã‚‹ã‘ã©çœ¼ã®è² æ‹…ãŒã‚¨ã‚°ã„ã—å‹•çš„è§£æãŒä¸€ç¬ã§çµ‚ã‚ã£ãŸæ™‚è™šç„¡ã™ãã‚‹</p>
<h3 id="wizardlike">Wizardlike</h3>
<p>ãƒã‚¸ã§ã‚ã‹ã‚“ã­ï½ã¨æ€ã„ãªãŒã‚‰ä¸­è¦‹ã¦ãŸã‚‰ ASCII ã‚³ãƒ¼ãƒ‰ãŒè¦‹ãˆãŸã®ã§æ°—åˆã¨æ ¹æ€§ï¼</p>
<h3 id="classic-crackme-0x100">Classic Crackme 0x100</h3>
<p>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç³»ã®å…¸å‹å•é¡Œï¼
memcmp ãŒã‚ã‚‹ã®ã§ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’è¦‹ã‚Œã°ã„ã„ã‹ï¼Œã¨æ€ã£ãŸãŒï¼Œå…¥åŠ›ã‚’ã“ã­ãã‚Šã¾ã‚ã—ã¦ã„ã‚‹ &amp; ãƒ•ãƒ©ã‚°ãŒã‚µãƒ¼ãƒå´ã«ã‚ã‚‹ï¼Œã§ã¡ã‚ƒã‚“ã¨é™çš„è§£æã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  cmp_flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x747774746971747a</span>;
</span></span><span style="display:flex;"><span>  local_60 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7372667965697478</span>;
</span></span><span style="display:flex;"><span>  local_58 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x766f78757a74676c</span>;
</span></span><span style="display:flex;"><span>  local_50 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6e7372626e64666c</span>;
</span></span><span style="display:flex;"><span>  local_48 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x647368687976726c</span>;
</span></span><span style="display:flex;"><span>  local_40 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6e786f66727878</span>;
</span></span><span style="display:flex;"><span>  uStack_39 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6c626a</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">setvbuf</span>(stdout,(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter the secret password: &#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">__isoc99_scanf</span>(<span style="color:#f92672">&amp;</span>DAT_00402024,user_input);
</span></span><span style="display:flex;"><span>  local_c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  flag_length <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>cmp_flag);
</span></span><span style="display:flex;"><span>  flag_length__ <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)flag_length;
</span></span><span style="display:flex;"><span>  local_18 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x55</span>;
</span></span><span style="display:flex;"><span>  local_1c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  local_20 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xf</span>;
</span></span><span style="display:flex;"><span>  local_21 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (; local_c <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>; local_c <span style="color:#f92672">=</span> local_c <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (counter_input <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; counter_input <span style="color:#f92672">&lt;</span> flag_length__; counter_input <span style="color:#f92672">=</span> counter_input <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>      local_28 <span style="color:#f92672">=</span> (counter_input <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xff</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> local_18) <span style="color:#f92672">+</span> (counter_input <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xff</span> <span style="color:#f92672">&amp;</span> local_18);
</span></span><span style="display:flex;"><span>      local_2c <span style="color:#f92672">=</span> ((<span style="color:#66d9ef">int</span>)local_28 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&amp;</span> local_1c) <span style="color:#f92672">+</span> (local_1c <span style="color:#f92672">&amp;</span> local_28);
</span></span><span style="display:flex;"><span>      iVar1 <span style="color:#f92672">=</span> ((<span style="color:#66d9ef">int</span>)local_2c <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">&amp;</span> local_20) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>              ((<span style="color:#66d9ef">int</span>)user_input[counter_input] <span style="color:#f92672">-</span> (<span style="color:#66d9ef">int</span>)local_21) <span style="color:#f92672">+</span> (local_20 <span style="color:#f92672">&amp;</span> local_2c);
</span></span><span style="display:flex;"><span>      user_input[counter_input] <span style="color:#f92672">=</span> local_21 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">char</span>)iVar1 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">char</span>)(iVar1 <span style="color:#f92672">/</span> <span style="color:#ae81ff">0x1a</span>) <span style="color:#f92672">*</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0x1a</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  iVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">memcmp</span>(user_input,<span style="color:#f92672">&amp;</span>cmp_flag,(<span style="color:#66d9ef">long</span>)flag_length__);
</span></span></code></pre></div><p>é‡è¦ãªã®ã¯ for ã‚’å›ã—ã¦ã„ã‚‹éƒ¨åˆ†ã¨ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹æƒ…å ±ã¯ãƒªãƒˆãƒ«ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ã§ã‚ã‚‹ã“ã¨ï¼
ã‚½ãƒ«ãƒã¯ä»¥ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cmp_flag <span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x7a</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x71</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x77</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x65</span>,<span style="color:#ae81ff">0x79</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x67</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x7a</span>,<span style="color:#ae81ff">0x75</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x6f</span>,<span style="color:#ae81ff">0x76</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x62</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x76</span>,<span style="color:#ae81ff">0x79</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x6f</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x6a</span>,<span style="color:#ae81ff">0x62</span>,<span style="color:#ae81ff">0x6c</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local_18 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x55</span>
</span></span><span style="display:flex;"><span>local_1c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>
</span></span><span style="display:flex;"><span>local_20 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xf</span>
</span></span><span style="display:flex;"><span>local_21 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>user_input <span style="color:#f92672">=</span> [<span style="color:#66d9ef">None</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>pattern <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">50</span>):
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> chara <span style="color:#f92672">in</span> pattern:
</span></span><span style="display:flex;"><span>      tmp_user_input <span style="color:#f92672">=</span> chara
</span></span><span style="display:flex;"><span>      tmp_user_input <span style="color:#f92672">=</span> ord(tmp_user_input)
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            local_28 <span style="color:#f92672">=</span> (j <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xff</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> local_18) <span style="color:#f92672">+</span> (j <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xff</span> <span style="color:#f92672">&amp;</span> local_18)
</span></span><span style="display:flex;"><span>            local_2c <span style="color:#f92672">=</span> (local_28 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&amp;</span> local_1c) <span style="color:#f92672">+</span> (local_1c <span style="color:#f92672">&amp;</span> local_28)
</span></span><span style="display:flex;"><span>            iVar1 <span style="color:#f92672">=</span> (local_2c <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">&amp;</span> local_20) <span style="color:#f92672">+</span> (tmp_user_input <span style="color:#f92672">-</span> ord(local_21)) <span style="color:#f92672">+</span> (local_20 <span style="color:#f92672">&amp;</span> local_2c)
</span></span><span style="display:flex;"><span>            tmp_user_input <span style="color:#f92672">=</span> ord(local_21) <span style="color:#f92672">+</span> iVar1 <span style="color:#f92672">+</span> (iVar1 <span style="color:#f92672">//</span> <span style="color:#ae81ff">0x1a</span>) <span style="color:#f92672">*</span> (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x1a</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(hex(tmp_user_input) <span style="color:#f92672">==</span> hex(cmp_flag[j])):
</span></span><span style="display:flex;"><span>         print(chara, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">break</span>
</span></span></code></pre></div><h3 id="winantidbg0x100">WinAntiDbg0x100</h3>
<p>Windows ã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‡ãƒãƒƒã‚°ã—ã¦ãƒ•ãƒ©ã‚°ã‚’å–ã‚ã†ï¼Œã¿ãŸã„ãªæ„Ÿã˜ã‚‰ã—ã„ï¼
å®Ÿè¡Œã—ãªãŒã‚‰ã‚„ã‚‹ã¨ã„ã„ã‚‰ã—ã„ã®ã§å‹‰å¼·ãŒã¦ã‚‰ IDA ã‚’ä½¿ã£ã¦ã‚„ã£ã¦ã¿ã‚‹ï¼</p>
<p>å˜ç´”ã« IDA ã§å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºã‚‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Debugged application message: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        _            _____ _______ ______  
</span></span><span style="display:flex;"><span>       (_)          / ____|__   __|  ____| 
</span></span><span style="display:flex;"><span>  _ __  _  ___ ___ | |       | |  | |__    
</span></span><span style="display:flex;"><span> | &#39;_ \| |/ __/ _ \| |       | |  |  __|   
</span></span><span style="display:flex;"><span> | |_) | | (_| (_) | |____   | |  | |      
</span></span><span style="display:flex;"><span> | .__/|_|\___\___/ \_____|  |_|  |_|      
</span></span><span style="display:flex;"><span> | |                                       
</span></span><span style="display:flex;"><span> |_|                                       
</span></span><span style="display:flex;"><span>  Welcome to the Anti-Debug challenge!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Debugged application message: ### Level 1: Why did the clever programmer become a gardener? Because they discovered their talent for growing a &#39;patch&#39; of roses!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Debugged application message: ### Oops! The debugger was detected. Try to bypass this check to get the flag!
</span></span></code></pre></div><p>ãƒ‡ãƒãƒƒã‚¬æ¤œå‡ºã®åˆ†å²ãŒã‚ã‚‹ã£ã½ã„ã®ã§ï¼Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰è¦‹ã¦å½“è©²ç®‡æ‰€ã‚’æ¢ã™ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">asc_6D3438</span> <span style="color:#75715e">; &#34;\n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ds</span>:<span style="color:#66d9ef">OutputDebugStringW</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">asc_6D343C</span> <span style="color:#75715e">; &#34;\n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ds</span>:<span style="color:#66d9ef">OutputDebugStringW</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">sub_6D11B0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">sub_6D1200</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">test</span>    <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">jnz</span>     <span style="color:#66d9ef">short</span> <span style="color:#66d9ef">loc_6D15E7</span>
</span></span></code></pre></div><p><code>test</code> ã®ã¨ã“ã‚ã‚’å³ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ <code>Add breakpoint</code> ã¨ã„ã†è¡¨ç¤ºãŒã‚ã‚‹ã®ã§ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¨­ç½®ã™ã‚‹ï¼
ã§ï¼Œå®Ÿè¡Œã™ã‚‹ã¨æ­¢ã¾ã£ã¦ãã‚Œã‚‹ã®ã§ï¼ŒIDA å´ã§ <code>eax</code> ã‚’ 0 ã«æ›¸ãæ›ãˆã¦ã‚ã’ã‚Œã°ãƒ•ãƒ©ã‚°ãŒè¿”ã£ã¦ãã‚‹ï¼</p>
<h3 id="winantidbg0x200">WinAntiDbg0x200</h3>
<p>WinAntiDbg0x100 ã¨ã»ã¨ã‚“ã©åŒã˜ã§ï¼Œåˆ†å²ãƒã‚¤ãƒ³ãƒˆã®ãƒ•ãƒ©ã‚°ã‚’æ›¸ãã‹ãˆã‚Œã°OK</p>
<h3 id="weirdsnake">weirdSnake</h3>
<p>python ã®ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœãŒæ¸¡ã•ã‚Œã‚‹ã®ã§æ‰‹ã§ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ï¼</p>
<h3 id="breadth">breadth</h3>
<p>äºŒã¤ã®åŒã˜ã‚ˆã†ãªãƒã‚¤ãƒŠãƒªãŒä¸ãˆã‚‰ã‚Œã‚‹ï¼
diff ã‚’å–ã£ã¦ã¿ã‚‹ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>objdump -d -M intel breadth.v1 &gt; v1.txt
</span></span><span style="display:flex;"><span>objdump -d -M intel breadth.v2 &gt; v2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>diff v1-disassm.txt v2-disassm.txt 
</span></span><span style="display:flex;"><span>2c2
</span></span><span style="display:flex;"><span>&lt; breadth.v1:     file format elf64-x86-64
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt; breadth.v2:     file format elf64-x86-64
</span></span><span style="display:flex;"><span>164220,164225c164220,164225
</span></span><span style="display:flex;"><span>&lt;    95049:     <span style="color:#ae81ff">48</span> 8b <span style="color:#ae81ff">54</span> <span style="color:#ae81ff">24</span> f0          mov    rdx,QWORD PTR <span style="color:#f92672">[</span>rsp-0x10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>&lt;    9504e:     b8 3a <span style="color:#ae81ff">80</span> <span style="color:#ae81ff">37</span> d0          mov    eax,0xd037803a
</span></span><span style="display:flex;"><span>&lt;    95053:     <span style="color:#ae81ff">48</span> <span style="color:#ae81ff">39</span> c2                cmp    rdx,rax
</span></span><span style="display:flex;"><span>&lt;    95056:     <span style="color:#ae81ff">74</span> <span style="color:#ae81ff">08</span>                   je     <span style="color:#ae81ff">95060</span> &lt;fcnkKTQpF+0x20&gt;
</span></span><span style="display:flex;"><span>&lt;    95058:     c3                      ret
</span></span><span style="display:flex;"><span>&lt;    95059:     0f 1f <span style="color:#ae81ff">80</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span>    nop    DWORD PTR <span style="color:#f92672">[</span>rax+0x0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt;    95049:     <span style="color:#ae81ff">48</span> 8b <span style="color:#ae81ff">44</span> <span style="color:#ae81ff">24</span> f0          mov    rax,QWORD PTR <span style="color:#f92672">[</span>rsp-0x10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>&gt;    9504e:     <span style="color:#ae81ff">48</span> 3d 3e c7 1b <span style="color:#ae81ff">04</span>       cmp    rax,0x41bc73e
</span></span><span style="display:flex;"><span>&gt;    95054:     <span style="color:#ae81ff">74</span> 0a                   je     <span style="color:#ae81ff">95060</span> &lt;fcnkKTQpF+0x20&gt;
</span></span><span style="display:flex;"><span>&gt;    95056:     c3                      ret
</span></span><span style="display:flex;"><span>&gt;    95057:     <span style="color:#ae81ff">66</span> 0f 1f <span style="color:#ae81ff">84</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span>    nop    WORD PTR <span style="color:#f92672">[</span>rax+rax*1+0x0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>&gt;    9505e:     <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> 
</span></span></code></pre></div><p>å½“è©²éƒ¨åˆ†ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ãƒ•ãƒ©ã‚°ãŒç­”ãˆã ã£ãŸ</p>
<p>é£½ãã¦ããŸã®ã§ä»–ã® CTF ã® rev ã‚’è§£ã“ã†ã¨æ€ã„ã¾ã™</p>

    </div>
    <div class="post-footer">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css" integrity="sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js" integrity="sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "$", right: "$", display: false}]
    });
  });
</script>
      
    </div>
  </article>
  <hr>
  <p>Â© side-realms All rights reserved.</p>

    </main>
  </body>
</html>
