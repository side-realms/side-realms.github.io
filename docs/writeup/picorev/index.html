<!doctype html>
<html lang="en-us">
  <head>
    <title>picoCTF の rev 全部解く // お茶は綾鷹派</title>
    <link rel="shortcut icon" href="../../favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="KoheiDoi" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="../../css/main.min.3fb9065bb18f896621f7ce2fad5bbbafdf9954fbe571b5e41c6e59a8cbacc8ef.css" />
    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="picoCTF の rev 全部解く"/>
<meta name="twitter:description" content="CTF の問題を解いていると，解けはするけど異常に時間がかかる，みたいなことが多い． rev に限れば，これは，ツールの使い方が甘かったり，つまみ食い的に rev をやってきたので常識が欠落していて遠回りしていたり，そもそもデコンパイル結果を読む筋力が全然なかったりすることが原因だと分かっている． なので，数をこなそう作戦で，知り合いにオススメされた picoCTF の rev を全部解いてみる． 2~3 日くらいで完走できたら良い
Transformation &#39;&#39;.join([chr((ord(flag[i]) &lt;&lt; 8) &#43; ord(flag[i &#43; 1])) for i in range(0, len(flag), 2)]) をデコードする encoded_flag = &#34;灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸弲㘶㠴挲ぽ&#34; flag = [] for i in range(len(encoded_flag)): tmp1 = ord(encoded_flag[i]) &amp; 0xFF tmp2 = ord(encoded_flag[i]) &gt;&gt; 8 flag &#43;= chr(tmp2) flag &#43;= chr(tmp1) print(&#34;&#34;.join(flag)) keygenme-py Arcane Calculator なるものが動いていて，ライセンスを入れるといいらしい def check_key(key, username_trial): global key_full_template_trial if len(key) != len(key_full_template_trial): return False else: # Check static base key part --v i = 0 for c in key_part_static1_trial: if key[i] !"/>

    <meta property="og:title" content="picoCTF の rev 全部解く" />
<meta property="og:description" content="CTF の問題を解いていると，解けはするけど異常に時間がかかる，みたいなことが多い． rev に限れば，これは，ツールの使い方が甘かったり，つまみ食い的に rev をやってきたので常識が欠落していて遠回りしていたり，そもそもデコンパイル結果を読む筋力が全然なかったりすることが原因だと分かっている． なので，数をこなそう作戦で，知り合いにオススメされた picoCTF の rev を全部解いてみる． 2~3 日くらいで完走できたら良い
Transformation &#39;&#39;.join([chr((ord(flag[i]) &lt;&lt; 8) &#43; ord(flag[i &#43; 1])) for i in range(0, len(flag), 2)]) をデコードする encoded_flag = &#34;灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸弲㘶㠴挲ぽ&#34; flag = [] for i in range(len(encoded_flag)): tmp1 = ord(encoded_flag[i]) &amp; 0xFF tmp2 = ord(encoded_flag[i]) &gt;&gt; 8 flag &#43;= chr(tmp2) flag &#43;= chr(tmp1) print(&#34;&#34;.join(flag)) keygenme-py Arcane Calculator なるものが動いていて，ライセンスを入れるといいらしい def check_key(key, username_trial): global key_full_template_trial if len(key) != len(key_full_template_trial): return False else: # Check static base key part --v i = 0 for c in key_part_static1_trial: if key[i] !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://side-realms.github.io/writeup/picorev/" /><meta property="article:section" content="writeup" />
<meta property="article:published_time" content="2024-04-07T19:40:38+09:00" />
<meta property="article:modified_time" content="2024-04-07T19:40:38+09:00" />

    <style>
      .hr1 {
  position: relative;
	height: 3px;
	border-width: 0;
	background-color: #00bcd4;
	background-image: -webkit-linear-gradient( 135deg, #FD6585 10%, #0D25B9 100%);
	background-image: linear-gradient( 135deg, #FD6585 10%, #0D25B9 100%);
}
    </style>

  </head>
  <body>
    <header class="app-header">
      <a href="http://side-realms.github.io"><img class="app-header-avatar" src="../../images/avatar.jpg" alt="KoheiDoi" /></a>
      <span class="app-header-title">お茶は綾鷹派</span>
      <p>最近は颯も好き</p>
      <p><font size="1">内容の正確性は保証していません🐶</font></p>
      <nav class="app-header-menu">
          <font size="5">
          <a class="app-header-menu-item" href="../../">Home</a>
          </font>
          <br>
            
          
          <font size="5">
          <a class="app-header-menu-item" href="../../log">life log</a>
          </font>
          <br>
            
          
          <font size="5">
          <a class="app-header-menu-item" href="../../treasure/">treasure trove</a>
          </font>
          <br>
      </nav>

      <hr class="hr1">
      <nav class="app-header-menu">
          <font size="4">
          <a class="app-header-menu-item" href="../../sound">sound</a>
          </font>
          <br>
            
          
          <font size="4">
          <a class="app-header-menu-item" href="../../container">container</a>
          </font>
          <br>
            
          
          <font size="4">
          <a class="app-header-menu-item" href="../../hardware">hardware</a>
          </font>
          <br>
            
          
          <font size="4">
          <a class="app-header-menu-item" href="../../writeup">writeup</a>
          </font>
          <br>
            
          
          <font size="4">
          <a class="app-header-menu-item" href="../../other">other</a>
          </font>
          <br>
      </nav>

      <hr class="hr1">
      <div class="app-header-social">
        
          <a href="https://github.com" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://twitter.com" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>Twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
          </a>
        
      </div>
      <div class="app-footer-copyright">
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">picoCTF の rev 全部解く</h1>
      </style>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Apr 7, 2024
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          22 min read
        </div>
      </div>
      <hr>
    </header>
    <div class="post-content">
      <p>CTF の問題を解いていると，解けはするけど異常に時間がかかる，みたいなことが多い．
rev に限れば，これは，ツールの使い方が甘かったり，つまみ食い的に rev をやってきたので常識が欠落していて遠回りしていたり，そもそもデコンパイル結果を読む筋力が全然なかったりすることが原因だと分かっている．
なので，数をこなそう作戦で，知り合いにオススメされた picoCTF の rev を全部解いてみる．
2~3 日くらいで完走できたら良い</p>
<h3 id="transformation">Transformation</h3>
<ul>
<li><code>''.join([chr((ord(flag[i]) &lt;&lt; 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)])</code> をデコードする</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>encoded_flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸弲㘶㠴挲ぽ&#34;</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(encoded_flag)):
</span></span><span style="display:flex;"><span>  tmp1 <span style="color:#f92672">=</span> ord(encoded_flag[i]) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF</span>
</span></span><span style="display:flex;"><span>  tmp2 <span style="color:#f92672">=</span> ord(encoded_flag[i]) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>  flag <span style="color:#f92672">+=</span> chr(tmp2)
</span></span><span style="display:flex;"><span>  flag <span style="color:#f92672">+=</span> chr(tmp1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(flag))
</span></span></code></pre></div><h3 id="keygenme-py">keygenme-py</h3>
<ul>
<li>Arcane Calculator なるものが動いていて，ライセンスを入れるといいらしい</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_key</span>(key, username_trial):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> key_full_template_trial
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(key) <span style="color:#f92672">!=</span> len(key_full_template_trial):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check static base key part --v</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> key_part_static1_trial:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> c:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># TODO : test performance on toolbox container</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check dynamic part --v</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">4</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">5</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">3</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">6</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">2</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">7</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">1</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key[i] <span style="color:#f92672">!=</span> hashlib<span style="color:#f92672">.</span>sha256(username_trial)<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">8</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span></code></pre></div><p>これを見て，あとは事前に定義されている文字列を当てはめればいい</p>
<h3 id="armssebly-0">ARMssebly 0</h3>
<p>ARM のアセンブリがわたされるのでクロスコンパイルする</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>aarch64-linux-gnu-as chall.S -o chall
</span></span></code></pre></div><p>Ghidra で見ると整数の大小を比較しているだけなので大きい方が答え</p>
<h3 id="vault-door-training">vault-door-training</h3>
<p>java のソースを読むだけ</p>
<h3 id="speeds-and-feeds">speeds and feeds</h3>
<p>G-code が出てくるのでプロットする．
<a href="https://ncviewer.com/">いいサンプルサイト</a>があった</p>
<h3 id="shop">Shop</h3>
<p>負の個数買うと所持金が増える</p>
<h3 id="armeembly-1">Armeembly 1</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0xd2a</span> <span style="color:#f92672">-</span> param_1
</span></span></code></pre></div><h3 id="armssembly-2">ARMssembly 2</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_4 <span style="color:#f92672">&lt;</span> param_1; local_4 <span style="color:#f92672">=</span> local_4 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    local_8 <span style="color:#f92672">=</span> local_8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>なんか何がしたいのか分からない問題が続くので，ちゃんと手を動かした問題だけのせる</p>
<h3 id="gdb-baby-step2">GDB baby step2</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb debugger0_b
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>info functions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b main
</span></span><span style="display:flex;"><span>layout asm
</span></span><span style="display:flex;"><span>r
</span></span></code></pre></div><p>この時点で，main 関数の ret (関数抜け)のアドレスが分かるので</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>b *0x401142
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c
</span></span><span style="display:flex;"><span>info register rip
</span></span><span style="display:flex;"><span>print/d $eax
</span></span></code></pre></div><h3 id="gdb-baby-step4">GDB baby step4</h3>
<p>gdb で main に breakpoint を設置し，ステップ実行すると imul が見える</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>   0x401106 &lt;func1&gt;       endbr64 
</span></span><span style="display:flex;"><span>   0x40110a &lt;func1+4&gt;     push   rbp
</span></span><span style="display:flex;"><span>   0x40110b &lt;func1+5&gt;     mov    rbp, rsp
</span></span><span style="display:flex;"><span>   0x40110e &lt;func1+8&gt;     mov    dword ptr <span style="color:#f92672">[</span>rbp - 4<span style="color:#f92672">]</span>, edi
</span></span><span style="display:flex;"><span>   0x401111 &lt;func1+11&gt;    mov    eax, dword ptr <span style="color:#f92672">[</span>rbp - 4<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span> ► 0x401114 &lt;func1+14&gt;    imul   eax, eax, 0x3269
</span></span><span style="display:flex;"><span>   0x40111a &lt;func1+20&gt;    pop    rbp
</span></span><span style="display:flex;"><span>   0x40111b &lt;func1+21&gt;    ret    
</span></span></code></pre></div><p>ということで 0x3269</p>
<h3 id="picker-i">Picker I</h3>
<p>入力した関数を実行してくれるインスタンスが動いている．
win() を実行すると flag.txt を展開してくれるので，これを文字列に直せばいい</p>
<h3 id="picker-ii">Picker II</h3>
<p>こんどは入力がフィルタされていて，「win」 が打てなくなっている．
一方で，main の eval はそのままなので，exec のようにコマンドインジェクションが通る．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt; print<span style="color:#f92672">(</span>open<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;flag.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span><span style="color:#f92672">)</span>.read<span style="color:#f92672">())</span>
</span></span><span style="display:flex;"><span>picoCTF<span style="color:#f92672">{</span>f1l73r5_f41l_c0d3_r3f4c70r_m1gh7_5ucc33d_95d44590<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;NoneType&#39;</span> object is not callable
</span></span></code></pre></div><h3 id="picker-iii">Picker III</h3>
<p>必ず呼び出される <code>call_func()</code> 関数の最後に <code>eval(func_name+'()')</code> があるのでこれを利用する．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_func</span>(n):
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">global</span> func_table
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Check table for viability</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>( <span style="color:#f92672">not</span> check_table() ):
</span></span><span style="display:flex;"><span>    print(CORRUPT_MESSAGE)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Get function name from table</span>
</span></span><span style="display:flex;"><span>  func_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>  func_name_offset <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> FUNC_TABLE_ENTRY_SIZE
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(func_name_offset, func_name_offset<span style="color:#f92672">+</span>FUNC_TABLE_ENTRY_SIZE):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>( func_table[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>):
</span></span><span style="display:flex;"><span>      func_name <span style="color:#f92672">=</span> func_table[func_name_offset:i]
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>( func_name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;&#39;</span> ):
</span></span><span style="display:flex;"><span>    func_name <span style="color:#f92672">=</span> func_table[func_name_offset:func_name_offset<span style="color:#f92672">+</span>FUNC_TABLE_ENTRY_SIZE]
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> func_name
</span></span></code></pre></div><p>func_name が win になればいい</p>
<p>func_table を参照しているので，書き換えたい．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/CTF<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nc saturn.picoctf.net 51363
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt; <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>Please enter variable name to write: func_table
</span></span><span style="display:flex;"><span>Please enter new value of variable: <span style="color:#e6db74">&#39;win                     read_variable                   write_variable                               &#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt; <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x37 0x68 0x31 0x35 0x5f 0x31 0x35 0x5f 0x77 0x68 0x34 0x37 0x5f 0x77 0x33 <span style="color:#ae81ff">07</span> 0x31 0x37 0x68 0x5f 0x75 0x35 0x33 0x72 0x35 0x5f 0x31 0x6e 0x5f 0x63 0x68 0x34 0x72 0x67 0x33 0x5f 0x32 0x32 0x36 0x7d 
</span></span><span style="display:flex;"><span><span style="color:#f92672">==</span>&gt;           
</span></span></code></pre></div><h3 id="packer">packer</h3>
<p><code>strings</code> するとなんか難読化された文字列がたくさん出てくる．
packer だし，<code>strings</code> の結果にも <code>UPX packer</code> みたいな記述があるので，アンパックしてみる</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>upx -d out
</span></span><span style="display:flex;"><span>strings out | grep flag
</span></span></code></pre></div><h3 id="asm1">asm1</h3>
<p>アセンブリ，ちゃんとまとめたことがないので真面目にやる</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">asm1:
    &lt;+0&gt;:   push   ebp
    &lt;+1&gt;:   mov    ebp,esp
    &lt;+3&gt;:   cmp    DWORD PTR [ebp+0x8],0x3fb
    &lt;+10&gt;:   jg     0x512 &lt;asm1+37&gt;
    &lt;+12&gt;:   cmp    DWORD PTR [ebp+0x8],0x280
    &lt;+19&gt;:   jne    0x50a &lt;asm1+29&gt;
    &lt;+21&gt;:   mov    eax,DWORD PTR [ebp+0x8]
    &lt;+24&gt;:   add    eax,0xa
    &lt;+27&gt;:   jmp    0x529 &lt;asm1+60&gt;
    &lt;+29&gt;:   mov    eax,DWORD PTR [ebp+0x8]
    &lt;+32&gt;:   sub    eax,0xa
    &lt;+35&gt;:   jmp    0x529 &lt;asm1+60&gt;
    &lt;+37&gt;:   cmp    DWORD PTR [ebp+0x8],0x559
    &lt;+44&gt;:   jne    0x523 &lt;asm1+54&gt;
    &lt;+46&gt;:   mov    eax,DWORD PTR [ebp+0x8]
    &lt;+49&gt;:   sub    eax,0xa
    &lt;+52&gt;:   jmp    0x529 &lt;asm1+60&gt;
    &lt;+54&gt;:   mov    eax,DWORD PTR [ebp+0x8]
    &lt;+57&gt;:   add    eax,0xa
    &lt;+60&gt;:   pop    ebp
    &lt;+61&gt;:   ret    
</code></pre><p>まず push ebp で，main 関数の上に今のベースポインタアドレス(ebp)を格納する．
このとき，push したので esp の値は -4 される．
次に，mov ebp,esp で，esp の値を ebp に格納する．
これにより，今の ebp(main 関数の底)が，esp(main 関数 + push ebp した値のスタックトップ)になるので，esp と ebp が同じ値になる．</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">    &lt;+0&gt;:   push   ebp
    &lt;+1&gt;:   mov    ebp,esp
</code></pre><p>逆に，関数から戻るときはまず <code>mov esp,ebp</code> で esp(スタックトップ) に ebp(実行している関数のベースアドレス)の値を代入する．
次に <code>pop ebp</code> をする．
このとき pop されるのは，<code>push ebp</code> で push された main関数の ebp なので，main 関数のベースアドレスが元に戻り，esp も +4 されて，関数から戻ってこれるようになる．</p>
<p>今回の場合は，引数がある．
引数は ebp+8 で表現されている．
(ebp の退避先，esp の退避先，引数の順)
引数は 0x2e0 で，0x2e0 &lt; 0x3fb なので jg のジャンプは起こらない</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">cmp    DWORD PTR [ebp+0x8],0x3fb
jg     0x512 &lt;asm1+37&gt;
</code></pre><p>次に 0x2e0 != 0x280 なので ZF = 0 で，移動する</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">&lt;+12&gt;:   cmp    DWORD PTR [ebp+0x8],0x280
&lt;+19&gt;:   jne    0x50a &lt;asm1+29&gt;
</code></pre><p>jmp は何もなくても移動する</p>
<pre tabindex="0"><code class="language-assebmly" data-lang="assebmly">&lt;+29&gt;:   mov    eax,DWORD PTR [ebp+0x8]
&lt;+32&gt;:   sub    eax,0xa
&lt;+35&gt;:   jmp    0x529 &lt;asm1+60&gt;
</code></pre><pre tabindex="0"><code class="language-assembly" data-lang="assembly">    &lt;+60&gt;:   pop    ebp
    &lt;+61&gt;:   ret    
</code></pre><h3 id="bbbbloat">Bbbbloat</h3>
<p>ghidra で見ると比較部分があるので，これをそのまま入力する</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (local_48 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x86187</span>)
</span></span></code></pre></div><h3 id="asm-2">asm 2</h3>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">asm2:
    &lt;+0&gt;:    push   ebp
    &lt;+1&gt;:    mov    ebp,esp
    &lt;+3&gt;:    sub    esp,0x10
    &lt;+6&gt;:    mov    eax,DWORD PTR [ebp+0xc]
    &lt;+9&gt;:    mov    DWORD PTR [ebp-0x4],eax
    &lt;+12&gt;:    mov    eax,DWORD PTR [ebp+0x8]
    &lt;+15&gt;:    mov    DWORD PTR [ebp-0x8],eax
    &lt;+18&gt;:    jmp    0x50c &lt;asm2+31&gt;
    &lt;+20&gt;:    add    DWORD PTR [ebp-0x4],0x1
    &lt;+24&gt;:    add    DWORD PTR [ebp-0x8],0xd1
    &lt;+31&gt;:    cmp    DWORD PTR [ebp-0x8],0x5fa1
    &lt;+38&gt;:    jle    0x501 &lt;asm2+20&gt;
    &lt;+40&gt;:    mov    eax,DWORD PTR [ebp-0x4]
    &lt;+43&gt;:    leave  
    &lt;+44&gt;:    ret    
</code></pre><pre tabindex="0"><code class="language-assembly" data-lang="assembly">    &lt;+6&gt;:    mov    eax,DWORD PTR [ebp+0xc]
    &lt;+9&gt;:    mov    DWORD PTR [ebp-0x4],eax
    &lt;+12&gt;:    mov    eax,DWORD PTR [ebp+0x8]
    &lt;+15&gt;:    mov    DWORD PTR [ebp-0x8],eax
</code></pre><p>引数を esp+0x10 で広げたスタック分に詰める．</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">    &lt;+31&gt;:    cmp    DWORD PTR [ebp-0x8],0x5fa1
</code></pre><p>このあと， ebp-0x8 と 0x5fa1 が比較され，0x5fa1 の値を超えなければ 0xd1 が加算される．
なので，0x2d と 0x5fa1 の差を比べ，0xd1 を足した回数分，0x11 に 0x1 を足す．</p>
<ul>
<li>{(0x5fa1 - 0x2d) // 0xd1 } + 1 + 0x2d</li>
</ul>
<h3 id="unpackme">unpackme</h3>
<p>たぶん pakcker だろうと思いながら解く．
radare2 の使い方を勉強しながら解いてみる．</p>
<p>正しい数字を入力するとフラグを返してくれるプログラムっぽい</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/CTF<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ r2 unpackme-upx            
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x00401c60<span style="color:#f92672">]</span>&gt; aaa
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> <span style="color:#f92672">]</span> Analyze all flags starting with sym. and entry0 <span style="color:#f92672">(</span>aa<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Cannot find basic block <span style="color:#66d9ef">for</span> switch <span style="color:#66d9ef">case</span> at 0x0043f6d3 bbdelta <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze all flags starting with sym. and entry0 <span style="color:#f92672">(</span>aa<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze <span style="color:#66d9ef">function</span> calls <span style="color:#f92672">(</span>aac<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze len bytes of instructions <span style="color:#66d9ef">for</span> references <span style="color:#f92672">(</span>aar<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Finding and parsing C++ vtables <span style="color:#f92672">(</span>avrr<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Type matching analysis <span style="color:#66d9ef">for</span> all functions <span style="color:#f92672">(</span>aaft<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Propagate noreturn information <span style="color:#f92672">(</span>aanr<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Use -AA or aaaa to perform additional experimental analysis.
</span></span></code></pre></div><p>afl コマンドで main 関数があることが分かっているので main を解析する</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>0x00401c60<span style="color:#f92672">]</span>&gt; s sym.main
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x00401e43<span style="color:#f92672">]</span>&gt; pdf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-- snip --
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>│           0x00401e9c      488d3d61110b.  lea rdi, str.Whats_my_favorite_number__ ; 0x4b3004 ; <span style="color:#e6db74">&#34;What&#39;s my favorite number? &#34;</span> ; int64_t arg1                                                                                            
</span></span><span style="display:flex;"><span>│           0x00401ea3      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x00401ea8      e8f3ec0000     call sym.__printf
</span></span><span style="display:flex;"><span>│           0x00401ead      488d45c4       lea rax, <span style="color:#f92672">[</span>var_3ch<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>│           0x00401eb1      4889c6         mov rsi, rax
</span></span><span style="display:flex;"><span>│           0x00401eb4      488d3d65110b.  lea rdi, <span style="color:#f92672">[</span>0x004b3020<span style="color:#f92672">]</span>       ; <span style="color:#e6db74">&#34;%d&#34;</span> ; const char *format
</span></span><span style="display:flex;"><span>│           0x00401ebb      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x00401ec0      e86bee0000     call sym.__isoc99_scanf     ; int scanf<span style="color:#f92672">(</span>const char *format<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>│           0x00401ec5      8b45c4         mov eax, dword <span style="color:#f92672">[</span>var_3ch<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>│           0x00401ec8      3dcb830b00     cmp eax, 0xb83cb &lt;- これ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-- snip --
</span></span></code></pre></div><h3 id="forky">forky</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>piVar1;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  piVar1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">mmap</span>((<span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0x21</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span>piVar1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000000000</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fork</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fork</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fork</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fork</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span>piVar1 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>piVar1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x499602d2</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">doNothing</span>(<span style="color:#f92672">*</span>piVar1);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>doNothing</code> に渡される引数の値が flag になっている．
piVar1 が明らかに鍵なので， fork() の動作を見る．</p>
<p>とは言っても単純で，プロセスが 2^4 = 16 個作られるだけ</p>
<p>1000000000 + 0x499602d2 * 16 = -721750240</p>
<h3 id="armssembly3">ARMssembly3</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">func1</span>(uint param_1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  uint local_14;
</span></span><span style="display:flex;"><span>  undefined4 local_4;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  local_4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_14 <span style="color:#f92672">=</span> param_1; local_14 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>; local_14 <span style="color:#f92672">=</span> local_14 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((local_14 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      local_4 <span style="color:#f92672">=</span> <span style="color:#a6e22e">func2</span>(local_4);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> local_4;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>func2</code> は引数に 3 を足して返す関数．
param1 のビットを見て後ろから 1 なら +3 する，みたいな感じでやればいい</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding:utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>num <span style="color:#f92672">=</span> <span style="color:#ae81ff">2541039191</span>
</span></span><span style="display:flex;"><span>i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> num <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> num<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    num <span style="color:#f92672">=</span> num <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>print(i)
</span></span></code></pre></div><h3 id="reverse_cipher">reverse_cipher</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> sVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> flag [<span style="color:#ae81ff">23</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> local_41;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> local_2c;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>fp_output;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>fp_flag;
</span></span><span style="display:flex;"><span>  uint local_14;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> local_10;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> local_9;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  fp_flag <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag.txt&#34;</span>,<span style="color:#e6db74">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span>  fp_output <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;rev_this&#34;</span>,<span style="color:#e6db74">&#34;a&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (fp_flag <span style="color:#f92672">==</span> (FILE <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;No flag found, please make sure this is run on the server&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (fp_output <span style="color:#f92672">==</span> (FILE <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;please run this on the server&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>(flag,<span style="color:#ae81ff">0x18</span>,<span style="color:#ae81ff">1</span>,fp_flag);
</span></span><span style="display:flex;"><span>  local_2c <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)sVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ((<span style="color:#66d9ef">int</span>)sVar1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">exit</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_10 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_10 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; local_10 <span style="color:#f92672">=</span> local_10 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    local_9 <span style="color:#f92672">=</span> flag[local_10];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fputc</span>((<span style="color:#66d9ef">int</span>)local_9,fp_output);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_14 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>; (<span style="color:#66d9ef">int</span>)local_14 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x17</span>; local_14 <span style="color:#f92672">=</span> local_14 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((local_14 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      local_9 <span style="color:#f92672">=</span> flag[(<span style="color:#66d9ef">int</span>)local_14] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;\x05&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      local_9 <span style="color:#f92672">=</span> flag[(<span style="color:#66d9ef">int</span>)local_14] <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fputc</span>((<span style="color:#66d9ef">int</span>)local_9,fp_output);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  local_9 <span style="color:#f92672">=</span> local_41;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fputc</span>((<span style="color:#66d9ef">int</span>)local_41,fp_output);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(fp_output);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(fp_flag);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>なんとなく変数名を直したのがこれ．
flag.txt からフラグを読んで，ちょっと計算して rev.txt に書き出すだけのプログラム．
なのでその計算に応じたソルバを書いてあげる</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding:utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ans <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;w1{1wq84fb&lt;1&gt;49}&#34;</span>
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> ans:
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> cnt<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    tmp <span style="color:#f92672">=</span> ord(i) <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x5</span>
</span></span><span style="display:flex;"><span>    print(chr(tmp), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    tmp <span style="color:#f92672">=</span> ord(i) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x2</span>
</span></span><span style="display:flex;"><span>    print(chr(tmp), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>  cnt <span style="color:#f92672">=</span> cnt<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span></code></pre></div><h3 id="asm3">asm3</h3>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">asm3:
    &lt;+0&gt;:    push   ebp
    &lt;+1&gt;:    mov    ebp,esp
    &lt;+3&gt;:    xor    eax,eax // eax -&gt; 0
    &lt;+5&gt;:    mov    ah,BYTE PTR [ebp+0xa] // ah &lt;- 33
    &lt;+8&gt;:    shl    ax,0x10  // ax &lt;- 3300 &lt;- 0000
    &lt;+12&gt;:    sub    al,BYTE PTR [ebp+0xc] //ae  0x00 - 0xae = FFFFFF52, al &lt;- 52
    &lt;+15&gt;:    add    ah,BYTE PTR [ebp+0xd] //ah 0x00 + 0x72 = 72, ah &lt;- 72
    &lt;+18&gt;:    xor    ax,WORD PTR [ebp+0x10] // ax &lt;- 0x7252 xor b139
    &lt;+22&gt;:    nop
    &lt;+23&gt;:    pop    ebp
    &lt;+24&gt;:    ret    
</code></pre><p>変数の積み方とリトルエンディアンの復習になった</p>
<p>初期状態は以下</p>
<table>
<thead>
<tr>
<th style="text-align:left">stack</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">main ebp</td>
</tr>
<tr>
<td style="text-align:left">ret</td>
</tr>
<tr>
<td style="text-align:left">d73346ed(引数1)</td>
</tr>
<tr>
<td style="text-align:left">d48672ae(引数2)</td>
</tr>
<tr>
<td style="text-align:left">d3c8b139(引数3)</td>
</tr>
<tr>
<td style="text-align:left">main</td>
</tr>
</tbody>
</table>
<p>リトルエンディアンなので，例えば [ebp+0xa] では引数1 の 33 にアクセスできる</p>
<h3 id="asm4">asm4</h3>
<p>アセンブリが渡されるが，多すぎて一つ一つ見るのは大変なのでコンパイルできるようにする．
32 bit なので <code>gcc -masm=intel -m32 solve.c -o solve</code> とする．
実行に <code>sudo apt install libc6-dev-i386</code> が必要．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">asm4</span>(<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> in)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> val;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">asm</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//&#34;push   ebp;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">//&#34;mov    ebp,esp;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#34;push   ebx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sub    esp,0x10;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    DWORD PTR [ebp-0x10],0x246;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    DWORD PTR [ebp-0xc],0x0;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;jmp    _asm_27;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;_asm_23:&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    DWORD PTR [ebp-0xc],0x1;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;_asm_27:&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    edx,DWORD PTR [ebp-0xc];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;test   al,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;jne    _asm_23;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    DWORD PTR [ebp-0x8],0x1;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;jmp    _asm_138;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;_asm_51:&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    edx,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movsx  edx,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;lea    ecx,[eax-0x1];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,ecx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movsx  eax,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sub    edx,eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    edx,eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0x10];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;lea    ebx,[edx+eax*1];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;lea    edx,[eax+0x1];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movsx  edx,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    ecx,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,ecx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;movsx  eax,al;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sub    edx,eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,edx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    eax,ebx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    DWORD PTR [ebp-0x10],eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    DWORD PTR [ebp-0x8],0x1;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;_asm_138:&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0xc];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sub    eax,0x1;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;cmp    DWORD PTR [ebp-0x8],eax;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;jl     _asm_51;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;mov    eax,DWORD PTR [ebp-0x10];&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;add    esp,0x10;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;pop    ebx;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//&#34;pop    ebp;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">//&#34;ret    ;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;nop;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">:</span><span style="color:#e6db74">&#34;=r&#34;</span>(val)
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">:</span> [pInput] <span style="color:#e6db74">&#34;m&#34;</span>(in)
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> val;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> argv)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;0x%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#a6e22e">asm4</span>(<span style="color:#e6db74">&#34;picoCTF_a3112&#34;</span>));
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="need-for-speed">Need For Speed</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">set_timer</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  __sighandler_t p_Var1;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  p_Var1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">__sysv_signal</span>(<span style="color:#ae81ff">0xe</span>,alarm_handler);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (p_Var1 <span style="color:#f92672">==</span> (__sighandler_t)<span style="color:#ae81ff">0xffffffffffffffff</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">Something bad happened here. &#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">exit</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">alarm</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>alarm(1) によって，一秒後に signal が送られて実行が中断する．
そこで，set_timer() を実行しないようにしたい．</p>
<p>方法1: SIGALRM がセットされていることが分かっているので，<code>(gdb) handle SIGALRM ignore</code>
が使えるらしい．</p>
<p>方法2: set_timer() の呼び出しを nop に書き変えることでも回避できる．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/CTF<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ r2 -d need-for-speed 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x7f4ef7a0b4d0<span style="color:#f92672">]</span>&gt; aaa
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze all flags starting with sym. and entry0 <span style="color:#f92672">(</span>aa<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze <span style="color:#66d9ef">function</span> calls <span style="color:#f92672">(</span>aac<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Analyze len bytes of instructions <span style="color:#66d9ef">for</span> references <span style="color:#f92672">(</span>aar<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Finding and parsing C++ vtables <span style="color:#f92672">(</span>avrr<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Skipping type matching analysis in debugger mode <span style="color:#f92672">(</span>aaft<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Propagate noreturn information <span style="color:#f92672">(</span>aanr<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Use -AA or aaaa to perform additional experimental analysis.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x7f4ef7a0b4d0<span style="color:#f92672">]</span>&gt; s main
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x55894100091a<span style="color:#f92672">]</span>&gt; pdf
</span></span><span style="display:flex;"><span>            ; DATA XREF from entry0 @ 0x55894100067d
</span></span><span style="display:flex;"><span>┌ 62: int main <span style="color:#f92672">(</span>int argc, char **argv<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>│           ; var int64_t var_10h @ rbp-0x10
</span></span><span style="display:flex;"><span>│           ; var int64_t var_4h @ rbp-0x4
</span></span><span style="display:flex;"><span>│           ; arg int argc @ rdi
</span></span><span style="display:flex;"><span>│           ; arg char **argv @ rsi
</span></span><span style="display:flex;"><span>│           0x55894100091a      <span style="color:#ae81ff">55</span>             push rbp
</span></span><span style="display:flex;"><span>│           0x55894100091b      4889e5         mov rbp, rsp
</span></span><span style="display:flex;"><span>│           0x55894100091e      4883ec10       sub rsp, 0x10
</span></span><span style="display:flex;"><span>│           0x558941000922      897dfc         mov dword <span style="color:#f92672">[</span>var_4h<span style="color:#f92672">]</span>, edi ; argc
</span></span><span style="display:flex;"><span>│           0x558941000925      488975f0       mov qword <span style="color:#f92672">[</span>var_10h<span style="color:#f92672">]</span>, rsi ; argv
</span></span><span style="display:flex;"><span>│           0x558941000929      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x55894100092e      e8a5ffffff     call sym.header
</span></span><span style="display:flex;"><span>│           0x558941000933      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x558941000938      e8f2feffff     call sym.set_timer
</span></span><span style="display:flex;"><span>│           0x55894100093d      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x558941000942      e836ffffff     call sym.get_key
</span></span><span style="display:flex;"><span>│           0x558941000947      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x55894100094c      e85bffffff     call sym.print_flag
</span></span><span style="display:flex;"><span>│           0x558941000951      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x558941000956      c9             leave
</span></span><span style="display:flex;"><span>└           0x558941000957      c3             ret
</span></span></code></pre></div><p>これで <code>call sym.set_timer</code> の場所が分かったので，nop に書きかえる．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>0x55894100091a<span style="color:#f92672">]</span>&gt; s 0x558941000938
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x558941000938<span style="color:#f92672">]</span>&gt; wao nop
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x558941000938<span style="color:#f92672">]</span>&gt; pdf
</span></span><span style="display:flex;"><span>            ; DATA XREF from entry0 @ 0x55894100067d
</span></span><span style="display:flex;"><span>┌ 62: int main <span style="color:#f92672">(</span>int argc, char **argv<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>│           ; var int64_t var_10h @ rbp-0x10
</span></span><span style="display:flex;"><span>│           ; var int64_t var_4h @ rbp-0x4
</span></span><span style="display:flex;"><span>│           ; arg int argc @ rdi
</span></span><span style="display:flex;"><span>│           ; arg char **argv @ rsi
</span></span><span style="display:flex;"><span>│           0x55894100091a      <span style="color:#ae81ff">55</span>             push rbp
</span></span><span style="display:flex;"><span>│           0x55894100091b      4889e5         mov rbp, rsp
</span></span><span style="display:flex;"><span>│           0x55894100091e      4883ec10       sub rsp, 0x10
</span></span><span style="display:flex;"><span>│           0x558941000922      897dfc         mov dword <span style="color:#f92672">[</span>var_4h<span style="color:#f92672">]</span>, edi ; argc
</span></span><span style="display:flex;"><span>│           0x558941000925      488975f0       mov qword <span style="color:#f92672">[</span>var_10h<span style="color:#f92672">]</span>, rsi ; argv
</span></span><span style="display:flex;"><span>│           0x558941000929      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x55894100092e      e8a5ffffff     call sym.header
</span></span><span style="display:flex;"><span>│           0x558941000933      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x558941000938      <span style="color:#ae81ff">90</span>             nop
</span></span><span style="display:flex;"><span>..
</span></span><span style="display:flex;"><span>│           0x55894100093d      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x558941000942      e836ffffff     call sym.get_key
</span></span><span style="display:flex;"><span>│           0x558941000947      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x55894100094c      e85bffffff     call sym.print_flag
</span></span><span style="display:flex;"><span>│           0x558941000951      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x558941000956      c9             leave
</span></span><span style="display:flex;"><span>└           0x558941000957      c3             ret
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>0x558941000938<span style="color:#f92672">]</span>&gt; dc
</span></span><span style="display:flex;"><span>Keep this thing over <span style="color:#ae81ff">50</span> mph!
</span></span><span style="display:flex;"><span><span style="color:#f92672">============================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Creating key...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Finished
</span></span><span style="display:flex;"><span>Printing flag:
</span></span><span style="display:flex;"><span>PICOCTF<span style="color:#f92672">{</span>Good job keeping bus <span style="color:#75715e">#1f2ac4ec speeding along!}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>128407<span style="color:#f92672">)</span> Process exited with status<span style="color:#f92672">=</span>0x0
</span></span></code></pre></div><h3 id="otp-implementation">OTP Implementation</h3>
<p>なんか OTP っぽいプログラムが渡される</p>
<ul>
<li>jumble: ある規則に従って数字をこねくり回す</li>
<li>main: さらにこねくり回す</li>
</ul>
<p>これを逆から見ていけば所望の鍵が手に入るので，flag と xor すればいい</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding:utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> getPrime, bytes_to_long, long_to_bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1fcb81cd1f6f1e12b429092e3647153b6c212772554ca004145b82367e1e6b7870827dc249a319601776f727434e6b6227d1&#34;</span>
</span></span><span style="display:flex;"><span>cmp_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mlaebfkoibhoijfidblechbggcgldicegjbkcmolhdjihgmmieabohpdhjnciacbjjcnpcfaopigkpdfnoaknjlnlaohboimombk&#34;</span>
</span></span><span style="display:flex;"><span>candidate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1234567890abcdef&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">jumble</span>(param1):
</span></span><span style="display:flex;"><span>     ans <span style="color:#f92672">=</span> param1
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0x60</span> <span style="color:#f92672">&lt;</span> param1):
</span></span><span style="display:flex;"><span>          ans <span style="color:#f92672">=</span> param1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x9</span>
</span></span><span style="display:flex;"><span>     ans <span style="color:#f92672">=</span> (ans <span style="color:#f92672">%</span> <span style="color:#ae81ff">0x10</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x02</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0x0f</span> <span style="color:#f92672">&lt;</span> ans):
</span></span><span style="display:flex;"><span>          ans <span style="color:#f92672">=</span> ans <span style="color:#f92672">+</span>  <span style="color:#ae81ff">0x01</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> ans
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">body</span>(counter, chara, pre):
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">if</span>(counter <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>):
</span></span><span style="display:flex;"><span>          after_jumble <span style="color:#f92672">=</span> jumble(ord(chara))
</span></span><span style="display:flex;"><span>          result <span style="color:#f92672">=</span> after_jumble <span style="color:#f92672">%</span> <span style="color:#ae81ff">0x10</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">#print(&#34;OK1&#34;)</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>          after_jumble <span style="color:#f92672">=</span> jumble(ord(chara))
</span></span><span style="display:flex;"><span>          Val <span style="color:#f92672">=</span> after_jumble <span style="color:#f92672">+</span> pre <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">0x1f</span>
</span></span><span style="display:flex;"><span>          result <span style="color:#f92672">=</span> (after_jumble <span style="color:#f92672">+</span> pre <span style="color:#f92672">+</span> (Val <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xf</span>) <span style="color:#f92672">-</span> (Val <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">#print(&#34;OK&#34;)</span>
</span></span><span style="display:flex;"><span>     counter <span style="color:#f92672">=</span> counter <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pre <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>results <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> candidate:
</span></span><span style="display:flex;"><span>          result <span style="color:#f92672">=</span> body(c, i, pre)
</span></span><span style="display:flex;"><span>          result <span style="color:#f92672">=</span> chr(result <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x61</span>)
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span>(cmp_str[c] <span style="color:#f92672">==</span> result):
</span></span><span style="display:flex;"><span>               results[c] <span style="color:#f92672">=</span> i
</span></span><span style="display:flex;"><span>               pre <span style="color:#f92672">=</span> ord(result)
</span></span><span style="display:flex;"><span>               <span style="color:#75715e">#print(chr(int(i, 16) ^ ord(cmp_str[c])))</span>
</span></span><span style="display:flex;"><span>               <span style="color:#75715e">#print(&#34;OK&#34;)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enc <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
</span></span><span style="display:flex;"><span>     print(long_to_bytes(int(results[i], <span style="color:#ae81ff">16</span>) <span style="color:#f92672">^</span> ord(flag[i])))
</span></span><span style="display:flex;"><span>     <span style="color:#75715e">#print(chr(int(results[i], 16) ^ ord(flag[i])), end=&#39;&#39;)</span>
</span></span></code></pre></div><h3 id="gogo">gogo</h3>
<p>golang のデコンパイル結果こんな見にくいのか</p>
<p>まず ghidra で見ると checkPassword がある．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  key[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x38</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x36</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x31</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x38</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:39
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x36</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x66</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x31</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:43
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x65</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:47
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x36</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x32</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x37</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:51
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x66</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x61</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x37</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:55
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x35</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x62</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x62</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:59
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x38</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x38</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x39</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:63
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x32</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x31</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x34</span>;
</span></span><span style="display:flex;"><span>  key[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x65</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:67
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:68
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  runtime.<span style="color:#a6e22e">duffcopy_0x20_FUN_08090fe0</span>(local_20,(uint4 <span style="color:#f92672">*</span>)main.statictmp_4);
</span></span><span style="display:flex;"><span>  uVar1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  iVar2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:70
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>( true ) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">int</span>)uVar1) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:75
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (iVar2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x20</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:76
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:78
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:71
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:70
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:71
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((param_2 <span style="color:#f92672">&lt;=</span> uVar1) <span style="color:#f92672">||</span> (<span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">&lt;</span> uVar1)) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((<span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)(param_1 <span style="color:#f92672">+</span> uVar1) <span style="color:#f92672">^</span> key[uVar1]) <span style="color:#f92672">==</span> <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">int</span>)local_20 <span style="color:#f92672">+</span> uVar1)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* /opt/hacksports/shared/staging/gogo_5_8320186217489444/problem_files/enter_pa ssword.go:72
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                        */</span>
</span></span><span style="display:flex;"><span>      iVar2 <span style="color:#f92672">=</span> iVar2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    uVar1 <span style="color:#f92672">=</span> uVar1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>key と main.statictmp_4 の中身を XOR しているっぽいので，まずこれを計算する．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x20</span>):
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>  print(chr(tmp[i]<span style="color:#f92672">^</span>input[i]),end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>reverseengineericanbarelyforward
</span></span></code></pre></div><p>次に，鍵を unhash しろ，と出てくる．
コード中に md5 とあるのでハッシュを探すと goldfish が見つかる．</p>
<h3 id="lets-get-dynamic">Let&rsquo;s get dynamic</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">~~</span> snip <span style="color:#f92672">~~</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_20 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  local_98 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x396c109a7067b614</span>;
</span></span><span style="display:flex;"><span>  local_90 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x32ea1ab1495990f0</span>;
</span></span><span style="display:flex;"><span>  local_88 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xd09aa897d230c8fe</span>;
</span></span><span style="display:flex;"><span>  local_80 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x2c227b84b00f7d0b</span>;
</span></span><span style="display:flex;"><span>  local_78 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xb0a880f7d99ea817</span>;
</span></span><span style="display:flex;"><span>  local_70 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xc8f18206086afe7c</span>;
</span></span><span style="display:flex;"><span>  local_68 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x61</span>;
</span></span><span style="display:flex;"><span>  local_58 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x563f52ce0f15cd77</span>;
</span></span><span style="display:flex;"><span>  local_50 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x719435c3652ef38f</span>;
</span></span><span style="display:flex;"><span>  local_48 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x8bec9fe9be05a4c9</span>;
</span></span><span style="display:flex;"><span>  local_40 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x521c05fe8d590431</span>;
</span></span><span style="display:flex;"><span>  local_38 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xdbf1c3a6dadcef7b</span>;
</span></span><span style="display:flex;"><span>  local_30 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xc4fc8b585631f076</span>;
</span></span><span style="display:flex;"><span>  local_28 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x3f</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fgets</span>(user_input,<span style="color:#ae81ff">0x31</span>,stdin);
</span></span><span style="display:flex;"><span>  counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>( true ) {
</span></span><span style="display:flex;"><span>    str_length <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (str_length <span style="color:#f92672">&lt;=</span> (ulong)(<span style="color:#66d9ef">long</span>)counter) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    local_118[counter] <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         (byte)counter <span style="color:#f92672">^</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)<span style="color:#f92672">&amp;</span>local_98 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">long</span>)counter) <span style="color:#f92672">^</span> <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)<span style="color:#f92672">&amp;</span>local_58 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">long</span>)counter) <span style="color:#f92672">^</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0x13</span>;
</span></span><span style="display:flex;"><span>    counter <span style="color:#f92672">=</span> counter <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  iVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">memcmp</span>(user_input,local_118,<span style="color:#ae81ff">0x31</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (iVar1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;No, that</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">s not right.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Correct! You entered the flag.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (local_20 <span style="color:#f92672">!=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">__stack_chk_fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> iVar1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>入力文字列と既存のフラグを比較している．
文字数は 0x31.
途中にある while 文を注目すればよくて，local_xx にあるデータをこねくりまわしている．
ここまでは簡単なんだがデータがリトルエンディアンなのでスタックの最後から取り出さなければいけない．
ここにつまづいて 5 年かけました</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding:utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local_98 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x39</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0x70</span>,<span style="color:#ae81ff">0x67</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0x14</span>]
</span></span><span style="display:flex;"><span>local_90 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x32</span>,<span style="color:#ae81ff">0xea</span>,<span style="color:#ae81ff">0x1a</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0x49</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x90</span>,<span style="color:#ae81ff">0xf0</span>]
</span></span><span style="display:flex;"><span>local_88 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xd0</span>,<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0x97</span>,<span style="color:#ae81ff">0xd2</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#ae81ff">0xc8</span>,<span style="color:#ae81ff">0xfe</span>]
</span></span><span style="display:flex;"><span>local_80 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x2c</span>,<span style="color:#ae81ff">0x22</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0x84</span>,<span style="color:#ae81ff">0xb0</span>,<span style="color:#ae81ff">0x0f</span>,<span style="color:#ae81ff">0x7d</span>,<span style="color:#ae81ff">0x0b</span>]
</span></span><span style="display:flex;"><span>local_78 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xb0</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0x80</span>,<span style="color:#ae81ff">0xf7</span>,<span style="color:#ae81ff">0xd9</span>,<span style="color:#ae81ff">0x9e</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0x17</span>]
</span></span><span style="display:flex;"><span>local_70 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xc8</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0x82</span>,<span style="color:#ae81ff">0x06</span>,<span style="color:#ae81ff">0x08</span>,<span style="color:#ae81ff">0x6a</span>,<span style="color:#ae81ff">0xfe</span>,<span style="color:#ae81ff">0x7c</span>]
</span></span><span style="display:flex;"><span>local_68 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x61</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local_58 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x56</span>,<span style="color:#ae81ff">0x3f</span>,<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0xce</span>,<span style="color:#ae81ff">0x0f</span>,<span style="color:#ae81ff">0x15</span>,<span style="color:#ae81ff">0xcd</span>,<span style="color:#ae81ff">0x77</span>]
</span></span><span style="display:flex;"><span>local_50 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x71</span>,<span style="color:#ae81ff">0x94</span>,<span style="color:#ae81ff">0x35</span>,<span style="color:#ae81ff">0xc3</span>,<span style="color:#ae81ff">0x65</span>,<span style="color:#ae81ff">0x2e</span>,<span style="color:#ae81ff">0xf3</span>,<span style="color:#ae81ff">0x8f</span>]
</span></span><span style="display:flex;"><span>local_48 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0xec</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0xe9</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0x05</span>,<span style="color:#ae81ff">0xa4</span>,<span style="color:#ae81ff">0xc9</span>]
</span></span><span style="display:flex;"><span>local_40 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0x1c</span>,<span style="color:#ae81ff">0x05</span>,<span style="color:#ae81ff">0xfe</span>,<span style="color:#ae81ff">0x8d</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x04</span>,<span style="color:#ae81ff">0x31</span>]
</span></span><span style="display:flex;"><span>local_38 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xdb</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0xc3</span>,<span style="color:#ae81ff">0xa6</span>,<span style="color:#ae81ff">0xda</span>,<span style="color:#ae81ff">0xdc</span>,<span style="color:#ae81ff">0xef</span>,<span style="color:#ae81ff">0x7b</span>]
</span></span><span style="display:flex;"><span>local_30 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xc4</span>,<span style="color:#ae81ff">0xfc</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0x58</span>,<span style="color:#ae81ff">0x56</span>,<span style="color:#ae81ff">0x31</span>,<span style="color:#ae81ff">0xf0</span>,<span style="color:#ae81ff">0x76</span>]
</span></span><span style="display:flex;"><span>local_28 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x3f</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">0x31</span>
</span></span><span style="display:flex;"><span>counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>plus <span style="color:#f92672">=</span> <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(<span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>   output[counter] <span style="color:#f92672">=</span> chr(plus <span style="color:#f92672">^</span> (local_30[<span style="color:#ae81ff">7</span><span style="color:#f92672">-</span>counter]) <span style="color:#f92672">^</span> (local_70[<span style="color:#ae81ff">7</span><span style="color:#f92672">-</span>counter]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x13</span>)
</span></span><span style="display:flex;"><span>   counter <span style="color:#f92672">=</span> counter <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>   plus <span style="color:#f92672">=</span> plus<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>   print(output)
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>print(output)
</span></span></code></pre></div><h4 id="別解">別解</h4>
<p>stack 表示を見ればいいらしい</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pwndbg&gt; b memcmp
</span></span><span style="display:flex;"><span>Breakpoint <span style="color:#ae81ff">1</span> at 0x1060
</span></span><span style="display:flex;"><span>pwndbg&gt; r
</span></span><span style="display:flex;"><span>~~snip~~
</span></span><span style="display:flex;"><span>pwndbg&gt; stack <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>00:0000│ rsp 0x7fffffffda18 —▸ 0x7ffff7fdb432 <span style="color:#f92672">(</span>_dl_fixup+642<span style="color:#f92672">)</span> ◂— mov qword ptr <span style="color:#f92672">[</span>rsp + 8<span style="color:#f92672">]</span>, rax
</span></span><span style="display:flex;"><span>01:0008│     0x7fffffffda20 —▸ 0x7ffff7ddeba0 ◂— 0x10001a0000487e /* <span style="color:#e6db74">&#39;~H&#39;</span> */
</span></span><span style="display:flex;"><span>02:0010│     0x7fffffffda28 —▸ 0x7ffff7e630f0 <span style="color:#f92672">(</span>memcmp<span style="color:#f92672">)</span> ◂— mov rax, qword ptr <span style="color:#f92672">[</span>rip + 0x137db9<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>03:0018│     0x7fffffffda30 —▸ 0x7fffffffdca0 ◂— 0x31 /* <span style="color:#e6db74">&#39;1&#39;</span> */
</span></span><span style="display:flex;"><span>04:0020│     0x7fffffffda38 —▸ 0x7fffffffddf0 ◂— 0x1
</span></span><span style="display:flex;"><span>05:0028│     0x7fffffffda40 ◂— 0x0
</span></span><span style="display:flex;"><span>06:0030│     0x7fffffffda48 —▸ 0x7fffffffdf18 —▸ 0x7fffffffe290 ◂— <span style="color:#e6db74">&#39;COLORFGBG=15;0&#39;</span>
</span></span><span style="display:flex;"><span>07:0038│     0x7fffffffda50 —▸ 0x555555557dd8 <span style="color:#f92672">(</span>__do_global_dtors_aux_fini_array_entry<span style="color:#f92672">)</span> —▸ 0x555555555130 <span style="color:#f92672">(</span>__do_global_dtors_aux<span style="color:#f92672">)</span> ◂— endbr64                                                                     
</span></span><span style="display:flex;"><span>08:0040│     0x7fffffffda58 —▸ 0x7ffff7fdd443 <span style="color:#f92672">(</span>_dl_runtime_resolve_fxsave+67<span style="color:#f92672">)</span> ◂— mov r11, rax
</span></span><span style="display:flex;"><span>09:0048│     0x7fffffffda60 —▸ 0x7fffffffdd20 ◂— 0x2f2f2f2f2f2f000a /* <span style="color:#e6db74">&#39;\n&#39;</span> */
</span></span><span style="display:flex;"><span>0a:0050│     0x7fffffffda68 —▸ 0x7fffffffdce0 ◂— <span style="color:#e6db74">&#39;picoCTF{dyn4m1c_4n4ly1s_1s_5up3r_us3ful_14bfa700}&#39;</span>
</span></span><span style="display:flex;"><span>0b:0058│     0x7fffffffda70 ◂— 0x31 /* <span style="color:#e6db74">&#39;1&#39;</span> */
</span></span><span style="display:flex;"><span>0c:0060│     0x7fffffffda78 —▸ 0x7fffffffdce0 ◂— <span style="color:#e6db74">&#39;picoCTF{dyn4m1c_4n4ly1s_1s_5up3r_us3ful_14bfa700}&#39;</span>
</span></span><span style="display:flex;"><span>0d:0068│     0x7fffffffda80 —▸ 0x7fffffffdd20 ◂— 0x2f2f2f2f2f2f000a /* <span style="color:#e6db74">&#39;\n&#39;</span> */
</span></span><span style="display:flex;"><span>0e:0070│     0x7fffffffda88 ◂— 0x0
</span></span><span style="display:flex;"><span>0f:0078│     0x7fffffffda90 ◂— 0x410
</span></span><span style="display:flex;"><span>10:0080│     0x7fffffffda98 ◂— 0x0
</span></span><span style="display:flex;"><span>11:0088│     0x7fffffffdaa0 ◂— 0x37f
</span></span><span style="display:flex;"><span>12:0090│     0x7fffffffdaa8 ◂— 0x0
</span></span><span style="display:flex;"><span>13:0098│     0x7fffffffdab0 ◂— 0x0
</span></span></code></pre></div><p>なんて便利なんだ&hellip;</p>
<h3 id="easy-as-gdb">Easy as GDB</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">FUN_000108c4</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>param_1,uint param_2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>__dest;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>__dest_00;
</span></span><span style="display:flex;"><span>  uint local_18;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  __dest <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">calloc</span>(param_2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">strncpy</span>(__dest,param_1,param_2);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">FUN_000107c2</span>(__dest,param_2,<span style="color:#ae81ff">0xffffffff</span>);
</span></span><span style="display:flex;"><span>  __dest_00 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">calloc</span>(param_2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">strncpy</span>(__dest_00,<span style="color:#f92672">&amp;</span>DAT_00012008,param_2);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">FUN_000107c2</span>(__dest_00,param_2,<span style="color:#ae81ff">0xffffffff</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;checking solution...&#34;</span>);
</span></span><span style="display:flex;"><span>  local_18 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>( true ) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (param_2 <span style="color:#f92672">&lt;=</span> local_18) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (__dest[local_18] <span style="color:#f92672">!=</span> __dest_00[local_18]) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    local_18 <span style="color:#f92672">=</span> local_18 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0xffffffff</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>入力文字列と内蔵文字列が一致していない or ループ回数が入力文字列数を超える で，
ループを抜ける．
つまり，入力した文字列がすべて正しければループ回数が入力文字列を超えるので
(local_18 (ループ回数)が param_2 (入力文字列数) を超える)，
ループ回数を見ることでフラグが分かる．
以下に gdb スクリプト</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> gdb
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;file ./brute&#39;</span>)
</span></span><span style="display:flex;"><span>gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;set pagination off&#39;</span>)
</span></span><span style="display:flex;"><span>gdb<span style="color:#f92672">.</span>Breakpoint(<span style="color:#e6db74">&#39;*0x565559a5&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pattern <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>printable
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">30</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> chara <span style="color:#f92672">in</span> pattern:
</span></span><span style="display:flex;"><span>   payload <span style="color:#f92672">=</span> flag <span style="color:#f92672">+</span> chara
</span></span><span style="display:flex;"><span>   gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;run &#39;</span> <span style="color:#f92672">+</span> chara)
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;continue&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span> gdb<span style="color:#f92672">.</span>error:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        msg <span style="color:#f92672">=</span> gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;i b&#39;</span>, to_string<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;hit </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> times&#39;</span><span style="color:#f92672">.</span>format(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">in</span> msg:
</span></span><span style="display:flex;"><span>            flag <span style="color:#f92672">+=</span> chara
</span></span><span style="display:flex;"><span>            gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;continue&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;flag:&#39;</span>, flag <span style="color:#f92672">+</span> chara)
</span></span><span style="display:flex;"><span>        print(msg)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(flag)
</span></span><span style="display:flex;"><span>gdb<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span></code></pre></div><p>相対アドレスは忘れていたので注意</p>
<p>Ghidra で表示されているアドレスは gdb とズレてしまうことに注意する．
Ghidra は <code>0x00010000</code> からアドレスが始まる．
gdb の方は <code>info proc mapping</code> でアドレスの内容を見る</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pwndbg&gt; info proc mapping
</span></span><span style="display:flex;"><span>process <span style="color:#ae81ff">614292</span>
</span></span><span style="display:flex;"><span>Mapped address spaces:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Start Addr   End Addr       Size     Offset  Perms   objfile
</span></span><span style="display:flex;"><span>        0x56555000 0x56556000     0x1000        0x0  r-xp   /home/kali/CTF/brute
</span></span><span style="display:flex;"><span>        0x56556000 0x56557000     0x1000        0x0  r--p   /home/kali/CTF/brute
</span></span><span style="display:flex;"><span>        0x56557000 0x56558000     0x1000     0x1000  rw-p   /home/kali/CTF/brute
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>で，Ghidra でブレークポイントを設置したい命令は <code>000109a5 72 d1 JC LAB_00010978</code> なので，
ベースアドレス +0x9a5 の ところに所望の命令があることが分かる．</p>
<p>あとはせいぜい 3 つなので 3 つとも試してみてブレークポイントが貼れる &amp; スクリプトが正常に動作する
ものを選べばいいが，ダメ押しで <code>x/16xb 0x565559a5</code> みたいな感じでやると
逆アセンブルコードを表示してくれるので，Ghidra の表示と一致するものを選べばいい．</p>
<h3 id="armssembly-4">ARMssembly 4</h3>
<p>計算するだけ．
なんだこれは</p>
<h3 id="not-crypto">not crypto</h3>
<p><code>&quot;I heard you wanted to bargain for a flag... whatcha got?</code> という文字列を探して，おそらく main 関数は FUN_00101070 だと推測する．
入力は <code>fread(local_198,1,0x40,_stdin);</code> のように標準入力から受け取り，最後の方で <code>iVar19 = memcmp(local_88,local_198,0x40);</code> みたいな比較をしている．
local_198 がそのままであれば local_88 が flag になっているはずなので， memcmp のあたりでレジスタを見ればよさそう．</p>
<p>ブレークポイントを memcmp において(アドレスに注意する)，rdi を見るとフラグをゲト</p>
<h3 id="ready-gladiator-2">Ready Gladiator 2</h3>
<p>Core wars らしい．
imp(小鬼) と呼ばれるプログラムに全勝すればいいらしい．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>;redcode
</span></span><span style="display:flex;"><span>;name Imp Ex
</span></span><span style="display:flex;"><span>;assert 1
</span></span><span style="display:flex;"><span>JMP 0, &lt;-5
</span></span><span style="display:flex;"><span>end
</span></span></code></pre></div><p>なんか上手くいった．．．</p>
<h3 id="no-way-out">No way out</h3>
<p>Unity 製のゲームが動いている．
ハシゴを上ると旗が見えるが，透明な壁があって通り抜けられない．</p>
<p>dll のデコンパイル，インターンで教わったな．．．と思いながら dnSpy をインストールする．
が，Unity 製の dll がどれをデコンパイルするべきか見当もつかなかったので writeup を見る．
<code>/Managed/Assembly-CSharp.dll</code> を見ればいいらしい．
全部の exe でそうなんだろうか</p>
<p>dll をなんとなく見ると，以下の記述が目に付く．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (Input.GetButton(<span style="color:#e6db74">&#34;Jump&#34;</span>) &amp;&amp; <span style="color:#66d9ef">this</span>.canMove &amp;&amp; <span style="color:#66d9ef">this</span>.characterController.isGrounded &amp;&amp; !<span style="color:#66d9ef">this</span>.isClimbing)
</span></span></code></pre></div><p>昔ゲームを作った時にジャンプ判定で苦労した記憶を掘り出して，ジャンプできるのはプレイヤーの着地判定がトリガーしているときだけだったことを思い出す．
なので &amp;&amp; 以下をコメントアウトして再コンパイルする．
File -&gt; Save Module を忘れずに(戒め)</p>
<p>ゲームを起動して旗に近づくとフラグが見える．</p>
<h3 id="factcheck">FactCheck</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  local_20 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001012cf to 001012d3 has its CatchHandler @ 00101975
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_248,(allocator <span style="color:#f92672">*</span>)<span style="color:#e6db74">&#34;picoCTF{wELF_d0N3_mate_&#34;</span>);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 0010130a to 0010130e has its CatchHandler @ 00101996
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_228,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010201d);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101345 to 00101349 has its CatchHandler @ 001019b1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_208,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010201f);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101380 to 00101384 has its CatchHandler @ 001019cc
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_1e8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102021);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001013bb to 001013bf has its CatchHandler @ 001019e7
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_1c8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010201d);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001013f6 to 001013fa has its CatchHandler @ 00101a02
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_1a8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102023);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101431 to 00101435 has its CatchHandler @ 00101a1d
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_188,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102025);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 0010146c to 00101470 has its CatchHandler @ 00101a38
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_168,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102027);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001014a7 to 001014ab has its CatchHandler @ 00101a53
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_148,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102029);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001014e2 to 001014e6 has its CatchHandler @ 00101a6e
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_128,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010202b);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 0010151d to 00101521 has its CatchHandler @ 00101a89
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_108,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010202d);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101558 to 0010155c has its CatchHandler @ 00101aa4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_e8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102025);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101593 to 00101597 has its CatchHandler @ 00101abf
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_c8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010202f);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 001015ce to 001015d2 has its CatchHandler @ 00101ada
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_a8,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102031);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101606 to 0010160a has its CatchHandler @ 00101af5
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_88,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102033);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 0010163e to 00101642 has its CatchHandler @ 00101b0d
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_68,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_0010201d);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::</span><span style="color:#a6e22e">allocator</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101676 to 0010167a has its CatchHandler @ 00101b25
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)local_48,(allocator <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>DAT_00102033);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;::~</span><span style="color:#a6e22e">allocator</span>(<span style="color:#f92672">&amp;</span>local_249);
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// try { // try from 00101699 to 0010185f has its CatchHandler @ 00101b3d
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_208);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#39;B&#39;</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_c8);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_a8);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;A&#39;</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_68);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_1c8);
</span></span><span style="display:flex;"><span>  cVar1 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>pcVar2;
</span></span><span style="display:flex;"><span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_148);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ((<span style="color:#66d9ef">int</span>)cVar1 <span style="color:#f92672">-</span> (<span style="color:#66d9ef">int</span>)<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_1c8);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_1e8);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_188);
</span></span><span style="display:flex;"><span>  pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_168);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;G&#39;</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_168);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_1a8);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_88);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_228);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,local_128);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>            (local_248,<span style="color:#e6db74">&#39;}&#39;</span>);
</span></span><span style="display:flex;"><span>  std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::~</span><span style="color:#a6e22e">basic_string</span>
</span></span><span style="display:flex;"><span>            (local_48);
</span></span></code></pre></div><p>前半で文字列をメモリに当てこんでいて，後半でその各メモリの値をチェックしてフラグの文字列に追加するかどうかを判断している．
例えば以下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>pcVar2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>
</span></span><span style="display:flex;"><span>                   operator[]((ulong)local_208);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>pcVar2 <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#39;B&#39;</span>) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;&gt;::</span>operator<span style="color:#f92672">+=</span>
</span></span><span style="display:flex;"><span>              (local_248,local_c8);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p><code>local_208</code> の値が <code>&lt;'B'</code> なら，<code>local_c8 (2)</code> を追加する，みたいな感じ．
最後に <code>std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::operator+=(local_248,'}');</code> があるのでここでおしまい．</p>
<h3 id="keygenme">Keygenme</h3>
<p>なんか libcrypto.so.1.1 が足りないって怒られたのでビルドする</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget https://www.openssl.org/source/old/1.1.0/openssl-1.1.0l.tar.gz
</span></span><span style="display:flex;"><span>tar xvf openssl-1.1.0l.tar.gz
</span></span><span style="display:flex;"><span>cd openssl-1.1.0l
</span></span><span style="display:flex;"><span>./config
</span></span><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>export LD_LIBRARY_PATH<span style="color:#f92672">=</span>./openssl-1.1.0l:$LD_LIBRARY_PATH
</span></span></code></pre></div><p>実行するとライセンスキーを求められる．
<code>printf(&quot;Enter your license key: &quot;);</code> みたいな記述がある関数があるのでこれが main ?</p>
<p>以下少し丁寧にやる</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  local_10 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  local_98 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7b4654436f636970</span>;
</span></span><span style="display:flex;"><span>  local_90 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x30795f676e317262</span>;
</span></span><span style="display:flex;"><span>  local_88 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6b5f6e77305f7275</span>;
</span></span><span style="display:flex;"><span>  local_80 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x5f7933</span>;
</span></span><span style="display:flex;"><span>  local_ba <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7d</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* 27words */</span>
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">MD5</span>((uchar <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98,sVar1,local_b8);
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_ba);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">MD5</span>((uchar <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_ba,sVar1,local_a8);
</span></span><span style="display:flex;"><span>  local_d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_cc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_cc <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x10</span>; local_cc <span style="color:#f92672">=</span> local_cc <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sprintf</span>(local_78 <span style="color:#f92672">+</span> local_d0,<span style="color:#e6db74">&#34;%02x&#34;</span>,(ulong)local_b8[local_cc]);
</span></span><span style="display:flex;"><span>    local_d0 <span style="color:#f92672">=</span> local_d0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  local_d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_c8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c8 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x10</span>; local_c8 <span style="color:#f92672">=</span> local_c8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sprintf</span>(local_58 <span style="color:#f92672">+</span> local_d0,<span style="color:#e6db74">&#34;%02x&#34;</span>,(ulong)local_a8[local_c8]);
</span></span><span style="display:flex;"><span>    local_d0 <span style="color:#f92672">=</span> local_d0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_c4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c4 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x1b</span>; local_c4 <span style="color:#f92672">=</span> local_c4 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    acStack_38[local_c4] <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)<span style="color:#f92672">&amp;</span>local_98 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">long</span>)local_c4);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> local_43;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> local_62;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> local_62;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> local_78[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> local_5b;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> local_43;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">33</span>] <span style="color:#f92672">=</span> local_6a;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">34</span>] <span style="color:#f92672">=</span> local_60;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">35</span>] <span style="color:#f92672">=</span> (undefined)local_ba;
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(param_1);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (sVar1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x24</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (local_c0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c0 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x24</span>; local_c0 <span style="color:#f92672">=</span> local_c0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (param_1[local_c0] <span style="color:#f92672">!=</span> acStack_38[local_c0]) {
</span></span><span style="display:flex;"><span>        uVar2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">goto</span> LAB_00101475;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    uVar2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>local_98~~ みたいなとこがフラグの前半になっていて，残りのマジックナンバーを探そうという感じ．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MD5</span>((uchar <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_98,sVar1,local_b8);
</span></span></code></pre></div><p>まず，<code>local_98 ~~</code> には <code>0x7b ~~</code> のフラグが入っているので，最初は <code>sVar1 = 17</code>
で，MD5 を計算している．
この結果は local_b8 から見れる．
逆に <code>local_b1</code> には <code>0x7d</code> しか入ってないので 1 文字だけ．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>local_d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_cc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_cc <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x10</span>; local_cc <span style="color:#f92672">=</span> local_cc <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sprintf</span>(local_78 <span style="color:#f92672">+</span> local_d0,<span style="color:#e6db74">&#34;%02x&#34;</span>,(ulong)local_b8[local_cc]);
</span></span><span style="display:flex;"><span>    local_d0 <span style="color:#f92672">=</span> local_d0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  local_d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_c8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c8 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x10</span>; local_c8 <span style="color:#f92672">=</span> local_c8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sprintf</span>(local_58 <span style="color:#f92672">+</span> local_d0,<span style="color:#e6db74">&#34;%02x&#34;</span>,(ulong)local_a8[local_c8]);
</span></span><span style="display:flex;"><span>    local_d0 <span style="color:#f92672">=</span> local_d0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>次にここを考える．
local_b8, local_a8 には既にハッシュ値が入っていて，local_78 の変数に格納していく．
ここで，local_78 は小さい方に伸びることを失念していて時間を使ってしまった．
つまり，local_78 -&gt; local_76 みたいな感じで伸びていく．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_c4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_c4 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x1b</span>; local_c4 <span style="color:#f92672">=</span> local_c4 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    acStack_38[local_c4] <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)<span style="color:#f92672">&amp;</span>local_98 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">long</span>)local_c4);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ここは既存のフラグを代入しているだけ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> local_43;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> local_62;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> local_62;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> local_78[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> local_5b;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> local_43;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">33</span>] <span style="color:#f92672">=</span> local_6a;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">34</span>] <span style="color:#f92672">=</span> local_60;
</span></span><span style="display:flex;"><span>  acStack_38[<span style="color:#ae81ff">35</span>] <span style="color:#f92672">=</span> (undefined)local_ba;
</span></span></code></pre></div><p>マジックナンバーを入れるところ．
先に決めていたハッシュ値を見れば代入できる．</p>
<p>静的解析で頑張ったが，gdb でやったら 2 秒で終わった．
つまり，マジックナンバーを代入しているアドレスで止めて eax を見ればいい．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>c8 <span style="color:#ae81ff">0f</span> b6 <span style="color:#ae81ff">45</span> c5     MOVZX      EAX,byte ptr [RBP <span style="color:#f92672">+</span> local_43]
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>cc <span style="color:#ae81ff">88</span> <span style="color:#ae81ff">45</span> eb        MOV        byte ptr [RBP <span style="color:#f92672">+</span> local_1d],AL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>cf <span style="color:#ae81ff">0f</span> b6 <span style="color:#ae81ff">45</span> a6     MOVZX      EAX,byte ptr [RBP <span style="color:#f92672">+</span> local_62]
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>d3 <span style="color:#ae81ff">88</span> <span style="color:#ae81ff">45</span> ec        MOV        byte ptr [RBP <span style="color:#f92672">+</span> local_1c],AL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">001013</span>d6 <span style="color:#ae81ff">0f</span> b6 <span style="color:#ae81ff">45</span> a6     MOVZX      EAX,byte ptr [RBP <span style="color:#f92672">+</span> local_62]
</span></span></code></pre></div><p>静的解析，パズルで楽しいし筋トレにはなるけど眼の負担がエグいし動的解析が一瞬で終わった時虚無すぎる</p>
<h3 id="wizardlike">Wizardlike</h3>
<p>マジでわかんね～と思いながら中見てたら ASCII コードが見えたので気合と根性．</p>
<h3 id="classic-crackme-0x100">Classic Crackme 0x100</h3>
<p>パスワード系の典型問題．
memcmp があるのでレジスタを見ればいいか，と思ったが，入力をこねくりまわしている &amp; フラグがサーバ側にある，でちゃんと静的解析する必要がありそう</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  cmp_flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x747774746971747a</span>;
</span></span><span style="display:flex;"><span>  local_60 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7372667965697478</span>;
</span></span><span style="display:flex;"><span>  local_58 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x766f78757a74676c</span>;
</span></span><span style="display:flex;"><span>  local_50 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6e7372626e64666c</span>;
</span></span><span style="display:flex;"><span>  local_48 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x647368687976726c</span>;
</span></span><span style="display:flex;"><span>  local_40 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6e786f66727878</span>;
</span></span><span style="display:flex;"><span>  uStack_39 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6c626a</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">setvbuf</span>(stdout,(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter the secret password: &#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">__isoc99_scanf</span>(<span style="color:#f92672">&amp;</span>DAT_00402024,user_input);
</span></span><span style="display:flex;"><span>  local_c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  flag_length <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>cmp_flag);
</span></span><span style="display:flex;"><span>  flag_length__ <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)flag_length;
</span></span><span style="display:flex;"><span>  local_18 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x55</span>;
</span></span><span style="display:flex;"><span>  local_1c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>;
</span></span><span style="display:flex;"><span>  local_20 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xf</span>;
</span></span><span style="display:flex;"><span>  local_21 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (; local_c <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>; local_c <span style="color:#f92672">=</span> local_c <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (counter_input <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; counter_input <span style="color:#f92672">&lt;</span> flag_length__; counter_input <span style="color:#f92672">=</span> counter_input <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>      local_28 <span style="color:#f92672">=</span> (counter_input <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xff</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> local_18) <span style="color:#f92672">+</span> (counter_input <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xff</span> <span style="color:#f92672">&amp;</span> local_18);
</span></span><span style="display:flex;"><span>      local_2c <span style="color:#f92672">=</span> ((<span style="color:#66d9ef">int</span>)local_28 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&amp;</span> local_1c) <span style="color:#f92672">+</span> (local_1c <span style="color:#f92672">&amp;</span> local_28);
</span></span><span style="display:flex;"><span>      iVar1 <span style="color:#f92672">=</span> ((<span style="color:#66d9ef">int</span>)local_2c <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">&amp;</span> local_20) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>              ((<span style="color:#66d9ef">int</span>)user_input[counter_input] <span style="color:#f92672">-</span> (<span style="color:#66d9ef">int</span>)local_21) <span style="color:#f92672">+</span> (local_20 <span style="color:#f92672">&amp;</span> local_2c);
</span></span><span style="display:flex;"><span>      user_input[counter_input] <span style="color:#f92672">=</span> local_21 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">char</span>)iVar1 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">char</span>)(iVar1 <span style="color:#f92672">/</span> <span style="color:#ae81ff">0x1a</span>) <span style="color:#f92672">*</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0x1a</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  iVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">memcmp</span>(user_input,<span style="color:#f92672">&amp;</span>cmp_flag,(<span style="color:#66d9ef">long</span>)flag_length__);
</span></span></code></pre></div><p>重要なのは for を回している部分とハードコードされている情報はリトルエンディアンであること．
ソルバは以下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cmp_flag <span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x7a</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x71</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x77</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x65</span>,<span style="color:#ae81ff">0x79</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x67</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x7a</span>,<span style="color:#ae81ff">0x75</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x6f</span>,<span style="color:#ae81ff">0x76</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x62</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x76</span>,<span style="color:#ae81ff">0x79</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x6f</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x6a</span>,<span style="color:#ae81ff">0x62</span>,<span style="color:#ae81ff">0x6c</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local_18 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x55</span>
</span></span><span style="display:flex;"><span>local_1c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33</span>
</span></span><span style="display:flex;"><span>local_20 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xf</span>
</span></span><span style="display:flex;"><span>local_21 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>user_input <span style="color:#f92672">=</span> [<span style="color:#66d9ef">None</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>pattern <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">50</span>):
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> chara <span style="color:#f92672">in</span> pattern:
</span></span><span style="display:flex;"><span>      tmp_user_input <span style="color:#f92672">=</span> chara
</span></span><span style="display:flex;"><span>      tmp_user_input <span style="color:#f92672">=</span> ord(tmp_user_input)
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            local_28 <span style="color:#f92672">=</span> (j <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xff</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> local_18) <span style="color:#f92672">+</span> (j <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xff</span> <span style="color:#f92672">&amp;</span> local_18)
</span></span><span style="display:flex;"><span>            local_2c <span style="color:#f92672">=</span> (local_28 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&amp;</span> local_1c) <span style="color:#f92672">+</span> (local_1c <span style="color:#f92672">&amp;</span> local_28)
</span></span><span style="display:flex;"><span>            iVar1 <span style="color:#f92672">=</span> (local_2c <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">&amp;</span> local_20) <span style="color:#f92672">+</span> (tmp_user_input <span style="color:#f92672">-</span> ord(local_21)) <span style="color:#f92672">+</span> (local_20 <span style="color:#f92672">&amp;</span> local_2c)
</span></span><span style="display:flex;"><span>            tmp_user_input <span style="color:#f92672">=</span> ord(local_21) <span style="color:#f92672">+</span> iVar1 <span style="color:#f92672">+</span> (iVar1 <span style="color:#f92672">//</span> <span style="color:#ae81ff">0x1a</span>) <span style="color:#f92672">*</span> (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x1a</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(hex(tmp_user_input) <span style="color:#f92672">==</span> hex(cmp_flag[j])):
</span></span><span style="display:flex;"><span>         print(chara, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">break</span>
</span></span></code></pre></div><h3 id="winantidbg0x100">WinAntiDbg0x100</h3>
<p>Windows の実行ファイルをデバッグしてフラグを取ろう，みたいな感じらしい．
実行しながらやるといいらしいので勉強がてら IDA を使ってやってみる．</p>
<p>単純に IDA で実行すると以下のようなメッセージが出る</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Debugged application message: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        _            _____ _______ ______  
</span></span><span style="display:flex;"><span>       (_)          / ____|__   __|  ____| 
</span></span><span style="display:flex;"><span>  _ __  _  ___ ___ | |       | |  | |__    
</span></span><span style="display:flex;"><span> | &#39;_ \| |/ __/ _ \| |       | |  |  __|   
</span></span><span style="display:flex;"><span> | |_) | | (_| (_) | |____   | |  | |      
</span></span><span style="display:flex;"><span> | .__/|_|\___\___/ \_____|  |_|  |_|      
</span></span><span style="display:flex;"><span> | |                                       
</span></span><span style="display:flex;"><span> |_|                                       
</span></span><span style="display:flex;"><span>  Welcome to the Anti-Debug challenge!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Debugged application message: ### Level 1: Why did the clever programmer become a gardener? Because they discovered their talent for growing a &#39;patch&#39; of roses!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Debugged application message: ### Oops! The debugger was detected. Try to bypass this check to get the flag!
</span></span></code></pre></div><p>デバッガ検出の分岐があるっぽいので，メッセージから見て当該箇所を探す．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">asc_6D3438</span> <span style="color:#75715e">; &#34;\n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ds</span>:<span style="color:#66d9ef">OutputDebugStringW</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">asc_6D343C</span> <span style="color:#75715e">; &#34;\n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ds</span>:<span style="color:#66d9ef">OutputDebugStringW</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">sub_6D11B0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">sub_6D1200</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">test</span>    <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">jnz</span>     <span style="color:#66d9ef">short</span> <span style="color:#66d9ef">loc_6D15E7</span>
</span></span></code></pre></div><p><code>test</code> のところを右クリックすると <code>Add breakpoint</code> という表示があるのでブレークポイントを設置する．
で，実行すると止まってくれるので，IDA 側で <code>eax</code> を 0 に書き換えてあげればフラグが返ってくる．</p>
<h3 id="winantidbg0x200">WinAntiDbg0x200</h3>
<p>WinAntiDbg0x100 とほとんど同じで，分岐ポイントのフラグを書きかえればOK</p>
<h3 id="weirdsnake">weirdSnake</h3>
<p>python のデコンパイル結果が渡されるので手でデコンパイルする．</p>
<h3 id="breadth">breadth</h3>
<p>二つの同じようなバイナリが与えられる．
diff を取ってみる．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>objdump -d -M intel breadth.v1 &gt; v1.txt
</span></span><span style="display:flex;"><span>objdump -d -M intel breadth.v2 &gt; v2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>diff v1-disassm.txt v2-disassm.txt 
</span></span><span style="display:flex;"><span>2c2
</span></span><span style="display:flex;"><span>&lt; breadth.v1:     file format elf64-x86-64
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt; breadth.v2:     file format elf64-x86-64
</span></span><span style="display:flex;"><span>164220,164225c164220,164225
</span></span><span style="display:flex;"><span>&lt;    95049:     <span style="color:#ae81ff">48</span> 8b <span style="color:#ae81ff">54</span> <span style="color:#ae81ff">24</span> f0          mov    rdx,QWORD PTR <span style="color:#f92672">[</span>rsp-0x10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>&lt;    9504e:     b8 3a <span style="color:#ae81ff">80</span> <span style="color:#ae81ff">37</span> d0          mov    eax,0xd037803a
</span></span><span style="display:flex;"><span>&lt;    95053:     <span style="color:#ae81ff">48</span> <span style="color:#ae81ff">39</span> c2                cmp    rdx,rax
</span></span><span style="display:flex;"><span>&lt;    95056:     <span style="color:#ae81ff">74</span> <span style="color:#ae81ff">08</span>                   je     <span style="color:#ae81ff">95060</span> &lt;fcnkKTQpF+0x20&gt;
</span></span><span style="display:flex;"><span>&lt;    95058:     c3                      ret
</span></span><span style="display:flex;"><span>&lt;    95059:     0f 1f <span style="color:#ae81ff">80</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span>    nop    DWORD PTR <span style="color:#f92672">[</span>rax+0x0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt;    95049:     <span style="color:#ae81ff">48</span> 8b <span style="color:#ae81ff">44</span> <span style="color:#ae81ff">24</span> f0          mov    rax,QWORD PTR <span style="color:#f92672">[</span>rsp-0x10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>&gt;    9504e:     <span style="color:#ae81ff">48</span> 3d 3e c7 1b <span style="color:#ae81ff">04</span>       cmp    rax,0x41bc73e
</span></span><span style="display:flex;"><span>&gt;    95054:     <span style="color:#ae81ff">74</span> 0a                   je     <span style="color:#ae81ff">95060</span> &lt;fcnkKTQpF+0x20&gt;
</span></span><span style="display:flex;"><span>&gt;    95056:     c3                      ret
</span></span><span style="display:flex;"><span>&gt;    95057:     <span style="color:#ae81ff">66</span> 0f 1f <span style="color:#ae81ff">84</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span>    nop    WORD PTR <span style="color:#f92672">[</span>rax+rax*1+0x0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>&gt;    9505e:     <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> 
</span></span></code></pre></div><p>当該部分にハードコードされているフラグが答えだった</p>
<p>飽きてきたので他の CTF の rev を解こうと思います</p>

    </div>
    <div class="post-footer">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css" integrity="sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js" integrity="sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "$", right: "$", display: false}]
    });
  });
</script>
      
    </div>
  </article>
  <hr>
  <p>© side-realms All rights reserved.</p>

    </main>
  </body>
</html>
